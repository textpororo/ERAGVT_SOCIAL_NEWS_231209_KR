;**********************************************************
;衣装の설정
@CLOTH_WEAR
#DIM CUSTOMIZE, 2
#DIM CUSTOMIZE_INNER, 2
$INPUT_LOOP_FUNCTIONSTART
PRINTL 
IF CHARANUM <= 2
	PRINTL 【衣装の설정】
	RESULT = 1
ELSE
	PRINTFORML %"【衣装の설정】",21,LEFT%%"[変身前アウター]",21,LEFT%%"[変身後アウター]",21,LEFT%%"[インナー]",23,LEFT%[その他】
	FOR LOCAL,1,CHARANUM
		PRINTFORM %NAME:LOCAL,21,LEFT%
		IF CFLAG:LOCAL:40 == 0
			PRINTFORM %"なし",21,LEFT%
		ELSE
			;表示ずれ防止に名称変更している場合はそちらだけ表示、かつ文字数多い場合省略するように
			LOCAL:1 = RESULT
			STRLENS CSTR:LOCAL:8
			IF RESULT == 0
				PRINTFORM %ITEMNAME:(CFLAG:LOCAL:40),21,LEFT%
			ELSEIF RESULT < 21
				PRINTFORM %CSTR:LOCAL:8,21,LEFT%
			ELSE
				SUBSTRING CSTR:LOCAL:8, 0, 18
				PRINTFORM %RESULTS+"…",21,LEFT%
			ENDIF
			RESULT = LOCAL:1
			;IF CSTR:LOCAL:8 == ""
			;	PRINTFORM %ITEMNAME:(CFLAG:LOCAL:40),21,LEFT%
			;ELSE
			;	PRINTFORM %CSTR:LOCAL:8%（%ITEMNAME:(CFLAG:LOCAL:40),21,LEFT%）
			;ENDIF
		ENDIF
		IF TALENT:LOCAL:변신능력 == 1
			IF CFLAG:LOCAL:41 == 0
				PRINTFORM %"なし",21,LEFT%
			ELSE
				;表示ずれ防止に名称変更している場合はそちらだけ表示、かつ文字数多い場合省略するように
				LOCAL:1 = RESULT
				STRLENS CSTR:LOCAL:9
				IF RESULT == 0
					PRINTFORM %ITEMNAME:(CFLAG:LOCAL:41),21,LEFT%
				ELSEIF RESULT < 21
					PRINTFORM %CSTR:LOCAL:9,21,LEFT%
				ELSE
					SUBSTRING CSTR:LOCAL:9, 0, 18
					PRINTFORM %RESULTS+"…",21,LEFT%
				ENDIF
				RESULT = LOCAL:1
				;IF CSTR:LOCAL:9 == ""
				;	PRINTFORM %ITEMNAME:(CFLAG:LOCAL:41),21,LEFT%
				;ELSE
				;	PRINTFORM %ITEMNAME:(CFLAG:LOCAL:41),21,LEFT%
				;ENDIF
			ENDIF
		ELSE
			PRINTFORM %"×",21,LEFT%
		ENDIF
		IF CFLAG:LOCAL:42 == 0
			PRINTFORM %"なし",23,LEFT%
		ELSE
			PRINTFORM %ITEMNAME:(CFLAG:LOCAL:42),23,LEFT%
		ENDIF
		IF CFLAG:LOCAL:43 == 0
			PRINTFORM %"なし",21,LEFT%
		ELSE
			PRINTFORM %ITEMNAME:(CFLAG:LOCAL:43)%
		ENDIF
		PRINTL
	NEXT
	DRAWLINE
	CALL CHARA_LIST, 1
ENDIF
PRINTL 
IF RESULT == 999
ELSE
	LOCAL = RESULT
	LOCAL:1 = LINECOUNT
	DRAWLINE
	$INPUT_LOOP
	CLEARLINE LINECOUNT - LOCAL:1
	PRINTFORML ◆%NAME:LOCAL%の衣装설정
	PRINT 【　외투　】
	IF CFLAG:LOCAL:40 == 0
		PRINTFORML なし
	ELSE
		IF CSTR:LOCAL:8 == ""
			PRINTFORML %ITEMNAME:(CFLAG:LOCAL:40)%
		ELSE
			PRINTFORML %CSTR:LOCAL:8%（%ITEMNAME:(CFLAG:LOCAL:40)%）
		ENDIF
	ENDIF
	IF TALENT:LOCAL:변신능력 == 1
		PRINT 【　외투　】
		IF CFLAG:LOCAL:41 == 0
			PRINTFORM なし
			PRINTL （変身後）
		ELSE
			IF CSTR:LOCAL:9 == ""
				PRINTFORM %ITEMNAME:(CFLAG:LOCAL:41)%
			ELSE
				PRINTFORM %CSTR:LOCAL:9%（%ITEMNAME:(CFLAG:LOCAL:41)%）
			ENDIF
			PRINTL （変身後）
		ENDIF
	ENDIF
	PRINT 【　속옷　】
	IF CFLAG:LOCAL:42 == 0
		PRINTFORML なし
	ELSE
		PRINTFORML %ITEMNAME:(CFLAG:LOCAL:42)%
	ENDIF
	PRINT 【　기타　】
	IF CFLAG:LOCAL:43 == 0
		PRINTFORML なし
	ELSE
		PRINTFORML %ITEMNAME:(CFLAG:LOCAL:43)%
	ENDIF
	DRAWLINE
	PRINTL どの衣装を설정しますか？
	PRINT [1]겉옷　　　　　　　　　　
	CALL CLOTH_HOSEI(LOCAL,CFLAG:LOCAL:40,"SLOT")
	CUSTOMIZE:0 = RESULT
	IF CUSTOMIZE:0 >= 0
		PRINT [10]カスタマイズ　　　　
	ELSEIF CFLAG:LOCAL:40 != 0
		SETCOLOR 105,105,105
		PRINTPLAIN [10]カスタマイズ　　　　
		RESETCOLOR
	ENDIF
	SIF CFLAG:LOCAL:40 != 0
		PRINT [11]名称変更　　　　　
	SIF CSTR:LOCAL:8 != "" && CFLAG:LOCAL:40 != 0
		PRINT [12]消去
	PRINTL 
	IF TALENT:LOCAL:변신능력 == 0 || TALENT:LOCAL:변신능력 == -1
		PRINT [2]インナー　　　　　　　　　　
		CALL CLOTH_HOSEI(LOCAL,CFLAG:LOCAL:42,"SLOT")
		CUSTOMIZE_INNER:0 = RESULT
		IF CUSTOMIZE_INNER:0 >= 0
			PRINT [20]カスタマイズ　　　　
		ELSEIF CFLAG:LOCAL:42 != 0
			SETCOLOR 105,105,105
			PRINTPLAIN [20]カスタマイズ　　　　
			RESETCOLOR
		ENDIF
		PRINTL 
		PRINTL [3]その他装備品
	ELSEIF TALENT:LOCAL:변신능력 == 1
		PRINT [2]겉옷（変身後）　　　　　
		CALL CLOTH_HOSEI(LOCAL,CFLAG:LOCAL:41,"SLOT")
		CUSTOMIZE:1 = RESULT
		IF CUSTOMIZE:1 >= 0
			PRINT [20]カスタマイズ　　　　
		ELSEIF CFLAG:LOCAL:41 != 0
			SETCOLOR 105,105,105
			PRINTPLAIN [20]カスタマイズ　　　　
			RESETCOLOR
		ENDIF
		SIF CFLAG:LOCAL:41 != 0
			PRINT [21]名称変更　　　　　
		SIF CSTR:LOCAL:9 != "" && CFLAG:LOCAL:41 != 0
			PRINT [22]消去
		PRINTL 
		PRINT [3]インナー　　　　　　　　　　
		CALL CLOTH_HOSEI(LOCAL,CFLAG:LOCAL:42,"SLOT")
		CUSTOMIZE_INNER:0 = RESULT
		IF CUSTOMIZE_INNER:0 >= 0
			PRINT [30]カスタマイズ
		ELSEIF CFLAG:LOCAL:42 != 0
			SETCOLOR 105,105,105
			PRINTPLAIN [30]カスタマイズ
			RESETCOLOR
		ENDIF
		PRINTL 
		PRINTL [4]その他装備品
	ENDIF
	DRAWLINE
	PRINTL [100]所持衣装一覧
	DRAWLINE
	PRINTL [999] 돌아간다
	INPUT
	IF RESULT == 999
		IF CHARANUM >= 3
			GOTO INPUT_LOOP_FUNCTIONSTART
		ELSE
			RETURN
		ENDIF
	ELSEIF RESULT == 1
		CALL CLOTH_SETTING_OUTER, LOCAL
		GOTO INPUT_LOOP
	ELSEIF RESULT == 2 && TALENT:LOCAL:변신능력 == 1
		CALL CLOTH_SETTING_OUTER2, LOCAL
		GOTO INPUT_LOOP
	ELSEIF (RESULT == 2 && TALENT:LOCAL:변신능력 < 1) || (RESULT == 3 && TALENT:LOCAL:변신능력 == 1)
		IF CFLAG:LOCAL:42 == 400
			CALL CLOTH_RESETTING_TENTACLECLOTH, LOCAL
		ELSE
			CALL CLOTH_SETTING_INNER, LOCAL
		ENDIF
		GOTO INPUT_LOOP
	ELSEIF (RESULT == 3 && TALENT:LOCAL:변신능력 < 1) || (RESULT == 4 && TALENT:LOCAL:변신능력 == 1)
		CALL CLOTH_SETTING_MISC, LOCAL
		GOTO INPUT_LOOP
	ELSEIF RESULT == 10 && CUSTOMIZE:0 >= 0 && CFLAG:LOCAL:40 != 0
		CALL CLOTH_CUSTOMIZE_OUTER, LOCAL, 40
		GOTO INPUT_LOOP
	ELSEIF RESULT == 11 && CFLAG:LOCAL:40 != 0
		PRINTL 名称を入力してください：
		INPUTS
		CSTR:LOCAL:8 = %RESULTS%
		GOTO INPUT_LOOP
	ELSEIF RESULT == 12 && CFLAG:LOCAL:40 != 0
		CSTR:LOCAL:8 =
		GOTO INPUT_LOOP
	ELSEIF (RESULT == 20 && TALENT:LOCAL:변신능력 < 1) || (RESULT == 30 && TALENT:LOCAL:변신능력 == 1)
		IF CUSTOMIZE_INNER:0 >= 0 && CFLAG:LOCAL:42 != 0
			CALL CLOTH_CUSTOMIZE_INNER, LOCAL, 42
			GOTO INPUT_LOOP
		ENDIF
	ELSEIF RESULT == 20 && CUSTOMIZE:1 >= 0 && CFLAG:LOCAL:41 != 0 && TALENT:LOCAL:변신능력 == 1
		IF CUSTOMIZE:1 > 0
			CALL CLOTH_CUSTOMIZE_OUTER2, LOCAL, 41
		ELSE
			CALL CLOTH_CUSTOMIZE_OUTER, LOCAL, 41
		ENDIF
		GOTO INPUT_LOOP
	ELSEIF RESULT == 21 && TALENT:LOCAL:변신능력 == 1 && CFLAG:LOCAL:41 != 0
		PRINTL 名称を入力してください：
		INPUTS
		CSTR:LOCAL:9 = %RESULTS%
		GOTO INPUT_LOOP
	ELSEIF RESULT == 22 && TALENT:LOCAL:변신능력 == 1 && CFLAG:LOCAL:41 != 0
		CSTR:LOCAL:9 =
		GOTO INPUT_LOOP
	ELSEIF RESULT == 100
		CALL SHOW_CLOTH("표시 화면")
		GOTO INPUT_LOOP
	ELSE
		PRINTL 
		PRINTW 올바른 값을 입력해 주십시오.
		GOTO INPUT_LOOP
	ENDIF
ENDIF


;----------------------------------------------------------
;겉옷の설정
@CLOTH_SETTING_OUTER, ARG
#DIM CHECK
CHECK = CFLAG:ARG:40
$INPUT_LOOP
PRINTL 
PRINTL 겉옷を選んでください
DRAWLINE
IF CHECK >= 100 && CHECK < 200 && ITEM:CHECK == 1
	PRINTL 
	PRINTFORML %ITEMNAME:CHECK%
	CALLFORM CLOTH_DESCRIPTION_{CHECK}
	PRINTL 
	DRAWLINE
ENDIF
LOCAL:1 = 0
LOCAL:2 = 30
FOR LOCAL, 100, 200
	IF ITEM:LOCAL == 1 && ITEMNAME:LOCAL !=""
		SIF LOCAL == CHECK
			SETCOLOR 120,255,0
		LOCALS:0 = [{LOCAL}]%ITEMNAME:LOCAL%
		PRINTFORM %LOCALS:0,LOCAL:2,LEFT%
		LOCAL:1 += 1
		RESETCOLOR
		IF LOCAL:1 == 3
			LOCAL:1 = 0
			PRINTL 
		ENDIF
	ENDIF
NEXT
PRINTL 
DRAWLINE
PRINTL [0]変更しないで돌아간다
PRINTL [1]変更する
PRINTL [2]겉옷を설정しない
INPUT
IF RESULT >= 100 && RESULT < 200 && ITEM:RESULT == 1
	CHECK = RESULT
	GOTO INPUT_LOOP
ELSEIF RESULT == 0
ELSEIF RESULT == 1
	;非戦闘員専用
	IF CHECK == 197 && ITEM:CHECK == 1 && TALENT:ARG:변신능력 != -1
		PRINTL 
		PRINTW この겉옷は非戦闘員専用です
		GOTO INPUT_LOOP
	ELSEIF CHECK >= 100 && CHECK < 200 && ITEM:CHECK == 1
		;SIF CFLAG:ARG:40 == 199
		;	CFLAG:ARG:41 = 0
		CFLAG:ARG:40 = CHECK
		PRINTFORML 겉옷を%ITEMNAME:CHECK%に変更しました
		PRINTW 
		;SIF CFLAG:ARG:40 == 199
		;	CFLAG:ARG:41 = 199
	ELSE
		PRINTL 
		PRINTW 올바른 값을 입력해 주십시오.
		GOTO INPUT_LOOP
	ENDIF
ELSEIF RESULT == 2
	;SIF CFLAG:ARG:40 == 199
	;	CFLAG:ARG:41 = 0
	CFLAG:ARG:40 = 0
	PRINTL 겉옷を설정しませんでした
	PRINTW 
ELSE
	PRINTL 
	PRINTW 올바른 값을 입력해 주십시오.
	GOTO INPUT_LOOP
ENDIF



;----------------------------------------------------------
;겉옷（変身後）の설정
@CLOTH_SETTING_OUTER2, ARG
#DIM CHECK
CHECK = CFLAG:ARG:41
$INPUT_LOOP
PRINTL 
PRINTL 겉옷（変身後）を選んでください
DRAWLINE
IF CHECK >= 100 && CHECK < 300 && ITEM:CHECK == 1 || CHECK == 401
	PRINTL 
	PRINTFORML %ITEMNAME:CHECK%
	CALLFORM CLOTH_DESCRIPTION_{CHECK}
	PRINTL 
	DRAWLINE
ENDIF
LOCAL:1 = 0
LOCAL:2 = 30
FOR LOCAL, 100, 300
	;非戦闘員専用
	SIF LOCAL == 197
		CONTINUE
	IF ITEM:LOCAL == 1 && ITEMNAME:LOCAL !=""
		SIF LOCAL == CHECK
			SETCOLOR 120,255,0
		LOCALS:0 = [{LOCAL}]%ITEMNAME:LOCAL%
		PRINTFORM %LOCALS:0,LOCAL:2,LEFT%
		LOCAL:1 += 1
		RESETCOLOR
		IF LOCAL:1 == 3
			LOCAL:1 = 0
			PRINTL 
		ENDIF
	ENDIF
NEXT
;사악한 마장
IF EXP:ARG:함락경험 > 0
	LOCALS:0 = [401]%ITEMNAME:401%
	PRINTFORM %LOCALS:0,LOCAL:2,LEFT%
	LOCAL:1 += 1
	IF LOCAL:1 == 3
		LOCAL:1 = 0
		PRINTL 
	ENDIF
ENDIF
PRINTL 
DRAWLINE
PRINTL [0]変更しないで돌아간다
PRINTL [1]変更する
PRINTL [2]겉옷（変身後）を설정しない
INPUT
IF RESULT >= 100 && RESULT < 300 && ITEM:RESULT == 1
	CHECK = RESULT
	GOTO INPUT_LOOP
ELSEIF RESULT == 401 && EXP:ARG:함락경험 > 0
	CHECK = RESULT
	GOTO INPUT_LOOP
ELSEIF RESULT == 0
ELSEIF RESULT == 1
	;非戦闘員専用
	IF CHECK == 197 && ITEM:CHECK == 1 && TALENT:ARG:변신능력 != -1
		PRINTL 
		PRINTW この겉옷は非戦闘員専用です
		GOTO INPUT_LOOP
	ELSEIF CHECK == 401 && EXP:ARG:함락경험 <= 0
		PRINTL 
		PRINTW この겉옷は함락경험이 無いと付けられません
		GOTO INPUT_LOOP
	ELSEIF CHECK >= 100 && CHECK < 300 && ITEM:CHECK == 1 || CHECK == 401
		;SIF CFLAG:ARG:41 == 199
		;	CFLAG:ARG:40 = 0
		;変身コスチュームのカスタマイズをリセット
		IF CFLAG:ARG:41 != CHECK
			FOR LOCAL:1, 600, 700
				EQUIP:ARG:(LOCAL:1) = 0
			NEXT
		ENDIF
		CFLAG:ARG:41 = CHECK
		PRINTFORML 겉옷（変身後）を%ITEMNAME:CHECK%に変更しました
		PRINTW 
		;SIF CFLAG:ARG:41 == 199
		;	CFLAG:ARG:40 = 199
	ELSE
		PRINTL 
		PRINTW 올바른 값을 입력해 주십시오.
		GOTO INPUT_LOOP
	ENDIF
ELSEIF RESULT == 2
	;SIF CFLAG:ARG:41 == 199
	;	CFLAG:ARG:40 = 0
	CFLAG:ARG:41 = 0
	PRINTL 겉옷（変身後）を설정しませんでした
	PRINTW 
ELSE
	PRINTL 
	PRINTW 올바른 값을 입력해 주십시오.
	GOTO INPUT_LOOP
ENDIF

;----------------------------------------------------------
;속옷の설정
@CLOTH_SETTING_INNER, ARG
#DIM CHECK
CHECK = CFLAG:ARG:42
$INPUT_LOOP
PRINTL 
PRINTL 속옷を選んでください
DRAWLINE
IF CHECK >= 300 && CHECK < 400 && ITEM:CHECK == 1
	PRINTL 
	PRINTFORML %ITEMNAME:CHECK%
	CALLFORM CLOTH_DESCRIPTION_{CHECK}
	PRINTL 
	DRAWLINE
ENDIF
LOCAL:1 = 0
LOCAL:2 = 30
FOR LOCAL, 300, 400
	IF ITEM:LOCAL == 1 && ITEMNAME:LOCAL !=""
		SIF LOCAL == CHECK
			SETCOLOR 120,255,0
		LOCALS:0 = [{LOCAL}]%ITEMNAME:LOCAL,21,LEFT%
		PRINTFORM %LOCALS:0,LOCAL:2,LEFT%
		LOCAL:1 += 1
		RESETCOLOR
		IF LOCAL:1 == 3
			LOCAL:1 = 0
			PRINTL 
		ENDIF
	ENDIF
NEXT
PRINTL 
DRAWLINE
PRINTL [0]変更しないで돌아간다
PRINTL [1]変更する
PRINTL [2]속옷を설정しない
INPUT
IF RESULT >= 300 && RESULT < 400 && ITEM:RESULT == 1
	CHECK = RESULT
	GOTO INPUT_LOOP
ELSEIF RESULT == 0
ELSEIF RESULT == 1
	IF CHECK >= 300 && CHECK < 400 && ITEM:CHECK == 1
		CFLAG:ARG:42 = CHECK
		PRINTFORML 속옷を%ITEMNAME:CHECK%に変更しました
		PRINTW 
		IF CFLAG:ARG:42 == 399
			CFLAG:ARG:42 = 400
			PRINTFORMW 
			PRINTFORML 突如、%PRINT_CALLNAME(ARG)%が身につけた%ITEMNAME:399%が激しく蠢きだした。
			PRINTFORML 布地の内側に촉수を生やした%ITEMNAME:399%は%PRINT_CALLNAME(ARG)%の柔肌にしがみつくと
			PRINTFORML 無防備な胸や秘部に吸い付き、舐め回した。
			PRINTFORMW 
			PRINTFORML 喘ぎ混じりの悲鳴を上げる%PRINT_CALLNAME(ARG)%をよそに%ITEMNAME:399%は擬態を解き
			PRINTFORML %PRINT_CALLNAME(ARG)%を常に弄ぶ拘束具へと変貌を遂げたのだった・・・
			PRINTFORMW 
		ENDIF
		IF CFLAG:ARG:42 != 308
			IF FIGURE_SPLIT(EQUIP:ARG:103, 4) == 2
				;露出度合い
				LOCAL = 0
				SIF FIGURE_SPLIT(EQUIP:ARG:103, 2) == 1
					LOCAL -= 1
				SIF FIGURE_SPLIT(EQUIP:ARG:103, 2) == 2
					LOCAL -= 1
				SIF FIGURE_SPLIT(EQUIP:ARG:103, 2) == 3
					LOCAL -= 2
				SIF FIGURE_SPLIT(EQUIP:ARG:103, 4) == 1
					LOCAL -= 1
				SIF FIGURE_SPLIT(EQUIP:ARG:103, 4) == 2
					LOCAL -= 4

				SIF FIGURE_SPLIT(EQUIP:ARG:103, 2) == 4
					LOCAL += 1
				SIF FIGURE_SPLIT(EQUIP:ARG:103, 4) == 3
					LOCAL += 1
				SIF FIGURE_SPLIT(EQUIP:ARG:103, 4) == 4
					LOCAL += 2
				SIF FIGURE_SPLIT(EQUIP:ARG:103, 5) == 4
					LOCAL += 1

				;補正効果
				;軽装
				SIF LOCAL < 0
					EQUIP:ARG:103 += LOCAL * POWER(10, 9)
				;重装
				SIF LOCAL > 0
					EQUIP:ARG:103 -= LOCAL * POWER(10, 10)
				;下着保護ダウン
				SIF FIGURE_SPLIT(EQUIP:ARG:103, 4) == 2
					EQUIP:ARG:103 -= 4 * POWER(10, 11)
				;下着保護アップ
				SIF FIGURE_SPLIT(EQUIP:ARG:103, 4) == 4
					EQUIP:ARG:103 -= 2 * POWER(10, 12)
				SIF FIGURE_SPLIT(EQUIP:ARG:103, 5) == 4
					EQUIP:ARG:103 -= 1 * POWER(10, 12)
				EQUIP:ARG:103 -= 2000
			ENDIF
			IF FIGURE_SPLIT(EQUIP:ARG:3, 4) == 2
				;露出度合い
				LOCAL = 0
				SIF FIGURE_SPLIT(EQUIP:ARG:3, 2) == 1
					LOCAL -= 1
				SIF FIGURE_SPLIT(EQUIP:ARG:3, 2) == 2
					LOCAL -= 1
				SIF FIGURE_SPLIT(EQUIP:ARG:3, 2) == 3
					LOCAL -= 2
				SIF FIGURE_SPLIT(EQUIP:ARG:3, 4) == 1
					LOCAL -= 1
				SIF FIGURE_SPLIT(EQUIP:ARG:3, 4) == 2
					LOCAL -= 4

				SIF FIGURE_SPLIT(EQUIP:ARG:3, 2) == 4
					LOCAL += 1
				SIF FIGURE_SPLIT(EQUIP:ARG:3, 4) == 3
					LOCAL += 1
				SIF FIGURE_SPLIT(EQUIP:ARG:3, 4) == 4
					LOCAL += 2
				SIF FIGURE_SPLIT(EQUIP:ARG:3, 5) == 4
					LOCAL += 1

				;補正効果
				;軽装
				SIF LOCAL < 0
					EQUIP:ARG:3 += LOCAL * POWER(10, 9)
				;重装
				SIF LOCAL > 0
					EQUIP:ARG:3 -= LOCAL * POWER(10, 10)
				;下着保護ダウン
				SIF FIGURE_SPLIT(EQUIP:ARG:3, 4) == 2
					EQUIP:ARG:3 -= 4 * POWER(10, 11)
				;下着保護アップ
				SIF FIGURE_SPLIT(EQUIP:ARG:3, 4) == 4
					EQUIP:ARG:3 -= 2 * POWER(10, 12)
				SIF FIGURE_SPLIT(EQUIP:ARG:3, 5) == 4
					EQUIP:ARG:3 -= 1 * POWER(10, 12)
				EQUIP:ARG:3 -= 2000
			ENDIF
		ENDIF
	ELSE
		PRINTL 
		PRINTW 올바른 값을 입력해 주십시오.
		GOTO INPUT_LOOP
	ENDIF
ELSEIF RESULT == 2
	CFLAG:ARG:42 = 0
	PRINTL 속옷を설정しませんでした
	PRINTW 
ELSE
	PRINTL 
	PRINTW 올바른 값을 입력해 주십시오.
	GOTO INPUT_LOOP
ENDIF


;----------------------------------------------------------
;その他装備品の설정
@CLOTH_SETTING_MISC, ARG
#DIM CHECK
CHECK = CFLAG:ARG:43
$INPUT_LOOP
PRINTL 
PRINTL その他装備品を選んでください
DRAWLINE
LOCAL:1 = 0
LOCAL:2 = 30
FOR LOCAL, 500, 600
	IF ITEM:LOCAL == 1 && ITEMNAME:LOCAL !=""
		SIF LOCAL == CHECK
			SETCOLOR 120,255,0
		LOCALS:0 = [{LOCAL}]%ITEMNAME:LOCAL%
		PRINTFORM %LOCALS:0,LOCAL:2,LEFT%
		LOCAL:1 += 1
		RESETCOLOR
		IF LOCAL:1 == 3
			LOCAL:1 = 0
			PRINTL 
		ENDIF
	ENDIF
NEXT
PRINTL 
DRAWLINE
PRINTL [0]変更しないで돌아간다
PRINTL [1]変更する
PRINTL [2]その他装備品を설정しない
INPUT
IF RESULT >= 500 && RESULT < 600 && ITEM:RESULT == 1
	CHECK = RESULT
	GOTO INPUT_LOOP
ELSEIF RESULT == 0
ELSEIF RESULT == 1
	IF CHECK >= 500 && CHECK < 600 && ITEM:CHECK == 1
		CFLAG:ARG:43 = CHECK
		PRINTFORML その他装備品を%ITEMNAME:CHECK%に変更しました
		PRINTW 
	ELSE
		PRINTL 
		PRINTW 올바른 값을 입력해 주십시오.
		GOTO INPUT_LOOP
	ENDIF
ELSEIF RESULT == 2
	CFLAG:ARG:43 = 0
	PRINTL その他装備品を설정しませんでした
	PRINTW 
ELSE
	PRINTL 
	PRINTW 올바른 값을 입력해 주십시오.
	GOTO INPUT_LOOP
ENDIF


;----------------------------------------------------------
;촉수 구속구の取り外し
@CLOTH_RESETTING_TENTACLECLOTH, ARG
$INPUT_LOOP
PRINTL 
PRINTFORML %ITEMNAME:400%を取り外すには촉수의 조각が1個必要です（現在の소지 수：{FLAG:200}個）
PRINTFORML %ITEMNAME:400%を取り外しますか？
PRINTL 
PRINTL [0] 아니오
PRINTL [1] 네
INPUT
IF RESULT == 0
ELSEIF RESULT == 1
	IF FLAG:200 < 1
		PRINTL 촉수의 조각이 부족합니다.
		PRINTW 
		GOTO INPUT_LOOP
	ELSE
		FLAG:200 -= 1
		CFLAG:ARG:42 = 0
		PRINTFORML %ITEMNAME:400%を取り外しました
		PRINTW 
	ENDIF
ELSE
	PRINTL 
	PRINTW 올바른 값을 입력해 주십시오.
	GOTO INPUT_LOOP
ENDIF



;------------------------------------------------------------------------------------------------------------------------------------------------------------
;겉옷（通常）のカスタマイズ
@CLOTH_CUSTOMIZE_OUTER, ARG, ARG:1
#DIM KEEPTARGET
#DIM LINE
#DIM STR_LENGTH
#DIM TAIRYOKU_CAL
#DIM KIRYOKU_CAL
#DIM ID
IF TALENT:ARG:변신능력 > 0 && ARG:1 == 41
	CFLAG:ARG:1 = 1
	ID = CFLAG:ARG:(ARG:1)
ELSE
	ID = CFLAG:ARG:(ARG:1) - 100
ENDIF
LINE = LINECOUNT
STR_LENGTH = 35
KEEPTARGET = TARGET
TARGET = ARG
;체력, 기력の補正値を読み込み
IF CFLAG:ARG:(ARG:1) > 199
	TAIRYOKU_CAL = 10
	KIRYOKU_CAL = 10
ELSE
	TAIRYOKU_CAL = 5
	KIRYOKU_CAL = 5
ENDIF

$MASTER_LOOP
VARSET LOCAL
PRINTL 
PRINT カスタマイズ項目を選んでください
SIF ARG:1 == 41
	PRINT （変身時）
PRINTL 
DRAWLINE
PRINTFORML %ITEMNAME:(CFLAG:ARG:(ARG:1)), 30,LEFT%
;衣装の性能
PRINT 【 基本 】
VARSET LOCALS
;공격
CALL CLOTH_HOSEI(ARG,CFLAG:ARG:(ARG:1),"KOUGEKI")
IF RESULT != 100
	IF RESULT % 10 == 0
		LOCALS = {RESULT / 100}.{(RESULT % 100) / 10}
	ELSE
		LOCALS = {RESULT / 100}.{RESULT % 100 / 10}{RESULT % 10}
	ENDIF
	STRLENS LOCALS:1
	LOCALS:(1 + (RESULT > STR_LENGTH)) += @"공격%LOCALS%倍　"
ENDIF
;방어
CALL CLOTH_HOSEI(ARG,CFLAG:ARG:(ARG:1),"BOUGYO")
IF RESULT != 100
	IF RESULT % 10 == 0
		LOCALS = {RESULT / 100}.{(RESULT % 100) / 10}
	ELSE
		LOCALS = {RESULT / 100}.{RESULT % 100 / 10}{RESULT % 10}
	ENDIF
	STRLENS LOCALS:1
	LOCALS:(1 + (RESULT > STR_LENGTH)) += @"방어%LOCALS%倍　"
ENDIF
;민첩
CALL CLOTH_HOSEI(ARG,CFLAG:ARG:(ARG:1),"BINSYOU")
IF RESULT != 100
	IF RESULT % 10 == 0
		LOCALS = {RESULT / 100}.{(RESULT % 100) / 10}
	ELSE
		LOCALS = {RESULT / 100}.{RESULT % 100 / 10}{RESULT % 10}
	ENDIF
	STRLENS LOCALS:1
	LOCALS:(1 + (RESULT > STR_LENGTH)) += @"민첩%LOCALS%倍　"
ENDIF
;지성
CALL CLOTH_HOSEI(ARG,CFLAG:ARG:(ARG:1),"CHISEI")
IF RESULT != 100
	IF RESULT % 10 == 0
		LOCALS = {RESULT / 100}.{(RESULT % 100) / 10}
	ELSE
		LOCALS = {RESULT / 100}.{RESULT % 100 / 10}{RESULT % 10}
	ENDIF
	STRLENS LOCALS:1
	LOCALS:(1 + (RESULT > STR_LENGTH)) += @"지성%LOCALS%倍　"
ENDIF
;체력
CALL CLOTH_HOSEI(ARG,CFLAG:ARG:(ARG:1),"TAIRYOKU")
IF (RESULT + TAIRYOKU_CAL) != 100
	RESULT += TAIRYOKU_CAL
	IF RESULT % 10 == 0
		LOCALS = {RESULT / 100}.{(RESULT % 100) / 10}
	ELSE
		LOCALS = {RESULT / 100}.{RESULT % 100 / 10}{RESULT % 10}
	ENDIF
	STRLENS LOCALS:1
	LOCALS:(1 + (RESULT > STR_LENGTH)) += @"戦闘中の체력の減少量%LOCALS%倍　"
ENDIF
;기력
CALL CLOTH_HOSEI(ARG,CFLAG:ARG:(ARG:1),"KIRYOKU")
IF (RESULT + KIRYOKU_CAL) != 100
	RESULT += KIRYOKU_CAL
	IF RESULT % 10 == 0
		LOCALS = {RESULT / 100}.{(RESULT % 100) / 10}
	ELSE
		LOCALS = {RESULT / 100}.{RESULT % 100 / 10}{RESULT % 10}
	ENDIF
	STRLENS LOCALS:1
	LOCALS:(1 + (RESULT > STR_LENGTH)) += @"戦闘中の기력の減少量%LOCALS%倍　"
ENDIF
;성내성
CALL CLOTH_HOSEI(ARG,CFLAG:ARG:(ARG:1),"SEITAISEI")
IF (RESULT) != 100
	IF RESULT % 10 == 0
		LOCALS = {RESULT / 100}.{(RESULT % 100) / 10}
	ELSE
		LOCALS = {RESULT / 100}.{RESULT % 100 / 10}{RESULT % 10}
	ENDIF
	STRLENS LOCALS:1
	LOCALS:(1 + (RESULT > STR_LENGTH)) += @"戦闘中の성내성の減少量%LOCALS%倍　"
ENDIF
;油断度
CALL CLOTH_HOSEI(ARG,CFLAG:ARG:(ARG:1),"YUDAN")
IF (RESULT) != 100
	IF RESULT % 10 == 0
		LOCALS = {RESULT / 100}.{(RESULT % 100) / 10}
	ELSE
		LOCALS = {RESULT / 100}.{RESULT % 100 / 10}{RESULT % 10}
	ENDIF
	STRLENS LOCALS:1
	LOCALS:(1 + (RESULT > STR_LENGTH)) += @"촉수の油断度の상승량%LOCALS%倍　"
ENDIF
;クリティカル率
CALL CLOTH_HOSEI(ARG,CFLAG:ARG:(ARG:1),"CRITICAL")
IF RESULT != 0
	LOCALS = {RESULT}
	STRLENS LOCALS:1
	LOCALS:(1 + (RESULT > STR_LENGTH)) += @"クリティカル補正 +%LOCALS%％　"
ENDIF
;命中率強化
CALL CLOTH_HOSEI(ARG,CFLAG:ARG:(ARG:1),"HIT")
;ここでは特性としての値のみ表示するので、重装・軽装による補正は打ち消す
IF CFLAG:ARG:1 > 0
	RESULT += 1 * ((FIGURE_SPLIT(EQUIP:ARG:(CFLAG:ARG:(ARG:1)),11) - FIGURE_SPLIT(EQUIP:ARG:(CFLAG:ARG:(ARG:1)),10)))
ELSE
	RESULT += 1 * ((FIGURE_SPLIT(EQUIP:ARG:(CFLAG:ARG:(ARG:1) - 100),11) - FIGURE_SPLIT(EQUIP:ARG:(CFLAG:ARG:(ARG:1) - 100),10)))
ENDIF
IF RESULT > 0
	LOCALS = {RESULT}
	STRLENS LOCALS:1
	LOCALS:(1 + (RESULT > STR_LENGTH)) += @"命中率補正 +%LOCALS%％　"
ELSEIF RESULT < 0
	LOCALS = {RESULT}
	STRLENS LOCALS:1
	LOCALS:(1 + (RESULT > STR_LENGTH)) += @"命中率補正 %LOCALS%％　"
ENDIF
;回避率
CALL CLOTH_HOSEI(ARG,CFLAG:ARG:(ARG:1),"AVOID")
IF RESULT != 0
	LOCALS = {RESULT}
	STRLENS LOCALS:1
	LOCALS:(1 + (RESULT > STR_LENGTH)) += @"回避率補正	+%LOCALS%％　"
ENDIF
;ＥＸブースト
CALL CLOTH_HOSEI(ARG,CFLAG:ARG:(ARG:1),"EXBOOST")
IF RESULT > 0
	STRLENS LOCALS:1
	LOCALS:(1 + (RESULT > STR_LENGTH)) += @"EX 게이지増幅　"
ENDIF
;空中性能強化
CALL CLOTH_HOSEI(ARG,CFLAG:ARG:(ARG:1),"AIRPLUS")
IF RESULT > 0
	STRLENS LOCALS:1
	LOCALS:(1 + (RESULT > STR_LENGTH)) += @"空中性能強化　"
ENDIF
;粘液軽減
CALL CLOTH_HOSEI(ARG,CFLAG:ARG:(ARG:1),"LIQUID")
IF RESULT <= 70
	STRLENS LOCALS:1
	LOCALS:(1 + (RESULT > STR_LENGTH)) += @"粘液ダメージ軽減（大）　"
ELSEIF RESULT <= 80
	STRLENS LOCALS:1
	LOCALS:(1 + (RESULT > STR_LENGTH)) += @"粘液ダメージ軽減（中）　"
ELSEIF RESULT <= 90
	STRLENS LOCALS:1
	LOCALS:(1 + (RESULT > STR_LENGTH)) += @"粘液ダメージ軽減（小）　"
ENDIF
;波動軽減
CALL CLOTH_HOSEI(ARG,CFLAG:ARG:(ARG:1),"WAVE")
IF RESULT <= 70
	STRLENS LOCALS:1
	LOCALS:(1 + (RESULT > STR_LENGTH)) += @"邪気ダメージ軽減（大）　"
ELSEIF RESULT <= 80
	STRLENS LOCALS:1
	LOCALS:(1 + (RESULT > STR_LENGTH)) += @"邪気ダメージ軽減（中）　"
ELSEIF RESULT <= 90
	STRLENS LOCALS:1
	LOCALS:(1 + (RESULT > STR_LENGTH)) += @"邪気ダメージ軽減（小）　"
ENDIF
;支援回復効果アップ
CALL CLOTH_HOSEI(ARG,CFLAG:ARG:(ARG:1),"HEALUP")
IF RESULT > 0
	LOCALS = {RESULT}
	STRLENS LOCALS:1
	LOCALS:(1 + (RESULT > STR_LENGTH)) += @"支援時の回復効果増幅　"
ENDIF
;속옷겸용
CALL CLOTH_HOSEI(ARG,CFLAG:ARG:(ARG:1),"NOINNER")
IF RESULT > 0
	STRLENS LOCALS:1
	LOCALS:(1 + (RESULT > STR_LENGTH)) += @"속옷겸용　"
ENDIF

;露出度
CALL CLOTH_HOSEI(ARG,CFLAG:ARG:(ARG:1),"SHYNESS")
IF RESULT > 130
	STRLENS LOCALS:1
	LOCALS:(1 + (RESULT > STR_LENGTH)) += @"露出度が高い（大）　"
ELSEIF RESULT > 115
	STRLENS LOCALS:1
	LOCALS:(1 + (RESULT > STR_LENGTH)) += @"露出度が高い（中）　"
ELSEIF RESULT > 100
	STRLENS LOCALS:1
	LOCALS:(1 + (RESULT > STR_LENGTH)) += @"露出度が高い（小）　"
ENDIF

PRINTFORML %LOCALS:1%
IF LOCALS:2 != ""
	PRINT 　　　　　
	PRINTFORML %LOCALS:2%
ENDIF
PRINT 【 補正 】
;重量補正
LOCAL = FIGURE_SPLIT(EQUIP:ARG:ID,11) - FIGURE_SPLIT(EQUIP:ARG:ID,10)
SIF LOCAL > 0
	PRINTFORM 命中-{LOCAL}％　
SIF LOCAL < 0
	PRINTFORM 命中+{-1*LOCAL}％　
;下着保護
LOCAL = FIGURE_SPLIT(EQUIP:ARG:ID,13) - FIGURE_SPLIT(EQUIP:ARG:ID,12)
IF LOCAL > 0
	IF CLOTH_NO_INNER == 0
		PRINTFORM 下着保護+{5*LOCAL}％　
	ELSE
		PRINTFORM 挿入抵抗+{5*LOCAL}％　
	ENDIF
ELSEIF LOCAL < 0
	IF CLOTH_NO_INNER == 0
		PRINTFORM 下着保護{5*LOCAL}％　
	ELSE
		PRINTFORM 挿入抵抗{5*LOCAL}％　
	ENDIF
ENDIF
PRINTL 
PRINT 【耐久力】
CALL CLOTH_HOSEI(ARG,CFLAG:ARG:(ARG:1),"HP")
IF RESULT!=-1
	CALL CLOTH_CUSTOMIZE_COMMONPARTS_CAL, RESULT, "HP"
ENDIF
IF RESULT > 0
	PRINTFORM {RESULT}
ELSE
	PRINT ─
ENDIF
PRINTL 
DRAWLINE
TRYCALLFORM CLOTH_CUSTOMIZE_OPTION_{CFLAG:ARG:(ARG:1)},ARG
IF RESULT == 99
	CFLAG:ARG:1 = 0
	RETURN
ELSEIF RESULT == -1
	CLEARLINE LINECOUNT - LINE
	GOTO MASTER_LOOP
ENDIF

;------------------------------------------------------------------------------------------------------------------------------------------------------------
;겉옷（変身後専用）のカスタマイズ
@CLOTH_CUSTOMIZE_OUTER2, ARG, ARG:1
#DIM KEEPTARGET
#DIM SLOTMAX
#DIM SLOTUSED
#DIM LINE
#DIM STR_LENGTH
#DIM TAIRYOKU_CAL
#DIM KIRYOKU_CAL
LINE = LINECOUNT
STR_LENGTH = 36
KEEPTARGET = TARGET
TARGET = ARG
;체력, 기력の補正値を読み込み
CALL CLOTH_HOSEI(ARG,CFLAG:ARG:(ARG:1),"TAIRYOKU")
TAIRYOKU_CAL = 100 - RESULT
CALL CLOTH_HOSEI(ARG,CFLAG:ARG:(ARG:1),"KIRYOKU")
KIRYOKU_CAL = 100 - RESULT

$INPUT_LOOP
VARSET LOCAL
CALL CLOTH_HOSEI(ARG,CFLAG:ARG:(ARG:1),"SLOT")
SLOTMAX = RESULT
SLOTUSED = 0
FOR LOCAL, 600, 700
	SIF EQUIP:ARG:LOCAL > 0
		SLOTUSED ++
NEXT
PRINTL 
PRINTL カスタマイズ項目を選んでください
DRAWLINE
PRINTFORML %ITEMNAME:(CFLAG:ARG:(ARG:1)), 30,LEFT%
;衣装の性能
PRINT 【 基本 】
SIF CFLAG:ARG:(ARG:1) == 200
		PRINT 下着へのダメージ軽減　
;ゴムスーツ特殊
SIF CFLAG:ARG:(ARG:1) == 299
		PRINT 避妊効果　
CALL CLOTH_HOSEI(ARG,CFLAG:ARG:(ARG:1),"NOINNER")
SIF RESULT > 0
		PRINT 속옷겸용　
PRINT スロット数：
REPEAT SLOTUSED
	PRINT ●
REND
REPEAT SLOTMAX - SLOTUSED
	PRINT 〇
REND
PRINTL 
VARSET LOCALS
PRINT 【 補正 】
;공격
CALL CLOTH_HOSEI(ARG,CFLAG:ARG:(ARG:1),"KOUGEKI")
CALL CLOTH_CUSTOMIZE_COMMONPARTS_CAL, RESULT, "KOUGEKI"
IF RESULT != 100
	IF RESULT % 10 == 0
		LOCALS = {RESULT / 100}.{(RESULT % 100) / 10}
	ELSE
		LOCALS = {RESULT / 100}.{RESULT % 100 / 10}{RESULT % 10}
	ENDIF
	STRLENS LOCALS:1
	LOCALS:(1 + (RESULT > STR_LENGTH)) += @"공격%LOCALS%倍　"
ENDIF
;방어
CALL CLOTH_HOSEI(ARG,CFLAG:ARG:(ARG:1),"BOUGYO")
CALL CLOTH_CUSTOMIZE_COMMONPARTS_CAL, RESULT, "BOUGYO"
IF RESULT != 100
	IF RESULT % 10 == 0
		LOCALS = {RESULT / 100}.{(RESULT % 100) / 10}
	ELSE
		LOCALS = {RESULT / 100}.{RESULT % 100 / 10}{RESULT % 10}
	ENDIF
	STRLENS LOCALS:1
	LOCALS:(1 + (RESULT > STR_LENGTH)) += @"방어%LOCALS%倍　"
ENDIF
;민첩
CALL CLOTH_HOSEI(ARG,CFLAG:ARG:(ARG:1),"BINSYOU")
CALL CLOTH_CUSTOMIZE_COMMONPARTS_CAL, RESULT, "BINSYOU"
IF RESULT != 100
	IF RESULT % 10 == 0
		LOCALS = {RESULT / 100}.{(RESULT % 100) / 10}
	ELSE
		LOCALS = {RESULT / 100}.{RESULT % 100 / 10}{RESULT % 10}
	ENDIF
	STRLENS LOCALS:1
	LOCALS:(1 + (RESULT > STR_LENGTH)) += @"민첩%LOCALS%倍　"
ENDIF
;지성
CALL CLOTH_HOSEI(ARG,CFLAG:ARG:(ARG:1),"CHISEI")
CALL CLOTH_CUSTOMIZE_COMMONPARTS_CAL, RESULT, "CHISEI"
IF RESULT != 100
	IF RESULT % 10 == 0
		LOCALS = {RESULT / 100}.{(RESULT % 100) / 10}
	ELSE
		LOCALS = {RESULT / 100}.{RESULT % 100 / 10}{RESULT % 10}
	ENDIF
	STRLENS LOCALS:1
	LOCALS:(1 + (RESULT > STR_LENGTH)) += @"지성%LOCALS%倍　"
ENDIF
;체력
CALL CLOTH_HOSEI(ARG,CFLAG:ARG:(ARG:1),"TAIRYOKU")
CALL CLOTH_CUSTOMIZE_COMMONPARTS_CAL, RESULT, "TAIRYOKU"
IF (RESULT + TAIRYOKU_CAL) != 100
	RESULT += 10
	IF RESULT % 10 == 0
		LOCALS = {RESULT / 100}.{(RESULT % 100) / 10}
	ELSE
		LOCALS = {RESULT / 100}.{RESULT % 100 / 10}{RESULT % 10}
	ENDIF
	STRLENS LOCALS:1
	LOCALS:(1 + (RESULT > STR_LENGTH)) += @"戦闘中の체력の減少量%LOCALS%倍　"
ENDIF
;기력
CALL CLOTH_HOSEI(ARG,CFLAG:ARG:(ARG:1),"KIRYOKU")
CALL CLOTH_CUSTOMIZE_COMMONPARTS_CAL, RESULT, "KIRYOKU"
IF (RESULT + KIRYOKU_CAL) != 100
	RESULT += 10
	IF RESULT % 10 == 0
		LOCALS = {RESULT / 100}.{(RESULT % 100) / 10}
	ELSE
		LOCALS = {RESULT / 100}.{RESULT % 100 / 10}{RESULT % 10}
	ENDIF
	STRLENS LOCALS:1
	LOCALS:(1 + (RESULT > STR_LENGTH)) += @"戦闘中の기력の減少量%LOCALS%倍　"
ENDIF
;クリティカル率
CALL CLOTH_HOSEI(ARG,CFLAG:ARG:(ARG:1),"CRITICAL")
CALL CLOTH_CUSTOMIZE_COMMONPARTS_CAL, RESULT, "CRITICAL"
IF RESULT != 0
	LOCALS = {RESULT}
	STRLENS LOCALS:1
	LOCALS:(1 + (RESULT > STR_LENGTH)) += @"クリティカル補正 +%LOCALS%％　"
ENDIF
;ＥＸブースト
CALL CLOTH_HOSEI(ARG,CFLAG:ARG:(ARG:1),"EXBOOST")
CALL CLOTH_CUSTOMIZE_COMMONPARTS_CAL, RESULT, "EXBOOST"
IF RESULT > 0
	STRLENS LOCALS:1
	LOCALS:(1 + (RESULT > STR_LENGTH)) += @"EX 게이지増幅　"
ENDIF
;空中性能強化
CALL CLOTH_HOSEI(ARG,CFLAG:ARG:(ARG:1),"AIRPLUS")
CALL CLOTH_CUSTOMIZE_COMMONPARTS_CAL, RESULT, "AIRPLUS"
IF RESULT > 0
	STRLENS LOCALS:1
	LOCALS:(1 + (RESULT > STR_LENGTH)) += @"空中性能強化　"
ENDIF
;粘液軽減
CALL CLOTH_HOSEI(ARG,CFLAG:ARG:(ARG:1),"LIQUID")
CALL CLOTH_CUSTOMIZE_COMMONPARTS_CAL, RESULT, "LIQUID"
IF RESULT <= 70
	STRLENS LOCALS:1
	LOCALS:(1 + (RESULT > STR_LENGTH)) += @"粘液ダメージ軽減（大）　"
ELSEIF RESULT <= 80
	STRLENS LOCALS:1
	LOCALS:(1 + (RESULT > STR_LENGTH)) += @"粘液ダメージ軽減（中）　"
ELSEIF RESULT <= 90
	STRLENS LOCALS:1
	LOCALS:(1 + (RESULT > STR_LENGTH)) += @"粘液ダメージ軽減（小）　"
ENDIF
;波動軽減
CALL CLOTH_HOSEI(ARG,CFLAG:ARG:(ARG:1),"WAVE")
CALL CLOTH_CUSTOMIZE_COMMONPARTS_CAL, RESULT, "WAVE"
IF RESULT <= 70
	STRLENS LOCALS:1
	LOCALS:(1 + (RESULT > STR_LENGTH)) += @"邪気ダメージ軽減（大）　"
ELSEIF RESULT <= 80
	STRLENS LOCALS:1
	LOCALS:(1 + (RESULT > STR_LENGTH)) += @"邪気ダメージ軽減（中）　"
ELSEIF RESULT <= 90
	STRLENS LOCALS:1
	LOCALS:(1 + (RESULT > STR_LENGTH)) += @"邪気ダメージ軽減（小）　"
ENDIF

PRINTFORML %LOCALS:1%
IF LOCALS:2 != ""
	PRINT 　　　　　
	PRINTFORML %LOCALS:2%
ENDIF
PRINT 【耐久力】
CALL CLOTH_HOSEI(ARG,CFLAG:ARG:(ARG:1),"HP")
IF RESULT!=-1
	CALL CLOTH_CUSTOMIZE_COMMONPARTS_CAL, RESULT, "HP"
ENDIF
IF RESULT > 0
	PRINTFORM {RESULT}
ELSE
	PRINT ─
ENDIF
PRINTL 
DRAWLINE
LOCAL:1 = 0
LOCAL:2 = 36
PRINTL 【汎用】
FOR LOCAL, 600, 660
	IF ITEM:LOCAL == 1
		LOCALS:0 = [{LOCAL}]%ITEMNAME:LOCAL%
		SIF EQUIP:ARG:LOCAL > 0
			SETCOLOR 120,255,0
		PRINTFORM %LOCALS:0,LOCAL:2,LEFT%
		RESETCOLOR
		LOCAL:1 += 1
		IF LOCAL:1 == 3
			LOCAL:1 = 0
			PRINTL 
		ENDIF
	ENDIF
NEXT
LOCAL:1 = 0
PRINTL 
PRINTL 
PRINTL 【羽織】
FOR LOCAL, 660, 670
	IF ITEM:LOCAL == 1
		LOCALS:0 = [{LOCAL}]%ITEMNAME:LOCAL%
		SIF EQUIP:ARG:LOCAL > 0
			SETCOLOR 120,255,0
		PRINTFORM %LOCALS:0,LOCAL:2,LEFT%
		RESETCOLOR
		LOCAL:1 += 1
		IF LOCAL:1 == 3
			LOCAL:1 = 0
			PRINTL 
		ENDIF
	ENDIF
NEXT
LOCAL:1 = 0
PRINTL 
PRINTL 
PRINTL 【胸部】
FOR LOCAL, 670, 680
	IF ITEM:LOCAL == 1
		IF (LOCAL == 672 && TALENT:ARG:빈유 > 0) || (LOCAL == 673 && TALENT:ARG:거유 > 0)
			LOCALS:0 = [{LOCAL}]%ITEMNAME:LOCAL%
			SETCOLOR 105,105,105
			LOCAL:LOCAL = -1
		ELSE
			LOCALS:0 = [{LOCAL}]%ITEMNAME:LOCAL%
			SIF EQUIP:ARG:LOCAL > 0
				SETCOLOR 120,255,0
		ENDIF
		PRINTFORM %LOCALS:0,LOCAL:2,LEFT%
		RESETCOLOR
		LOCAL:1 += 1
		IF LOCAL:1 == 3
			LOCAL:1 = 0
			PRINTL 
		ENDIF
	ENDIF
NEXT
LOCAL:1 = 0
PRINTL 
PRINTL 
PRINTL 【腕部】
FOR LOCAL, 680, 690
	IF ITEM:LOCAL == 1
		LOCALS:0 = [{LOCAL}]%ITEMNAME:LOCAL%
		SIF EQUIP:ARG:LOCAL > 0
			SETCOLOR 120,255,0
		PRINTFORM %LOCALS:0,LOCAL:2,LEFT%
		RESETCOLOR
		LOCAL:1 += 1
		IF LOCAL:1 == 3
			LOCAL:1 = 0
			PRINTL 
		ENDIF
	ENDIF
NEXT
LOCAL:1 = 0
PRINTL 
PRINTL 
PRINTL 【脚部】
FOR LOCAL, 690, 700
	IF ITEM:LOCAL == 1
		IF CFLAG:ARG:(ARG:1) == 200 || CFLAG:ARG:(ARG:1) == 299
			LOCALS:0 = [{LOCAL}]%ITEMNAME:LOCAL%
			SETCOLOR 105,105,105
			LOCAL:LOCAL = -1
		ELSE
			LOCALS:0 = [{LOCAL}]%ITEMNAME:LOCAL%
			SIF EQUIP:ARG:LOCAL > 0
				SETCOLOR 120,255,0
		ENDIF
		PRINTFORM %LOCALS:0,LOCAL:2,LEFT%
		RESETCOLOR
		LOCAL:1 += 1
		IF LOCAL:1 == 3
			LOCAL:1 = 0
			PRINTL 
		ENDIF
	ENDIF
NEXT
PRINTL 
PRINTL 
PRINTL [999] 결정
PRINTL 
INPUT
IF RESULT == 999
	TARGET = KEEPTARGET
ELSEIF RESULT >= 600 && RESULT <= 700 && EQUIP:ARG:RESULT > 0 && ITEM:RESULT > 0
	SIF LOCAL:RESULT == 0
		EQUIP:ARG:RESULT = 0
	CLEARLINE LINECOUNT - LINE
	GOTO INPUT_LOOP
ELSEIF RESULT >= 600 && RESULT <= 700 && EQUIP:ARG:RESULT == 0 && ITEM:RESULT > 0
	IF LOCAL:RESULT == 0
		IF RESULT >= 660 && RESULT < 670
			FOR LOCAL, 660, 670
				IF EQUIP:ARG:LOCAL > 0
					EQUIP:ARG:LOCAL = 0
					SLOTUSED --
				ENDIF
			NEXT
		ELSEIF RESULT >= 670 && RESULT < 680
			FOR LOCAL, 670, 680
				IF EQUIP:ARG:LOCAL > 0
					EQUIP:ARG:LOCAL = 0
					SLOTUSED --
				ENDIF
			NEXT
		ELSEIF RESULT >= 680 && RESULT < 690
			FOR LOCAL, 680, 690
				IF EQUIP:ARG:LOCAL > 0
					EQUIP:ARG:LOCAL = 0
					SLOTUSED --
				ENDIF
			NEXT
		ELSEIF RESULT >= 690 && RESULT < 700
			FOR LOCAL, 690, 700
				IF EQUIP:ARG:LOCAL > 0
					EQUIP:ARG:LOCAL = 0
					SLOTUSED --
				ENDIF
			NEXT
		ENDIF
		SIF SLOTMAX - SLOTUSED > 0
			EQUIP:ARG:RESULT = 1
	ENDIF
	CLEARLINE LINECOUNT - LINE
	CALL SHORTLINE
	PRINTFORML %ITEMNAME:(RESULT)%
	CALLFORM CLOTH_DESCRIPTION_{RESULT}
	CALL SHORTLINE
	GOTO INPUT_LOOP
ELSE
	CLEARLINE LINECOUNT - LINE
	GOTO INPUT_LOOP
ENDIF
RETURN 0

;------------------------------------------------------------------------------------------------------------------------------------------------------------
;속옷のカスタマイズ
@CLOTH_CUSTOMIZE_INNER, ARG, ARG:1
#DIM KEEPTARGET
#DIM LINE
#DIM STR_LENGTH
#DIM TAIRYOKU_CAL
#DIM KIRYOKU_CAL
#DIM ID
;ID = CFLAG:ARG:(ARG:1) - 100
ID = CFLAG:ARG:(ARG:1)
LINE = LINECOUNT
STR_LENGTH = 35
KEEPTARGET = TARGET
TARGET = ARG
;체력, 기력の補正値を読み込み
TAIRYOKU_CAL = 5
KIRYOKU_CAL = 5

$MASTER_LOOP
VARSET LOCAL
PRINTL 
PRINT カスタマイズ項目を選んでください
PRINTL 
DRAWLINE
PRINTFORML %ITEMNAME:(CFLAG:ARG:(ARG:1)), 30,LEFT%
;衣装の性能
PRINT 【 基本 】
VARSET LOCALS
;공격
CALL CLOTH_HOSEI(ARG,CFLAG:ARG:(ARG:1),"KOUGEKI")
IF RESULT != 100
	IF RESULT % 10 == 0
		LOCALS = {RESULT / 100}.{(RESULT % 100) / 10}
	ELSE
		LOCALS = {RESULT / 100}.{RESULT % 100 / 10}{RESULT % 10}
	ENDIF
	STRLENS LOCALS:1
	LOCALS:(1 + (RESULT > STR_LENGTH)) += @"공격%LOCALS%倍　"
ENDIF
;방어
CALL CLOTH_HOSEI(ARG,CFLAG:ARG:(ARG:1),"BOUGYO")
IF RESULT != 100
	IF RESULT % 10 == 0
		LOCALS = {RESULT / 100}.{(RESULT % 100) / 10}
	ELSE
		LOCALS = {RESULT / 100}.{RESULT % 100 / 10}{RESULT % 10}
	ENDIF
	STRLENS LOCALS:1
	LOCALS:(1 + (RESULT > STR_LENGTH)) += @"방어%LOCALS%倍　"
ENDIF
;민첩
CALL CLOTH_HOSEI(ARG,CFLAG:ARG:(ARG:1),"BINSYOU")
IF RESULT != 100
	IF RESULT % 10 == 0
		LOCALS = {RESULT / 100}.{(RESULT % 100) / 10}
	ELSE
		LOCALS = {RESULT / 100}.{RESULT % 100 / 10}{RESULT % 10}
	ENDIF
	STRLENS LOCALS:1
	LOCALS:(1 + (RESULT > STR_LENGTH)) += @"민첩%LOCALS%倍　"
ENDIF
;지성
CALL CLOTH_HOSEI(ARG,CFLAG:ARG:(ARG:1),"CHISEI")
IF RESULT != 100
	IF RESULT % 10 == 0
		LOCALS = {RESULT / 100}.{(RESULT % 100) / 10}
	ELSE
		LOCALS = {RESULT / 100}.{RESULT % 100 / 10}{RESULT % 10}
	ENDIF
	STRLENS LOCALS:1
	LOCALS:(1 + (RESULT > STR_LENGTH)) += @"지성%LOCALS%倍　"
ENDIF
;체력
CALL CLOTH_HOSEI(ARG,CFLAG:ARG:(ARG:1),"TAIRYOKU")
IF (RESULT + TAIRYOKU_CAL) != 100
	RESULT += TAIRYOKU_CAL
	IF RESULT % 10 == 0
		LOCALS = {RESULT / 100}.{(RESULT % 100) / 10}
	ELSE
		LOCALS = {RESULT / 100}.{RESULT % 100 / 10}{RESULT % 10}
	ENDIF
	STRLENS LOCALS:1
	LOCALS:(1 + (RESULT > STR_LENGTH)) += @"戦闘中の체력の減少量%LOCALS%倍　"
ENDIF
;기력
CALL CLOTH_HOSEI(ARG,CFLAG:ARG:(ARG:1),"KIRYOKU")
IF (RESULT + KIRYOKU_CAL) != 100
	RESULT += KIRYOKU_CAL
	IF RESULT % 10 == 0
		LOCALS = {RESULT / 100}.{(RESULT % 100) / 10}
	ELSE
		LOCALS = {RESULT / 100}.{RESULT % 100 / 10}{RESULT % 10}
	ENDIF
	STRLENS LOCALS:1
	LOCALS:(1 + (RESULT > STR_LENGTH)) += @"戦闘中の기력の減少量%LOCALS%倍　"
ENDIF
;성내성
CALL CLOTH_HOSEI(ARG,CFLAG:ARG:(ARG:1),"SEITAISEI");속옷の성내성の基準値は0.95？
IF (RESULT) != 95
	LOCAL = RESULT + 5
	IF LOCAL % 10 == 0
		LOCALS = {LOCAL / 100}.{(LOCAL % 100) / 10}
	ELSE
		LOCALS = {LOCAL / 100}.{LOCAL % 100 / 10}{LOCAL % 10}
	ENDIF
	STRLENS LOCALS:1
	LOCALS:(1 + (RESULT > STR_LENGTH)) += @"戦闘中の성내성の減少量%LOCALS%倍　"
ENDIF

;油断度
CALL CLOTH_HOSEI(ARG,CFLAG:ARG:(ARG:1),"YUDAN")
RESULT += 1 * ((FIGURE_SPLIT(EQUIP:ARG:(CFLAG:ARG:(ARG:1) - 100),15) - FIGURE_SPLIT(EQUIP:ARG:(CFLAG:ARG:(ARG:1) - 100),14)))
IF (RESULT) != 100
	IF RESULT % 10 == 0
		LOCALS = {RESULT / 100}.{(RESULT % 100) / 10}
	ELSE
		LOCALS = {RESULT / 100}.{RESULT % 100 / 10}{RESULT % 10}
	ENDIF
	STRLENS LOCALS:1
	LOCALS:(1 + (RESULT > STR_LENGTH)) += @"촉수の油断度の상승량%LOCALS%倍　"
ENDIF

;クリティカル率
CALL CLOTH_HOSEI(ARG,CFLAG:ARG:(ARG:1),"CRITICAL")
IF RESULT != 0
	LOCALS = {RESULT}
	STRLENS LOCALS:1
	LOCALS:(1 + (RESULT > STR_LENGTH)) += @"クリティカル補正 +%LOCALS%％　"
ENDIF
;回避率
CALL CLOTH_HOSEI(ARG,CFLAG:ARG:(ARG:1),"AVOID")
IF RESULT != 0
	LOCALS = {RESULT}
	STRLENS LOCALS:1
	LOCALS:(1 + (RESULT > STR_LENGTH)) += @"回避率補正	+%LOCALS%％　"
ENDIF
;ＥＸブースト
CALL CLOTH_HOSEI(ARG,CFLAG:ARG:(ARG:1),"EXBOOST")
IF RESULT > 0
	STRLENS LOCALS:1
	LOCALS:(1 + (RESULT > STR_LENGTH)) += @"EX 게이지増幅　"
ENDIF
;空中性能強化
CALL CLOTH_HOSEI(ARG,CFLAG:ARG:(ARG:1),"AIRPLUS")
IF RESULT > 0
	STRLENS LOCALS:1
	LOCALS:(1 + (RESULT > STR_LENGTH)) += @"空中性能強化　"
ENDIF
;粘液軽減
CALL CLOTH_HOSEI(ARG,CFLAG:ARG:(ARG:1),"LIQUID")
IF RESULT <= 70
	STRLENS LOCALS:1
	LOCALS:(1 + (RESULT > STR_LENGTH)) += @"粘液ダメージ軽減（大）　"
ELSEIF RESULT <= 80
	STRLENS LOCALS:1
	LOCALS:(1 + (RESULT > STR_LENGTH)) += @"粘液ダメージ軽減（中）　"
ELSEIF RESULT <= 90
	STRLENS LOCALS:1
	LOCALS:(1 + (RESULT > STR_LENGTH)) += @"粘液ダメージ軽減（小）　"
ENDIF
;波動軽減
CALL CLOTH_HOSEI(ARG,CFLAG:ARG:(ARG:1),"WAVE")
IF RESULT <= 70
	STRLENS LOCALS:1
	LOCALS:(1 + (RESULT > STR_LENGTH)) += @"邪気ダメージ軽減（大）　"
ELSEIF RESULT <= 80
	STRLENS LOCALS:1
	LOCALS:(1 + (RESULT > STR_LENGTH)) += @"邪気ダメージ軽減（中）　"
ELSEIF RESULT <= 90
	STRLENS LOCALS:1
	LOCALS:(1 + (RESULT > STR_LENGTH)) += @"邪気ダメージ軽減（小）　"
ENDIF

;Ｃ自動増加耐性
CALL CLOTH_HOSEI(ARG,CFLAG:ARG:(ARG:1),"ANTICUP")
IF RESULT > 0
	LOCALS = {RESULT}
	STRLENS LOCALS:1
	LOCALS:(1 + (RESULT > STR_LENGTH)) += @"쾌C自動増加防止　"
ENDIF

;露出軽減
CALL CLOTH_HOSEI(ARG,CFLAG:ARG:(ARG:1),"SHYNESS")
IF RESULT <= 20
	STRLENS LOCALS:1
	LOCALS:(1 + (RESULT > STR_LENGTH)) += @"露出軽減（大）　"
ELSEIF RESULT <= 60
	STRLENS LOCALS:1
	LOCALS:(1 + (RESULT > STR_LENGTH)) += @"露出軽減（中）　"
ELSEIF RESULT <= 80
	STRLENS LOCALS:1
	LOCALS:(1 + (RESULT > STR_LENGTH)) += @"露出軽減（小）　"
ENDIF

;支援回復効果アップ
CALL CLOTH_HOSEI(ARG,CFLAG:ARG:(ARG:1),"HEALUP")
IF RESULT > 0
	LOCALS = {RESULT}
	STRLENS LOCALS:1
	LOCALS:(1 + (RESULT > STR_LENGTH)) += @"支援時の回復効果増幅　"
ENDIF

PRINTFORML %LOCALS:1%
IF LOCALS:2 != ""
	PRINT 　　　　　
	PRINTFORML %LOCALS:2%
ENDIF
PRINT 【 補正 】
;油断度
LOCAL = FIGURE_SPLIT(EQUIP:ARG:ID,15) - FIGURE_SPLIT(EQUIP:ARG:ID,14)
SIF LOCAL > 0
	PRINTFORM 촉수の油断度+{LOCAL}％　
SIF LOCAL < 0
	PRINTFORM 촉수の油断度{LOCAL}％　

;挿入抵抗
LOCAL = FIGURE_SPLIT(EQUIP:ARG:ID,13) - FIGURE_SPLIT(EQUIP:ARG:ID,12)
IF LOCAL > 0
	PRINTFORM 挿入抵抗+{5*LOCAL}％　
ELSEIF LOCAL < 0
	PRINTFORM 挿入抵抗{5*LOCAL}％　
ENDIF
PRINTL 
PRINT 【耐久力】
CALL CLOTH_HOSEI(ARG,CFLAG:ARG:(ARG:1),"HP")
IF RESULT > 0
	PRINTFORM {RESULT}
ELSE
	PRINT ─
ENDIF
PRINTL 
DRAWLINE

TRYCALLFORM CLOTH_CUSTOMIZE_OPTION_{CFLAG:ARG:(ARG:1)},ARG
IF RESULT == 99
	CFLAG:ARG:1 = 0
	RETURN
ELSEIF RESULT == -1
	CLEARLINE LINECOUNT - LINE
	GOTO MASTER_LOOP
ENDIF

