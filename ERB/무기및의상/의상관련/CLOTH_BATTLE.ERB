;**********************************************************
;전투 중의 의상에 관한 처리

;----------------------------------------------------------
;의상 내구도 설정
@CLOTH_BATTLE_SETHP
#DIM KEEP_CFLAG,1

CALL CLOTH_HOSEI(TARGET,CFLAG:40,"HP")
TCVARn:20 = RESULT
TCVARn:21 = RESULT

KEEP_CFLAG=CFLAG:1
CFLAG:1 = 1
CALL CLOTH_HOSEI(TARGET,CFLAG:41,"HP")
IF RESULT!=-1
	CALL CLOTH_CUSTOMIZE_COMMONPARTS_CAL, RESULT, "HP"
ENDIF
TCVARn:22 = RESULT
TCVARn:23 = RESULT
CFLAG:1 = KEEP_CFLAG

CALL CLOTH_HOSEI(TARGET,CFLAG:42,"HP")

TCVARn:24 = RESULT
TCVARn:25 = RESULT


;----------------------------------------------------------
;의상 내구도 표시
@CLOTH_BATTLE_DISPHP
#DIM 최대문자수,1
최대문자수=0


LOCALS = ◆겉옷 없음
SIF COSTUME_NAME(TARGET) != ""
	LOCALS = ◆%COSTUME_NAME(TARGET)%

LOCALS:1 = ◆속옷 없음
IF CLOTH_NO_INNER && TCVARn:24 >= 0
	LOCALS:1 = ◇（속옷겸용）
ELSEIF CFLAG:TARGET:42!=0
	LOCALS:1 = ◆%INNER_NAME(TARGET)%
ENDIF

최대문자수=MAX(STRLENS(LOCALS:0),STRLENS(LOCALS:1))+2


PRINTL 

;●겉옷
IF TCVARn:(CFLAG:1==0 ? 20 # 22) < 0
	SIF TCVARn:41 && CFLAG:(CFLAG:1==0 ? 40 # 41) == 199
		SETCOLOR 255, 128, 192
	PRINTFORM %""+LOCALS+"",최대문자수,LEFT%
	BAR 0, 1, 5
	PRINTFORM （─） 
ELSEIF TCVARn:(CFLAG:1==0 ? 20 # 22) == 0
	SIF CFLAG:40 != 0
		SETCOLOR 255, 0, 0
	SIF CFLAG:40 == 0
		SETCOLOR 123, 123, 123
	PRINTFORM %""+LOCALS+"",최대문자수,LEFT%
	BAR 0, 1, 15
	PRINTFORM （없음）
ELSEIF TCVARn:(CFLAG:1==0 ? 21 # 23) > 0
	LOCAL:3 = 0
	IF CLOTH_OUTER_PER < CLOTH_OUTER_DEF
		LOCAL:0=255
		LOCAL:1=123
		LOCAL:2=0
		LOCAL:3=2
	ELSEIF CLOTH_OUTER_PER < CLOTH_OUTER_DEF + (100 - CLOTH_OUTER_DEF) / 2
		LOCAL:0=255
		LOCAL:1=255
		LOCAL:2=0
		LOCAL:3=1
	ENDIF
	SETCOLOR LOCAL:0,LOCAL:1,LOCAL:2
	SIF LOCAL:3 == 0
		RESETCOLOR
	PRINTFORM %""+LOCALS+"",최대문자수,LEFT%
	PRINTFORM %UNICODE(0x208D)%
	IF LOCAL:3 == 0
		LOCAL:0=40
		LOCAL:1=70
		LOCAL:2=210
	ENDIF
	CALLFORM COLOR_BAR(TCVARn:(CFLAG:1==0 ? 21 # 23), TCVARn:(CFLAG:1==0 ? 20 # 22), 15, LOCAL:0,LOCAL:1,LOCAL:2,-160,10,18,6,2,UNICODE(0x25AE),UNICODE(0x25AE))
	SETCOLOR LOCAL:0,LOCAL:1,LOCAL:2
	SIF LOCAL:3 == 0
		RESETCOLOR
	PRINTFORM %UNICODE(0x208E)%
	PRINTFORM （{TCVARn:(CFLAG:1==0 ? 21 # 23)}/{TCVARn:(CFLAG:1==0 ? 20 # 22)}）
	
ELSE
	SETCOLOR 255, 0, 0
	PRINTFORM %""+LOCALS+"",최대문자수,LEFT%
	PRINTFORM %UNICODE(0x208D)%
	CALLFORM COLOR_BAR(TCVARn:(CFLAG:1==0 ? 21 # 23), TCVARn:(CFLAG:1==0 ? 20 # 22), 15, 255,0,0,-160,10,18,6,2,UNICODE(0x25AE),UNICODE(0x25AE))
	SETCOLOR 255, 0, 0
	PRINTFORM %UNICODE(0x208E)%
	PRINTFORM （0/{TCVARn:(CFLAG:1==0 ? 20 # 22)}）
ENDIF

PRINTL
PRINT 　
CALL CLOTH_CUSTOMIZE_OPTION_DRAW(CFLAG:1==0 ? CFLAG:40 # CFLAG:41,TARGET)


RESETCOLOR
;PRINTL




;●속옷
IF TCVARn:24 < 0
	SIF CFLAG:42 == 400
		SETCOLOR 255, 128, 192
	PRINTFORM %""+LOCALS:1+"",최대문자수,LEFT%
	BAR 0, 1, 5
	PRINTFORM （─）
ELSEIF CLOTH_NO_INNER
	IF TCVARn:41 && CFLAG:(CFLAG:1==0 ? 40 # 41) == 199
		SETCOLOR 255, 128, 192
	ELSEIF TCVARn:(CFLAG:1==0 ? 20 # 22) >= 0
		IF TCVARn:(CFLAG:1==0 ? 21 # 23)==0
			SETCOLOR 255, 0, 0
		ELSEIF CLOTH_OUTER_PER < CLOTH_OUTER_DEF
			SETCOLOR 255, 123, 0
		ELSEIF CLOTH_OUTER_PER < CLOTH_OUTER_DEF + (100 - CLOTH_OUTER_DEF) / 2
			SETCOLOR 255, 255, 0
		ENDIF
	ENDIF
	PRINTFORM %LOCALS:1,최대문자수,LEFT%
	;BAR 0, 1, 5
	;PRINTFORM （─）
;평상시
ELSEIF TCVARn:24 == 0
	SIF CFLAG:42 != 0
		SETCOLOR 255, 0, 0
	SIF CFLAG:42 == 0
		SETCOLOR 123, 123, 123
	PRINTFORM %""+LOCALS:1+"",최대문자수,LEFT%
	BAR 0, 1, 15
	PRINTFORM （없음）
ELSEIF TCVARn:25 > 0
	LOCAL:3 = 0
	IF CLOTH_INNER_PER < CLOTH_INNER_DEF
		LOCAL:0=255
		LOCAL:1=123
		LOCAL:2=0
		LOCAL:3=2
	ELSEIF CLOTH_INNER_PER < CLOTH_INNER_DEF + (100 - CLOTH_INNER_DEF) / 2
		LOCAL:0=255
		LOCAL:1=255
		LOCAL:2=0
		LOCAL:3=1
	ENDIF
	SETCOLOR LOCAL:0,LOCAL:1,LOCAL:2
	SIF LOCAL:3 == 0
		RESETCOLOR
	PRINTFORM %""+LOCALS:1+"",최대문자수,LEFT%
	PRINTFORM %UNICODE(0x208D)%
	IF LOCAL:3 == 0
		LOCAL:0=40
		LOCAL:1=70
		LOCAL:2=210
	ENDIF
	CALLFORM COLOR_BAR(TCVARn:25, TCVARn:24, 15, LOCAL:0,LOCAL:1,LOCAL:2,-160,10,18,6,2,UNICODE(0x25AE),UNICODE(0x25AE))
	SETCOLOR LOCAL:0,LOCAL:1,LOCAL:2
	SIF LOCAL:3 == 0
		RESETCOLOR
	PRINTFORM %UNICODE(0x208E)%
	PRINTFORM （{TCVARn:25,3,RIGHT}/{TCVARn:24,3,RIGHT}）

ELSE
	SETCOLOR 255, 0, 0
	PRINTFORM %""+LOCALS:1+"",최대문자수,LEFT%
	PRINTFORM %UNICODE(0x208D)%
	CALLFORM COLOR_BAR(0, TCVARn:24, 15, 244,0,0,-160,10,18,6,2,UNICODE(0x25AE),UNICODE(0x25AE))
	SETCOLOR 255, 0, 0
	PRINTFORM %UNICODE(0x208E)%
	PRINTFORM （  0/{TCVARn:24,3,RIGHT}）

ENDIF

PRINTL
PRINT 　
CALL CLOTH_CUSTOMIZE_OPTION_DRAW(CFLAG:42,TARGET)


;----------------------------------------------------------
;의상에의 피해
@CLOTH_BATTLE_DAMAGE, ARG, ARG:1 = 0
LOCAL:0 = 0
LOCAL:1 = 0
LOCAL:2 = 50
LOCAL:3 = ARG

;페이탈리티 후에는 생략
SIF TFLAG:23==-1
	RETURN

;성기 가리개에 대한 피해는 매우 적어진다
IF CFLAG:42 == 398 && ARG > 0
	IF TCVARn:2 == 자세：Ｖ방어
		LOCAL:3 = MAX(LOCAL:3 / 6, 1)
	ELSE
		LOCAL:3 = MAX(LOCAL:3 / 3, 1)
	ENDIF
ENDIF
IF CFLAG:1 == 0
	CALL CLOTH_HOSEI(TARGET,CFLAG:TARGET:40,"DEF")
	;TRYCCALLFORM CLOTH_DEF_{CFLAG:40}
		LOCAL:2 = RESULT
	;CATCH
	;	LOCAL:2 = DEFAULT_OUTER_DEF
	;ENDCATCH

	IF TCVARn:20 > 0 || TCVARn:24 > 0
		IF TCVARn:21 > 0 || TCVARn:25 > 0
			IF TCVARn:21 == 0 || PERCENT_CAL_F(TCVARn:21,TCVARn:20) < LOCAL:2
				;속옷겸용 의상일 경우에는 속옷에 피해를 입히지 않는다
				CALL CLOTH_NO_INNER, TARGET
				IF TCVARn:25 > 0 && RESULT == 0
					SIF TCVARn:0 != 0 && ARG:1 == 0
						LOCAL:3 = LOCAL:3 / 3
					LOCAL:1 = PERCENT_CAL_F(TCVARn:25,TCVARn:24)
					TCVARn:25 = LIMIT(TCVARn:25 - LOCAL:3, 0, TCVARn:25)
					SIF ARG:1 == 0 && TCVARn:25 > 0
						ARG = ARG / 3
				ELSEIF ARG:1 == 0 && TCVARn:25 > 0
					ARG = ARG / 6
				ENDIF
			ENDIF
			LOCAL:0 = PERCENT_CAL_F(TCVARn:21,TCVARn:20)
			TCVARn:21 = LIMIT(TCVARn:21 - ARG, 0, TCVARn:21)
		ENDIF
	ENDIF
ELSE
	CALL CLOTH_HOSEI(TARGET,CFLAG:41,"DEF")
	;TRYCCALLFORM CLOTH_DEF_{CFLAG:41}
		LOCAL:2 = RESULT
	;CATCH
	;	LOCAL:2 = DEFAULT_OUTER_DEF
	;ENDCATCH
	IF TCVARn:22 > 0 || TCVARn:24 > 0
		IF TCVARn:23 > 0 || TCVARn:25 > 0
			IF TCVARn:23 == 0 || PERCENT_CAL_F(TCVARn:23,TCVARn:22) < LOCAL:2
				;속옷겸용 의상일 경우에는 속옷에 피해를 입히지 않는다
				CALL CLOTH_NO_INNER, TARGET
				IF TCVARn:25 > 0 && RESULT == 0
					SIF TCVARn:0 != 0 && ARG:1 == 0
						LOCAL:3 = LOCAL:3 / 3
					LOCAL:1 = PERCENT_CAL_F(TCVARn:25,TCVARn:24)
					TCVARn:25 = LIMIT(TCVARn:25 - LOCAL:3, 0, TCVARn:25)
					SIF ARG:1 == 0 && TCVARn:25 > 0
						ARG = ARG / 3
				ELSEIF ARG:1 == 0 && TCVARn:25 > 0
					ARG = ARG / 6
				ENDIF
			ENDIF
			LOCAL:0 = PERCENT_CAL_F(TCVARn:23,TCVARn:22)
			TCVARn:23 = LIMIT(TCVARn:23 - ARG, 0, TCVARn:23)
		ENDIF
	ENDIF
ENDIF

;내구력 관련 정보를 갱신
CALL REFRESH_CLOTH_DATA

;지문
IF CFLAG:1 == 0
	IF LOCAL:0 > 0 && TCVARn:21 <= 0 && TCVARn:20 > 0
		;지문: 겉옷이 찢어졌다
		CALL MESSAGE_BATTLE_CLOTH_OUTERBREAK
		;지문: 세뇌/흑화 캐릭터가 조작 캐릭터의 겉옷이 찢어진 것을 봤다
		SIF ENEMY_TYPE_CHECK_F("AKUOTI") == 1
			CALL MESSAGE_OTHER_BATTLE_CLOTH_OUTERBREAK
			
	ELSEIF LOCAL:0 >= CLOTH_OUTER_DEF && PERCENT_CAL_F(TCVARn:21,TCVARn:20) < CLOTH_OUTER_DEF && TCVARn:20 > 0
		;지문: 겉옷이 찢어지기 시작했다
		CALL MESSAGE_BATTLE_CLOTH_OUTERDAMAGE
		;지문: 세뇌/흑화 캐릭터가 조작 캐릭터의 겉옷이 찢어지기 시작한 것을 봤다
		SIF ENEMY_TYPE_CHECK_F("AKUOTI") == 1
			CALL MESSAGE_OTHER_BATTLE_CLOTH_OUTERDAMAGE
			
	ENDIF
ELSE
	IF LOCAL:0 > 0 && TCVARn:23 <= 0 && TCVARn:22 > 0
		;지문: 겉옷이 찢어졌다
		CALL MESSAGE_BATTLE_CLOTH_OUTERBREAK
		;지문: 세뇌/흑화 캐릭터가 조작 캐릭터의 겉옷이 찢어진 것을 봤다
		SIF ENEMY_TYPE_CHECK_F("AKUOTI") == 1
			CALL MESSAGE_OTHER_BATTLE_CLOTH_OUTERBREAK
			
	ELSEIF LOCAL:0 >= CLOTH_OUTER_DEF && PERCENT_CAL_F(TCVARn:23,TCVARn:22) < CLOTH_OUTER_DEF && TCVARn:22 > 0
		;지문: 겉옷이 찢어지기 시작했다
		CALL MESSAGE_BATTLE_CLOTH_OUTERDAMAGE
		;지문: 세뇌/흑화 캐릭터가 조작 캐릭터의 겉옷이 찢어지기 시작한 것을 봤다
		SIF ENEMY_TYPE_CHECK_F("AKUOTI") == 1
			CALL MESSAGE_OTHER_BATTLE_CLOTH_OUTERDAMAGE

	ENDIF
ENDIF

IF LOCAL:1 && TCVARn:25 <= 0 && TCVARn:24 > 0
	;지문: 속옷이 찢어졌다
	CALL MESSAGE_BATTLE_CLOTH_INNERBREAK
	;지문: 세뇌/흑화 캐릭터가 조작 캐릭터의 속옷이 찢어진 것을 봤다
	SIF ENEMY_TYPE_CHECK_F("AKUOTI") == 1
		CALL MESSAGE_OTHER_BATTLE_CLOTH_INNERBREAK
		
ELSEIF LOCAL:1 >= CLOTH_INNER_DEF && PERCENT_CAL_F(TCVARn:25,TCVARn:24) < CLOTH_INNER_DEF && TCVARn:24 > 0
	;지문: 속옷이 찢어지기 시작했다
	CALL MESSAGE_BATTLE_CLOTH_INNERDAMAGE
	;지문: 세뇌/흑화 캐릭터가 조작 캐릭터의 속옷이 찢어지기 시작한 것을 봤다
	SIF ENEMY_TYPE_CHECK_F("AKUOTI") == 1
		CALL MESSAGE_OTHER_BATTLE_CLOTH_INNERDAMAGE
		
ENDIF




;----------------------------------------------------------
;의상에 따른 보정
@CLOTH_BATTLE_HOSEI, ARGS, ARG = -999
#DIM KEEP_TARGET
KEEP_TARGET = TARGET
SIF ARG != -999
	TARGET = ARG
LOCAL = 100
IF ARGS == "CRITICAL" || ARGS == "ANTIBUP" || ARGS == "ANTICUP" || ARGS == "HEALUP" || ARGS == "EXBOOST" || ARGS == "AIRPLUS" || ARGS == "HIT" || ARGS == "AVOID"
	LOCAL = 0
ENDIF
;미변신
IF CFLAG:1 == 0
	IF FLAG:700 && (TCVARn:21 == 0 || PERCENT_CAL_F(TCVARn:21,TCVARn:20) < 1) && KEEP_TARGET == TARGET
		;완전히 파괴되면 보정 없음
	ELSE
		CALL CLOTH_HOSEI(TARGET,CFLAG:TARGET:40,ARGS)
			IF ARGS == "CRITICAL" || ARGS == "ANTIBUP" || ARGS == "ANTICUP" || ARGS == "HEALUP" || ARGS == "EXBOOST" || ARGS == "AIRPLUS" || ARGS == "HIT" || ARGS == "AVOID"
				LOCAL += RESULT
			ELSE
				LOCAL = LOCAL * RESULT / 100
			ENDIF
	ENDIF
;변신 중
ELSE
	IF FLAG:700 && (TCVARn:23 == 0 || PERCENT_CAL_F(TCVARn:23,TCVARn:22) < 1) && KEEP_TARGET == TARGET
		;완전히 파괴되면 보정 없음
	ELSE
		CALL CLOTH_HOSEI(TARGET,CFLAG:TARGET:41,ARGS)
			IF ARGS == "CRITICAL" || ARGS == "ANTIBUP" || ARGS == "ANTICUP" || ARGS == "HEALUP" || ARGS == "EXBOOST" || ARGS == "AIRPLUS" || ARGS == "HIT" || ARGS == "AVOID"
				LOCAL += RESULT
			ELSE
				LOCAL = LOCAL * RESULT / 100
			ENDIF
	ENDIF
ENDIF
;속옷
IF FLAG:700 && (TCVARn:25 == 0 || PERCENT_CAL_F(TCVARn:25,TCVARn:24) < 1) || CLOTH_NO_INNER > 0 && KEEP_TARGET == TARGET
		;완전히 파괴되면 보정 없음
ELSE
		CALL CLOTH_HOSEI(TARGET,CFLAG:TARGET:42,ARGS)
		IF ARGS == "CRITICAL" || ARGS == "ANTIBUP" || ARGS == "ANTICUP" || ARGS == "HEALUP" || ARGS == "EXBOOST" || ARGS == "AIRPLUS" || ARGS == "HIT" || ARGS == "AVOID"
			LOCAL += RESULT
		ELSE
			LOCAL = LOCAL * RESULT / 100
		ENDIF
ENDIF
;변신 중이라면 커스터마이즈 파츠에 대해서도 체크한다
;단 내구가 없는 의상일 경우 노터치
IF CFLAG:1 > 0 && (ARGS!="HP" || LOCAL!=-1)
	CALL CLOTH_CUSTOMIZE_COMMONPARTS_CAL, LOCAL, ARGS
	LOCAL = RESULT
ENDIF
TARGET = KEEP_TARGET
RETURN LOCAL



;----------------------------------------------------------
;의상 상태 판정
;착의가 파괴되지 않은 상태라면 비트를 세운다
@CLOTH_CHECK(ARG)
#FUNCTION
LOCAL = 0
IF CFLAG:ARG:1 == 0 && TCVARn:ARG:21 > 0
	LOCAL |= 2
ELSEIF CFLAG:ARG:1 == 1 && TCVARn:ARG:23 > 0
	LOCAL |= 4
ENDIF
SIF TCVARn:ARG:25 > 0 || (CLOTH_NO_INNER > 0 && LOCAL > 0)
	LOCAL |= 1

RETURNF LOCAL




;--------------------------------------------------
;ARG가 현재 입고 있는 겉옷의 명칭을 반환하는 식중함수
;현재 상태와 무관하게 취득한다면 trans로 지정 가능
@COSTUME_NAME(ARG,trans=-1)
#FUNCTIONS
#dim trans

IF trans==0 || (trans==-1 && CFLAG:ARG:1 == 0)
	IF CFLAG:ARG:40 == 0
		LOCALS = 
	ELSEIF CFLAG:ARG:40 == 990
		LOCALS = %CSTR:ARG:80%
	ELSEIF CSTR:ARG:8 != ""
		LOCALS = %CSTR:ARG:8%
	ELSE
		LOCALS = %ITEMNAME:(CFLAG:ARG:40)%
	ENDIF
ELSE
	IF CFLAG:ARG:41 == 0
		LOCALS = 
	ELSEIF CFLAG:ARG:41 == 991
		LOCALS = %CSTR:ARG:81%
	ELSEIF CSTR:ARG:9 != ""
		LOCALS = %CSTR:ARG:9%
	ELSE
		LOCALS = %ITEMNAME:(CFLAG:ARG:41)%
	ENDIF
ENDIF
RETURNF LOCALS
;--------------------------------------------------
;속옷의 명칭을 반환하는 식중함수
@INNER_NAME(ARG)
#FUNCTIONS
IF CFLAG:ARG:42 == 0
	LOCALS = 
ELSEIF CFLAG:ARG:42 == 992
	LOCALS = %CSTR:ARG:82%
ELSE
	LOCALS = %ITEMNAME:(CFLAG:ARG:42)%
ENDIF
RETURNF LOCALS



;--------------------------------------------------
;속옷겸용 판정
@CLOTH_NO_INNER, ARG
RESULT = 0
CALL CLOTH_HOSEI(TARGET,CFLAG:(CFLAG:ARG:1 > 0 ? 41 # 40),"NOINNER")
RETURN RESULT

;--------------------------------------------------
;의상 내구력 참조에 관한 칸수(間数 함수 칸수 라임 지렸다)
@REFRESH_CLOTH_DATA
;의상 상태를 본다
IF CFLAG:1 == 0
	CALL PERCENT_CAL, TCVARn:21, TCVARn:20
	CLOTH_OUTER_PER = RESULT
	CALL CLOTH_HOSEI(TARGET,CFLAG:40,"DEF")
	CLOTH_OUTER_DEF = RESULT
	;변신 후의 겉옷 내구력을 동기화
	SIF TCVARn:20 > 0 && TCVARn:22 > 0
		TCVARn:23 = TCVARn:22 * CLOTH_OUTER_PER / 100
ELSE
	CALL PERCENT_CAL, TCVARn:23, TCVARn:22
	CLOTH_OUTER_PER = RESULT
	CALL CLOTH_HOSEI(TARGET,CFLAG:41,"DEF")
	CLOTH_OUTER_DEF = RESULT
	;변신 전의 겉옷 내구력을 동기화
	SIF TCVARn:20 > 0 && TCVARn:22 > 0
		TCVARn:21 = TCVARn:20 * CLOTH_OUTER_PER / 100
ENDIF
CALL PERCENT_CAL, TCVARn:25, TCVARn:24
CLOTH_INNER_PER = RESULT

SIF CFLAG:1 == 0 && TCVARn:20 < 0
	CLOTH_OUTER_PER = 0
SIF CFLAG:1 > 0 && TCVARn:22 < 0
	CLOTH_OUTER_PER = 0
SIF TCVARn:24 < 0
	CLOTH_INNER_PER = 0

CALL CLOTH_NO_INNER, TARGET
;속옷겸용 의상 처리
IF RESULT > 0
	CLOTH_INNER_PER = CLOTH_OUTER_PER
	CLOTH_NO_INNER = 1
	;삽입 저항력 설정
	CALL CLOTH_HOSEI(TARGET,CFLAG:(CFLAG:1==0 ? 40 # 41),"DEF")
	CLOTH_INNER_DEF = RESULT
	;속옷의 내구력을 겉옷에 동기화
	SIF TCVARn:24 > 0 && TCVARn:(CFLAG:1==0 ? 20 # 22) > 0
		TCVARn:25 = TCVARn:24 * CLOTH_OUTER_PER / 100
;보통은 속옷에 대해 처리
ELSE
	CLOTH_NO_INNER = 0
	;삽입 저항력 설정
	CALL CLOTH_HOSEI(TARGET,CFLAG:42,"DEF")
	CLOTH_INNER_DEF = RESULT

	;변신 상태의 반대쪽(逆側) 의상이 속옷겸용이라면 (겉옷+속옷)/2의 내구력을 반대쪽 의상에 동기화
	CALL CLOTH_HOSEI(TARGET,CFLAG:(CFLAG:1==0 ? 41 # 40),"NOINNER")
	IF RESULT > 0
		IF TCVARn:(CFLAG:1==0 ? 20 # 22) > 0 && TCVARn:24 > 0
			TCVARn:(CFLAG:1==0 ? 23 # 21) = TCVARn:(CFLAG:1==0 ? 22 # 20) * (CLOTH_OUTER_PER + CLOTH_INNER_PER) / 200
		ELSEIF TCVARn:(CFLAG:1==0 ? 20 # 22) > 0
			TCVARn:(CFLAG:1==0 ? 23 # 21) = TCVARn:(CFLAG:1==0 ? 22 # 20) * CLOTH_OUTER_PER / 100
		ELSEIF TCVARn:24 > 0
			TCVARn:(CFLAG:1==0 ? 23 # 21) = TCVARn:(CFLAG:1==0 ? 22 # 20) * CLOTH_INNER_PER / 100
		ENDIF
	ENDIF
ENDIF


