;----------------------------------------------------------
;
@FIRSTSETTING_RANDOMNAMING_ALL
#DIM LCOUNT,2
#DIM LINE
#DIM 고정플래그,20
#DIM 윗구장르,1
#DIM 아랫구장르,1
#DIM 윗구고정번호,1
#DIM 아랫구고정번호,1

CALL LB
LINE = LINECOUNT
윗구장르 = 8
아랫구장르 = 8

GOTO INPUT_REGENERATE

$INPUT_RESELECT
LOCAL:5 = 0
LOCAL:6 = 윗구장르
DO
	SIF LOCAL:5 == 0
		FONTBOLD
	PRINT 　　윗구：
	IF 윗구장르 == 0
		PRINTL 매지컬적인 단어
	ELSEIF 윗구장르 == 1
		PRINTL 천체의 이름
	ELSEIF 윗구장르 == 2
		PRINTL 색깔 이름
	ELSEIF 윗구장르 == 3
		PRINTL 과일, 채소 등 식물의 이름
	ELSEIF 윗구장르 == 4
		PRINTL 잡다한 영어 단어
	ELSEIF 윗구장르 == 5
		PRINTL 보석의 이름
	ELSEIF 윗구장르 == 6
		PRINTL 사람을 나타내는 단어
	ELSEIF 윗구장르 == 7
		PRINTL 무기의 이름
	ELSEIF 윗구장르 == 8
		PRINTL 랜덤
	ENDIF
	FONTREGULAR
	SIF LOCAL:5 != 0
		FONTBOLD
	PRINT 　아랫구：
	IF 아랫구장르 == 0
		PRINTL 매지컬적인 단어
	ELSEIF 아랫구장르 == 1
		PRINTL 천체의 이름
	ELSEIF 아랫구장르 == 2
		PRINTL 색깔 이름
	ELSEIF 아랫구장르 == 3
		PRINTL 과일, 채소 등 식물의 이름
	ELSEIF 아랫구장르 == 4
		PRINTL 잡다한 영어 단어
	ELSEIF 아랫구장르 == 5
		PRINTL 보석의 이름
	ELSEIF 아랫구장르 == 6
		PRINTL 사람을 나타내는 단어
	ELSEIF 아랫구장르 == 7
		PRINTL 무기의 이름
	ELSEIF 아랫구장르 == 8
		PRINTL 랜덤
	ENDIF
	FONTREGULAR


	IF LOCAL:5 == 0
		PRINT 윗
	ELSE
		PRINT 아랫
	ENDIF
	PRINTL 구의 장르를 선택해 주십시오.
	PRINTL [ 0] 매지컬적인 단어
	PRINTL [ 1] 천체의 이름
	PRINTL [ 2] 색깔 이름
	PRINTL [ 3] 과일, 채소 등 식물의 이름
	PRINTL [ 4] 잡다한 영어 단어
	PRINTL [ 5] 보석의 이름
	PRINTL [ 6] 사람을 나타내는 단어
	PRINTL [ 7] 무기의 이름
	PRINTL [ 8] 랜덤
	PRINTL [99] 돌아간다
	PRINTL 
	PRINT [100] 
	IF LOCAL:5 == 0
		PRINT 아랫
	ELSE
		PRINT 윗
	ENDIF
	PRINTL 구 변경
	PRINTL [200] 생성

	$INPUT_LOOP1
	INPUT
	IF RESULT >= 0 && RESULT <= 8
		IF LOCAL:5==0
			윗구장르=RESULT
		ELSE
			아랫구장르=RESULT
		ENDIF
		CLEARLINE LINECOUNT - LINE
	ELSEIF RESULT == 99
		RETURN 99
	ELSEIF RESULT == 100
		IF LOCAL:5 == 0
			LOCAL:5 = 1
		ELSE
			LOCAL:5 = 0
		ENDIF
		CLEARLINE LINECOUNT - LINE
	ELSEIF RESULT == 200
		BREAK
	ELSE
		GOTO INPUT_LOOP1
	ENDIF
LOOP 1
CLEARLINE LINECOUNT - LINE

;※「DA:(윗구 0/아랫구 1):선택 번호」가 되도록 랜덤 후보 번호를 넣어두고, 결과 측에서 복원하고 있다
$INPUT_REGENERATE
FOR LCOUNT, 0, 20, 1

	IF 고정플래그:LCOUNT==1
		CONTINUE
	ENDIF
	FOR LCOUNT:1, 0, 2, 1

		IF (LCOUNT:1==0 && 윗구고정번호>0)
			DA:(LCOUNT:1):LCOUNT=윗구고정번호
			CONTINUE
		ELSEIF (LCOUNT:1==1 && 아랫구고정번호>0)
			DA:(LCOUNT:1):LCOUNT=아랫구고정번호
			CONTINUE
		ENDIF

		LCOUNT:1 = LCOUNT:1

		IF LCOUNT:1==0
			LOCAL=윗구장르
		ELSE
			LOCAL=아랫구장르
		ENDIF


		SIF LOCAL == 8
			LOCAL = RAND:8
		IF LOCAL == 0
			;매지컬적인 단어
			LOCAL:5 = RAND:50 + 500
			WHILE STR:(LOCAL:5) == ""
				LOCAL:5 = RAND:50 + 500
			WEND
			DA:(LCOUNT:1):(LCOUNT) = LOCAL:5
		ELSEIF LOCAL == 1
			;천체의 이름
			LOCAL:5 = RAND:50 + 600
			WHILE STR:(LOCAL:5) == ""
				LOCAL:5 = RAND:50 + 600
			WEND
			DA:(LCOUNT:1):(LCOUNT) = LOCAL:5
		ELSEIF LOCAL == 2
			;색깔 이름
			LOCAL:5 = RAND:50 + 700
			WHILE STR:(LOCAL:5) == ""
				LOCAL:5 = RAND:50 + 700
			WEND
			DA:(LCOUNT:1):(LCOUNT) = LOCAL:5
		ELSEIF LOCAL == 3
			;과일, 채소 등 식물의 이름
			LOCAL:5 = RAND:50 + 800
			WHILE STR:(LOCAL:5) == ""
				LOCAL:5 = RAND:50 + 800
			WEND
			DA:(LCOUNT:1):(LCOUNT) = LOCAL:5
		ELSEIF LOCAL == 4
			;잡다한 영어 단어
			LOCAL:5 = RAND:50 + 900
			WHILE STR:(LOCAL:5) == ""
				LOCAL:5 = RAND:50 + 900
			WEND
			DA:(LCOUNT:1):(LCOUNT) = LOCAL:5
		ELSEIF LOCAL == 5
			;보석의 이름
			LOCAL:5 = RAND:50 + 1000
			WHILE STR:(LOCAL:5) == ""
				LOCAL:5 = RAND:50 + 1000
			WEND
			DA:(LCOUNT:1):(LCOUNT) = LOCAL:5
		ELSEIF LOCAL == 6
			;사람을 나타내는 단어
			LOCAL:5 = RAND:50 + 1100
			WHILE STR:(LOCAL:5) == ""
				LOCAL:5 = RAND:50 + 1100
			WEND
			DA:(LCOUNT:1):(LCOUNT) = LOCAL:5
		ELSEIF LOCAL == 7
			;무기의 이름
			LOCAL:5 = RAND:50 + 1200
			WHILE STR:(LOCAL:5) == ""
				LOCAL:5 = RAND:50 + 1200
			WEND
			DA:(LCOUNT:1):(LCOUNT) = LOCAL:5
		ENDIF
	NEXT
NEXT

$INPUT_PRINT
FOR LCOUNT,0,20
	PRINTFORM [{(LCOUNT), 2}] 
	PRINTFORM %STR:(DA:0:LCOUNT)%%STR:(DA:1:LCOUNT),26-STRLENS(STR:(DA:0:LCOUNT)),LEFT%
	PRINTPLAIN 　
	IF 고정플래그:LCOUNT==1
		CALL SETCOLOR_BY_STR, "금색"
		PRINTFORM [{(LCOUNT)+1000, 4}] ★고정 
		RESETCOLOR
	ELSE
		PRINTFORM [{(LCOUNT)+1000, 4}] ☆고정 
	ENDIF
	PRINTPLAIN 　
	PRINTFORM [{(LCOUNT)+2000, 4}] 윗구 통일 
	PRINTPLAIN 　
	PRINTFORM [{(LCOUNT)+3000, 4}] 아랫구 통일 
	PRINTL 
NEXT
PRINTL 
PRINT [100] 장르를 좁힌다
PRINTL 　　　　　[300] 윗구・아랫구 반전
PRINTL [200] 재생성


$INPUT_LOOP2
INPUT
IF RESULT >= 0 && RESULT < 20
	RETURN RESULT
ELSEIF RESULT == 100
	CLEARLINE LINECOUNT - LINE
	윗구고정번호=0
	아랫구고정번호=0
	GOTO INPUT_RESELECT
ELSEIF RESULT == 200
	CLEARLINE LINECOUNT - LINE
	윗구고정번호=0
	아랫구고정번호=0
	GOTO INPUT_REGENERATE
ELSEIF RESULT == 300
	CLEARLINE LINECOUNT - LINE
	FOR LCOUNT,0,20
		IF !고정플래그:(LCOUNT)
			SWAP DA:0:LCOUNT,DA:1:LCOUNT
		ENDIF
	NEXT
	GOTO INPUT_PRINT

ELSEIF RESULT >=1000 && RESULT <=1019
	CLEARLINE LINECOUNT - LINE
	고정플래그:(RESULT-1000)=1-고정플래그:(RESULT-1000)
	GOTO INPUT_PRINT
ELSEIF RESULT >=2000 && RESULT <=2019
	CLEARLINE LINECOUNT - LINE
	윗구고정번호=DA:0:(RESULT-2000)
	아랫구고정번호=0
	GOTO INPUT_REGENERATE
ELSEIF RESULT >=3000 && RESULT <=3019
	CLEARLINE LINECOUNT - LINE
	윗구고정번호=0
	아랫구고정번호=DA:1:(RESULT-3000)
	GOTO INPUT_REGENERATE
ELSE
	GOTO INPUT_LOOP2
ENDIF

;----------------------------------------------------------
;관명과 변신 후 이름 랜덤 설정
@FIRSTSETTING_RANDOMNAMING, ARG:0, ARG:1, ARGS
PRINTL 장르를 선택해 주십시오.
PRINTL [ 0] 매지컬적인 단어
PRINTL [ 1] 천체의 이름
PRINTL [ 2] 색깔 이름
PRINTL [ 3] 과일, 채소 등 식물의 이름
PRINTL [ 4] 잡다한 영어 단어
PRINTL [ 5] 보석의 이름
PRINTL [ 6] 사람을 나타내는 단어
PRINTL [ 7] 무기의 이름
PRINTL [ 8] 랜덤
PRINTL [99] 돌아간다

$INPUT_LOOP
INPUT
LOCAL = RESULT
IF RESULT >= 0 && RESULT <= 8
	;난수를 인수로 하고 있기 때문에, 장르를 늘렸을 경우에는 RAND를 늘리는 것을 잊지 말 것
	CALL FIRSTSETTING_RANDOMNAMING_SELECT, ARG:0, RESULT, ARG:1, ARGS
ELSEIF RESULT == 99
	RETURN 99,0
ELSE
	GOTO INPUT_LOOP
ENDIF
RESULTS = %RESULTS%
RETURN LOCAL, RESULT

;----------------------------------------------------------
;명칭 결정
;관명(ARG:0 = 0)과 변신 후 이름(ARG:0 = 1) 공통의 테이블
;ARG:1은 장르, ARG:2는 캐릭터 번호(변신 후 이름일 경우에만)
;ARGS는 캐릭터의 이름(캐릭터명＋〇〇　〇〇＋캐릭터명　일 경우)
@FIRSTSETTING_RANDOMNAMING_SELECT, ARG:0, ARG:1, ARG:2, ARGS
PRINTL 

WHILE 1
	REPEAT 20
		IF ARG:1 == 8
			LOCAL:20 = RAND:8
		ELSE
			LOCAL:20 = ARG:1
		ENDIF

		IF LOCAL:20 == 0
			;매지컬적인 단어
			LOCAL:COUNT = RAND:50 + 500
			WHILE STR:(LOCAL:COUNT) == ""
				LOCAL:COUNT = RAND:50 + 500
			WEND
			LOCALS = %STR:(LOCAL:COUNT)%
		ELSEIF LOCAL:20 == 1
			;천체의 이름
			LOCAL:COUNT = RAND:50 + 600
			WHILE STR:(LOCAL:COUNT) == ""
				LOCAL:COUNT = RAND:50 + 600
			WEND
			LOCALS = %STR:(LOCAL:COUNT)%
		ELSEIF LOCAL:20 == 2
			;색깔 이름
			LOCAL:COUNT = RAND:50 + 700
			WHILE STR:(LOCAL:COUNT) == ""
				LOCAL:COUNT = RAND:50 + 700
			WEND
			LOCALS = %STR:(LOCAL:COUNT)%
		ELSEIF LOCAL:20 == 3
			;과일, 채소 등 식물의 이름
			LOCAL:COUNT = RAND:50 + 800
			WHILE STR:(LOCAL:COUNT) == ""
				LOCAL:COUNT = RAND:50 + 800
			WEND
			LOCALS = %STR:(LOCAL:COUNT)%
		ELSEIF LOCAL:20 == 4
			;잡다한 영어 단어
			LOCAL:COUNT = RAND:50 + 900
			WHILE STR:(LOCAL:COUNT) == ""
				LOCAL:COUNT = RAND:50 + 900
			WEND
			LOCALS = %STR:(LOCAL:COUNT)%
		ELSEIF LOCAL:20 == 5
			;보석의 이름
			LOCAL:COUNT = RAND:50 + 1000
			WHILE STR:(LOCAL:COUNT) == ""
				LOCAL:COUNT = RAND:50 + 1000
			WEND
			LOCALS = %STR:(LOCAL:COUNT)%
		ELSEIF LOCAL:20 == 6
			;사람을 나타내는 단어
			LOCAL:COUNT = RAND:50 + 1100
			WHILE STR:(LOCAL:COUNT) == ""
				LOCAL:COUNT = RAND:50 + 1100
			WEND
			LOCALS = %STR:(LOCAL:COUNT)%
		ELSEIF LOCAL:20 == 7
			;무기의 이름
			LOCAL:COUNT = RAND:50 + 1200
			WHILE STR:(LOCAL:COUNT) == ""
				LOCAL:COUNT = RAND:50 + 1200
			WEND
			LOCALS = %STR:(LOCAL:COUNT)%
		ENDIF
	REND

	$RE_OUTPUT

	LOCALS:2 = 
	LOCALS:3 = 
	IF LOCAL:21 == 0
		LOCALS:2 = %ARGS%
	ELSE
		LOCALS:3 = %ARGS%
	ENDIF

	REPEAT 20
		PRINTFORML [{COUNT, 2}] %LOCALS:2% %STR:(LOCAL:COUNT)% %LOCALS:3%

	REND

	PRINTL 
	PRINT [100] 장르에서 다시 고른다
	IF ARGS != ""
		PRINT 　　　　　[800] 
		SIF LOCAL:21 == 0
			FONTBOLD
		PRINTFORM  (%ARGS% ＋ 단어) 순서
		SIF LOCAL:21 == 0
			FONTREGULAR
	ENDIF
	PRINTL 

	PRINT [200] 재생성
	IF ARGS != ""
		PRINT 　　　　　　　　　　　　　[801] 
		SIF LOCAL:21 == 1
			FONTBOLD
		PRINTFORM  (단어 ＋ %ARGS%) 순서
		SIF LOCAL:21 == 1
			FONTREGULAR
	ENDIF
	PRINTL 

	$INPUT_LOOP3
	INPUT

	IF RESULT >= 0 && RESULT < 20
		RESULTS = %LOCALS:2% %STR:(LOCAL:RESULT)% %LOCALS:3%
		CSTR:(ARG:2):202 = %STR:(LOCAL:RESULT)%
		RETURN 0
	ELSEIF RESULT == 100
		RETURN 1
	ELSEIF RESULT == 200
		CLEARLINE 24
	ELSEIF RESULT == 800
		CLEARLINE 24
		LOCAL:21 = 0
		GOTO RE_OUTPUT
	ELSEIF RESULT == 801
		CLEARLINE 24
		LOCAL:21 = 1
		GOTO RE_OUTPUT
	ELSE
		GOTO INPUT_LOOP3
	ENDIF
WEND

;ARG:0 == 0이라면 관명, ARG:0 == 1이라면 변신 후 이름
IF ARG:0 == 0
	SAVESTR:11 = %LOCALS%
ELSEIF ARG:0 == 1
	CSTR:(ARG:2):203 = %LOCALS%
ENDIF


@RANDOMNAMING_FROMGENRE(ARG)
;1="매지컬적인 단어",2="천체의 이름","색깔 이름","과일, 채소 등 식물의 이름","잡다한 영어 단어","보석의 이름","사람을 나타내는 단어","무기의 이름",9="랜덤"
		;random
		SIF ARG==9
			ARG=1+RAND:8

		IF ARG == 1
			LOCAL = RAND:50 + 500
			WHILE STR:(LOCAL) == ""
				LOCAL = RAND:50 + 500
			WEND
			LOCALS = %STR:(LOCAL)%
		ELSEIF ARG == 2
			LOCAL = RAND:50 + 600
			WHILE STR:(LOCAL) == ""
				LOCAL = RAND:50 + 600
			WEND
			LOCALS = %STR:(LOCAL)%
		ELSEIF ARG == 3
			LOCAL = RAND:50 + 700
			WHILE STR:(LOCAL) == ""
				LOCAL = RAND:50 + 700
			WEND
			LOCALS = %STR:(LOCAL)%
		ELSEIF ARG == 4
			LOCAL = RAND:50 + 800
			WHILE STR:(LOCAL) == ""
				LOCAL = RAND:50 + 800
			WEND
			LOCALS = %STR:(LOCAL)%
		ELSEIF ARG == 5
			LOCAL = RAND:50 + 900
			WHILE STR:(LOCAL) == ""
				LOCAL = RAND:50 + 900
			WEND
			LOCALS = %STR:(LOCAL)%
		ELSEIF ARG == 6
			LOCAL = RAND:50 + 1000
			WHILE STR:(LOCAL) == ""
				LOCAL = RAND:50 + 1000
			WEND
			LOCALS = %STR:(LOCAL)%
		ELSEIF ARG == 7
			LOCAL = RAND:50 + 1100
			WHILE STR:(LOCAL) == ""
				LOCAL = RAND:50 + 1100
			WEND
			LOCALS = %STR:(LOCAL)%
		ELSEIF ARG == 8
			LOCAL = RAND:50 + 1200
			WHILE STR:(LOCAL) == ""
				LOCAL = RAND:50 + 1200
			WEND
			LOCALS = %STR:(LOCAL)%
		ENDIF
		RESULTS=%LOCALS%
		REPLACE RESULTS,"・$",""
		RETURN