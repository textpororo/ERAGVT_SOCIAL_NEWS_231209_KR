;--------------------------------------------------
;キャラの相関関係に関する処理
;--------------------------------------------------
;固有番号ARGのキャラがARG:1のキャラをどう思っているか返す
@GET_RELATION, ARG:0, ARG:1
LOCALS = 

;印象系---------------------------------

IF RELATION:(ARG:0):(ARG:1) < POWER(2, 20)
	IF GETBIT(RELATION:(ARG:0):(ARG:1),소원한) && GETBIT(RELATION:(ARG:0):(ARG:1),친한)
		LOCALS += "微妙な距離感の知人"
	ELSEIF GETBIT(RELATION:(ARG:0):(ARG:1),친한)
		LOCALS += "친한間柄"
	ELSEIF GETBIT(RELATION:(ARG:0):(ARG:1),소원한)
		LOCALS += "顔見知り"
	ELSEIF GETBIT(RELATION:(ARG:0):(ARG:1),사랑하는) && GETBIT(RELATION:(ARG:0):(ARG:1),증오하는)
		LOCALS += "複雑な関係"
	ELSEIF GETBIT(RELATION:(ARG:0):(ARG:1),사랑하는)
		LOCALS += "大事な人"
	ELSEIF GETBIT(RELATION:(ARG:0):(ARG:1),증오하는)
		LOCALS += "仇敵"
	ENDIF
ELSE
	SIF GETBIT(RELATION:(ARG:0):(ARG:1),생이별한)
		LOCALS += "生き別れの"
	IF GETBIT(RELATION:(ARG:0):(ARG:1),소원한) && GETBIT(RELATION:(ARG:0):(ARG:1),친한)
		LOCALS += "微妙な距離感の"
	ELSEIF GETBIT(RELATION:(ARG:0):(ARG:1),친한) && GETBIT(RELATION:(ARG:0):(ARG:1),친구) == 0
		LOCALS += "친한"
	ELSEIF GETBIT(RELATION:(ARG:0):(ARG:1),소원한)
		LOCALS += "소원한"
	ENDIF
	IF GETBIT(RELATION:(ARG:0):(ARG:1),사랑하는) && GETBIT(RELATION:(ARG:0):(ARG:1),증오하는)
		LOCALS += "愛憎渦巻く"
	ELSEIF GETBIT(RELATION:(ARG:0):(ARG:1),사랑하는)
		LOCALS += "사랑하는"
	ELSEIF GETBIT(RELATION:(ARG:0):(ARG:1),증오하는)
		LOCALS += "증오하는"
	ENDIF
	SIF GETBIT(RELATION:(ARG:0):(ARG:1),의리의)
		LOCALS += "의리의"
ENDIF

;関係---------------------------------

LOCAL = 0
IF GETBIT(RELATION:(ARG:0):(ARG:1),부모자식)
	IF TOSHIUE_F(ARG:0, ARG:1) > 0
		IF ISMALE(ARG:1)
			LOCALS += "息子"
			LOCAL ++
		ELSE
			LOCALS += "娘"
			LOCAL ++
		ENDIF
	ELSE
		IF ISMALE(ARG:1)
			LOCALS += "父親"
			LOCAL ++
		ELSE
			LOCALS += "母親"
			LOCAL ++
		ENDIF
	ENDIF
	SIF GETBIT(RELATION:(ARG:0):(ARG:1),형제자매) || GETBIT(RELATION:(ARG:0):(ARG:1),조부모손주) || GETBIT(RELATION:(ARG:0):(ARG:1),아저씨아줌마) || GETBIT(RELATION:(ARG:0):(ARG:1),조카조카딸) || GETBIT(RELATION:(ARG:0):(ARG:1),사촌)
		LOCALS += "/"
ENDIF
IF GETBIT(RELATION:(ARG:0):(ARG:1),형제자매)
	IF TOSHIUE_F(ARG:0, ARG:1)
		IF ISMALE(ARG:1)
			LOCALS += "弟"
			LOCAL ++
		ELSE
			LOCALS += "妹"
			LOCAL ++
		ENDIF
	ELSE
		IF ISMALE(ARG:1)
			LOCALS += "兄"
			LOCAL ++
		ELSE
			LOCALS += "姉"
			LOCAL ++
		ENDIF
	ENDIF
	SIF GETBIT(RELATION:(ARG:0):(ARG:1),조부모손주) || GETBIT(RELATION:(ARG:0):(ARG:1),아저씨아줌마) || GETBIT(RELATION:(ARG:0):(ARG:1),조카조카딸) || GETBIT(RELATION:(ARG:0):(ARG:1),사촌)
		LOCALS += "/"
ENDIF
IF GETBIT(RELATION:(ARG:0):(ARG:1),조부모손주)
	IF TOSHIUE_F(ARG:0, ARG:1)
		LOCALS += "孫"
		LOCAL ++
	ELSE
		IF ISMALE(ARG:1)
			LOCALS += "祖父"
			LOCAL ++
		ELSE
			LOCALS += "祖母"
			LOCAL ++
		ENDIF
	ENDIF
	SIF GETBIT(RELATION:(ARG:0):(ARG:1),아저씨아줌마) || GETBIT(RELATION:(ARG:0):(ARG:1),조카조카딸) || GETBIT(RELATION:(ARG:0):(ARG:1),사촌)
		LOCALS += "/"
ENDIF
IF GETBIT(RELATION:(ARG:0):(ARG:1),아저씨아줌마)
	IF ISMALE(ARG:1)
		LOCALS += "おじ"
		LOCAL ++
	ELSE
		LOCALS += "おば"
		LOCAL ++
	ENDIF
	SIF GETBIT(RELATION:(ARG:0):(ARG:1),사촌)
		LOCALS += "/"
ENDIF
IF GETBIT(RELATION:(ARG:0):(ARG:1),조카조카딸)
	IF ISMALE(ARG:1)
		LOCALS += "甥"
		LOCAL ++
	ELSE
		LOCALS += "姪"
		LOCAL ++
	ENDIF
	SIF GETBIT(RELATION:(ARG:0):(ARG:1),사촌)
		LOCALS += "/"
ENDIF
IF GETBIT(RELATION:(ARG:0):(ARG:1),사촌)
	LOCALS += "사촌"
	LOCAL ++
ENDIF
SIF LOCAL && (GETBIT(RELATION:(ARG:0):(ARG:1),친구) || GETBIT(RELATION:(ARG:0):(ARG:1),짝사랑) || GETBIT(RELATION:(ARG:0):(ARG:1),연인) || GETBIT(RELATION:(ARG:0):(ARG:1),약혼자) || GETBIT(RELATION:(ARG:0):(ARG:1),배우자))
	LOCALS += "かつ"
IF GETBIT(RELATION:(ARG:0):(ARG:1),친한) && GETBIT(RELATION:(ARG:0):(ARG:1),소원한) == 0 && GETBIT(RELATION:(ARG:0):(ARG:1),친구)
	LOCALS += "親友"
	LOCAL ++
	SIF LOCAL && (GETBIT(RELATION:(ARG:0):(ARG:1),짝사랑) || GETBIT(RELATION:(ARG:0):(ARG:1),연인) || GETBIT(RELATION:(ARG:0):(ARG:1),약혼자) || GETBIT(RELATION:(ARG:0):(ARG:1),배우자))
		LOCALS += "で"
ELSEIF GETBIT(RELATION:(ARG:0):(ARG:1),친구)
	LOCALS += "친구"
	LOCAL ++
	SIF LOCAL && (GETBIT(RELATION:(ARG:0):(ARG:1),짝사랑) || GETBIT(RELATION:(ARG:0):(ARG:1),연인) || GETBIT(RELATION:(ARG:0):(ARG:1),약혼자) || GETBIT(RELATION:(ARG:0):(ARG:1),배우자))
		LOCALS += "で"
ENDIF
IF GETBIT(RELATION:(ARG:0):(ARG:1),짝사랑)
	LOCALS += "짝사랑の相手"
	LOCAL ++
ENDIF
IF GETBIT(RELATION:(ARG:0):(ARG:1),연인)
	LOCALS += "연인"
	LOCAL ++
ENDIF
IF GETBIT(RELATION:(ARG:0):(ARG:1),약혼자)
	LOCALS += "약혼자"
	LOCAL ++
ENDIF
IF GETBIT(RELATION:(ARG:0):(ARG:1),배우자)
	IF ISMALE(ARG:1)
		LOCALS += "夫"
	ELSE
		LOCALS += "妻"
	ENDIF
	LOCAL ++
ENDIF
SIF LOCAL && (GETBIT(RELATION:(ARG:0):(ARG:1),주인) || GETBIT(RELATION:(ARG:0):(ARG:1),종자) || GETBIT(RELATION:(ARG:0):(ARG:1),노예))
	LOCALS += "かつ"
IF GETBIT(RELATION:(ARG:0):(ARG:1),주인)
	LOCALS += "주인"
	LOCAL ++
ENDIF
IF GETBIT(RELATION:(ARG:0):(ARG:1),종자)
	LOCALS += "종자"
	LOCAL ++
ENDIF
IF GETBIT(RELATION:(ARG:0):(ARG:1),노예)
	LOCALS += "노예"
	LOCAL ++
ENDIF

;文字列を返す
RESULTS = %LOCALS%


;--------------------------------------------------
;キャラの相関関係の付与
;--------------------------------------------------
;固有番号ARG:0のキャラに対するARG:1の関係を設定する
;一部の関係は双方向処理
@SET_RELATION, ARG:0, ARG:1
#DIM LCOUNT
#DIM SELECT, 64
#DIM CHECK
#DIM LOSE_VIRGIN, 2
#DIM WAITFLAG
VARSET LOCAL
VARSET SELECT
FOR LOCAL,0,64
	SIF GETBIT(RELATION:(ARG:0):(ARG:1),LOCAL) > 0
		SELECT:LOCAL = 1
NEXT
LCOUNT = LINECOUNT
$INPUT_LOOP
CALL LB
PRINTFORML {ARG:0}人目のキャラ『%CALLNAME:(ARG:0)%』と{ARG:1}人目のキャラ『%CALLNAME:(ARG:1)%』の関係を設定してください
DRAWLINE
LOCAL = 0
PRINTL 　印象
SIF SELECT:생이별한 > 0
	SETCOLOR 255,60,220
PRINTFORML 　　[{생이별한}]　生き別れ
RESETCOLOR
SIF SELECT:친한 > 0
	SETCOLOR 255,60,220
PRINTFORML 　　[{친한}]　친한
RESETCOLOR
SIF SELECT:소원한 > 0
	SETCOLOR 255,60,220
PRINTFORML 　　[{소원한}]　소원한
RESETCOLOR
SIF SELECT:사랑하는 > 0
	SETCOLOR 255,60,220
PRINTFORML 　　[{사랑하는}]　사랑하는
RESETCOLOR
SIF SELECT:증오하는 > 0
	SETCOLOR 255,60,220
PRINTFORML 　　[{증오하는}]　증오하는
RESETCOLOR
SIF SELECT:의리의 > 0
	SETCOLOR 255,60,220
PRINTFORML 　　[{의리의}]　의리의
RESETCOLOR
DRAWLINE
PRINTL 　関係
SIF SELECT:부모자식 > 0
	SETCOLOR 255,60,220
PRINTFORML 　　[{부모자식}] 부모자식
RESETCOLOR
SIF SELECT:형제자매 > 0
	SETCOLOR 255,60,220
PRINTFORML 　　[{형제자매}] 兄/弟/姉/妹
RESETCOLOR
SIF SELECT:조부모손주 > 0
	SETCOLOR 255,60,220
PRINTFORML 　　[{조부모손주}] 祖父/祖母/孫
RESETCOLOR
SIF SELECT:아저씨아줌마 > 0
	SETCOLOR 255,60,220
PRINTFORML 　　[{아저씨아줌마}] おじ/おば
RESETCOLOR
SIF SELECT:조카조카딸 > 0
	SETCOLOR 255,60,220
PRINTFORML 　　[{조카조카딸}] 甥/姪
RESETCOLOR
SIF SELECT:친구 > 0
	SETCOLOR 255,60,220
PRINTFORML 　　[{친구}] 친구
RESETCOLOR
SIF SELECT:짝사랑 > 0
	SETCOLOR 255,60,220
PRINTFORML 　　[{짝사랑}] 짝사랑の相手
RESETCOLOR
SIF SELECT:연인 > 0
	SETCOLOR 255,60,220
PRINTFORML 　　[{연인}] 연인
RESETCOLOR
SIF SELECT:약혼자 > 0
	SETCOLOR 255,60,220
PRINTFORML 　　[{약혼자}] 약혼자
RESETCOLOR
SIF SELECT:배우자 > 0
	SETCOLOR 255,60,220
PRINTFORML 　　[{배우자}] 배우자
RESETCOLOR
SIF SELECT:주인 > 0
	SETCOLOR 255,60,220
PRINTFORML 　　[{주인}] 주인
RESETCOLOR
SIF SELECT:종자 > 0
	SETCOLOR 255,60,220
PRINTFORML 　　[{종자}] 종자
RESETCOLOR
SIF SELECT:노예 > 0
	SETCOLOR 255,60,220
PRINTFORML 　　[{노예}] 노예
RESETCOLOR
DRAWLINE
CHECK = 0
LOSE_VIRGIN:0 = 0
LOSE_VIRGIN:1 = 0
IF SELECT:부모자식 == 0 && SELECT:형제자매 == 0 && SELECT:조부모손주 == 0 && SELECT:아저씨아줌마 == 0 && SELECT:조카조카딸 == 0 && SELECT:사촌 == 0
	IF SELECT:생이별한 > 0
		PRINTL  가족관계が無いキャラクターに「生き別れ」は付けられません
		CHECK = 1
	ENDIF
	IF SELECT:의리의 > 0
		PRINTL  가족관계が無いキャラクターに「의리의」は付けられません
		CHECK = 1
	ENDIF
ENDIF
IF SELECT:부모자식 > 0 && SELECT:의리의 == 0
	IF TOSHIUE_F(ARG:0, ARG:1) > 0 && TALENT:(ARG:0):처녀 > 0 && ISFEMALE(ARG:0)
		PRINTFORML  %CALLNAME:(ARG:0)%の方が年上ですが처녀なので実の母親にはなれません
		IF TALENT:(ARG:0):고유캐릭터 == 0
			PRINTFORML  決定した場合は%CALLNAME:(ARG:0)%の처녀を消去します
		ELSE
			CHECK = 1
		ENDIF
		LOSE_VIRGIN:0 = 1
	ELSEIF TOSHIUE_F(ARG:1, ARG:0) > 0 && TALENT:(ARG:1):처녀 > 0 && ISFEMALE(ARG:1)
		PRINTFORML  %CALLNAME:(ARG:1)%の方が年上ですが처녀なので実の母親にはなれません
		IF TALENT:(ARG:1):고유캐릭터 == 0
			PRINTFORML  決定した場合は%CALLNAME:(ARG:1)%の처녀を消去します
		ELSE
			CHECK = 1
		ENDIF
		LOSE_VIRGIN:1 = 1
	ENDIF
ENDIF
IF SELECT:조부모손주 > 0 && SELECT:의리의 == 0
	IF TOSHIUE_F(ARG:0, ARG:1) > 0 && TALENT:(ARG:0):처녀 > 0 && ISFEMALE(ARG:0)
		PRINTFORML  %CALLNAME:(ARG:0)%の方が年上ですが처녀なので実の祖母にはなれません
		IF TALENT:(ARG:0):고유캐릭터 == 0
			PRINTFORML  決定した場合は%CALLNAME:(ARG:0)%の처녀を消去します
		ELSE
			CHECK = 1
		ENDIF
		LOSE_VIRGIN:0 = 1
	ELSEIF TOSHIUE_F(ARG:1, ARG:0) > 0 && TALENT:(ARG:1):처녀 > 0 && ISFEMALE(ARG:1)
		PRINTFORML  %CALLNAME:(ARG:1)%の方が年上ですが처녀なので実の祖母にはなれません
		IF TALENT:(ARG:1):고유캐릭터 == 0
			PRINTFORML  決定した場合は%CALLNAME:(ARG:1)%の처녀を消去します
		ELSE
			CHECK = 1
		ENDIF
		LOSE_VIRGIN:1 = 1
	ENDIF
ENDIF
SIF CHECK > 0
	SETCOLOR 105,105,105
PRINTL 　[200] 결정
RESETCOLOR
PRINTL 　[999]キャンセル
INPUT 
SIF RESULT != 200
	CLEARLINE LINECOUNT - LCOUNT
IF RESULT == 200 && CHECK == 0
	RELATION:(ARG:0):(ARG:1) = 0
	FOR LOCAL, 1, 64
		SIF SELECT:LOCAL > 0
			SETBIT RELATION:(ARG:0):(ARG:1), LOCAL
	NEXT
	;처녀を消す処理
	SIF LOSE_VIRGIN:0 > 0
		TALENT:(ARG:0):처녀 = 0
	SIF LOSE_VIRGIN:1 > 0
		TALENT:(ARG:1):처녀 = 0

	WAITFLAG = 0

	;関係の双方向化
	IF GETBIT(RELATION:(ARG:0):(ARG:1), 생이별한) > 0
		SIF GETBIT(RELATION:(ARG:1):(ARG:0), 생이별한) == 0
			WAITFLAG ++
		SETBIT RELATION:(ARG:1):(ARG:0), 생이별한
	ELSE
		SIF GETBIT(RELATION:(ARG:1):(ARG:0), 생이별한) > 0
			WAITFLAG ++
		CLEARBIT RELATION:(ARG:1):(ARG:0), 생이별한
	ENDIF
	IF GETBIT(RELATION:(ARG:0):(ARG:1), 의리의) > 0
		SIF GETBIT(RELATION:(ARG:1):(ARG:0), 의리의) == 0
			WAITFLAG ++
		SETBIT RELATION:(ARG:1):(ARG:0), 의리의
	ELSE
		SIF GETBIT(RELATION:(ARG:1):(ARG:0), 의리의) > 0
			WAITFLAG ++
		CLEARBIT RELATION:(ARG:1):(ARG:0), 의리의
	ENDIF
	IF GETBIT(RELATION:(ARG:0):(ARG:1), 부모자식) > 0
		SIF GETBIT(RELATION:(ARG:1):(ARG:0), 부모자식) == 0
			WAITFLAG ++
		SETBIT RELATION:(ARG:1):(ARG:0), 부모자식
	ELSE
		SIF GETBIT(RELATION:(ARG:1):(ARG:0), 부모자식) > 0
			WAITFLAG ++
		CLEARBIT RELATION:(ARG:1):(ARG:0), 부모자식
	ENDIF
	IF GETBIT(RELATION:(ARG:0):(ARG:1), 형제자매) > 0
		SIF GETBIT(RELATION:(ARG:1):(ARG:0), 형제자매) == 0
			WAITFLAG ++
		SETBIT RELATION:(ARG:1):(ARG:0), 형제자매
	ELSE
		SIF GETBIT(RELATION:(ARG:1):(ARG:0), 형제자매) > 0
			WAITFLAG ++
		CLEARBIT RELATION:(ARG:1):(ARG:0), 형제자매
	ENDIF
	IF GETBIT(RELATION:(ARG:0):(ARG:1), 조부모손주) > 0
		SIF GETBIT(RELATION:(ARG:1):(ARG:0), 조부모손주) == 0
			WAITFLAG ++
		SETBIT RELATION:(ARG:1):(ARG:0), 조부모손주
	ELSE
		SIF GETBIT(RELATION:(ARG:1):(ARG:0), 조부모손주) > 0
		WAITFLAG ++
		CLEARBIT RELATION:(ARG:1):(ARG:0), 조부모손주
	ENDIF
	IF GETBIT(RELATION:(ARG:0):(ARG:1), 아저씨아줌마) > 0
		SIF GETBIT(RELATION:(ARG:1):(ARG:0), 조카조카딸) == 0
			WAITFLAG ++
		SETBIT RELATION:(ARG:1):(ARG:0), 조카조카딸
	ELSE
		SIF GETBIT(RELATION:(ARG:1):(ARG:0), 조카조카딸) > 0
			WAITFLAG ++
		CLEARBIT RELATION:(ARG:1):(ARG:0), 조카조카딸
	ENDIF
	IF GETBIT(RELATION:(ARG:0):(ARG:1), 조카조카딸) > 0
		SIF GETBIT(RELATION:(ARG:1):(ARG:0), 아저씨아줌마) == 0
			WAITFLAG ++
		SETBIT RELATION:(ARG:1):(ARG:0), 아저씨아줌마
	ELSE
		SIF GETBIT(RELATION:(ARG:1):(ARG:0), 아저씨아줌마) > 0
			WAITFLAG ++
		CLEARBIT RELATION:(ARG:1):(ARG:0), 아저씨아줌마
	ENDIF
	IF GETBIT(RELATION:(ARG:0):(ARG:1), 사촌) > 0
		SIF GETBIT(RELATION:(ARG:1):(ARG:0), 사촌) == 0
			WAITFLAG ++
		SETBIT RELATION:(ARG:1):(ARG:0), 사촌
	ELSE
		SIF GETBIT(RELATION:(ARG:1):(ARG:0), 사촌) > 0
			WAITFLAG ++
		CLEARBIT RELATION:(ARG:1):(ARG:0), 사촌
	ENDIF
	IF GETBIT(RELATION:(ARG:0):(ARG:1), 연인) > 0
		SIF GETBIT(RELATION:(ARG:1):(ARG:0), 연인) == 0
			WAITFLAG ++
		SETBIT RELATION:(ARG:1):(ARG:0), 연인
	ELSE
		SIF GETBIT(RELATION:(ARG:1):(ARG:0), 연인) > 0
			WAITFLAG ++
		CLEARBIT RELATION:(ARG:1):(ARG:0), 연인
	ENDIF
	IF GETBIT(RELATION:(ARG:0):(ARG:1), 약혼자) > 0
		SIF GETBIT(RELATION:(ARG:1):(ARG:0), 약혼자) == 0
			WAITFLAG ++
		SETBIT RELATION:(ARG:1):(ARG:0), 약혼자
	ELSE
		SIF GETBIT(RELATION:(ARG:1):(ARG:0), 약혼자) > 0
			WAITFLAG ++
		CLEARBIT RELATION:(ARG:1):(ARG:0), 약혼자
	ENDIF
	IF GETBIT(RELATION:(ARG:0):(ARG:1), 배우자) > 0
		SIF GETBIT(RELATION:(ARG:1):(ARG:0), 배우자) == 0
			WAITFLAG ++
		SETBIT RELATION:(ARG:1):(ARG:0), 배우자
	ELSE
		SIF GETBIT(RELATION:(ARG:1):(ARG:0), 배우자) > 0
			WAITFLAG ++
		CLEARBIT RELATION:(ARG:1):(ARG:0), 배우자
	ENDIF
	IF GETBIT(RELATION:(ARG:0):(ARG:1), 주인) > 0
		IF GETBIT(RELATION:(ARG:1):(ARG:0), 종자) == 0 || GETBIT(RELATION:(ARG:1):(ARG:0), 노예) == 0
			WAITFLAG ++
			PRINTFORML 『%CALLNAME:(ARG:1)%』にとって『%CALLNAME:(ARG:0)%』は
			PRINTFORML 　　[{종자}] 종자
			PRINTFORML 　　[{노예}] 노예
			$INPUT_LOOP주인
			INPUT 
			IF RESULT == 41
				SETBIT RELATION:(ARG:1):(ARG:0),종자 
			ELSEIF RESULT == 42
				SETBIT RELATION:(ARG:1):(ARG:0), 노예
			ELSE
				GOTO INPUT_LOOP주인
			ENDIF
		ENDIF
	ELSE
		SIF GETBIT(RELATION:(ARG:1):(ARG:0), 종자) > 0 || GETBIT(RELATION:(ARG:1):(ARG:0), 노예) > 0
			WAITFLAG ++
		CLEARBIT RELATION:(ARG:1):(ARG:0), 종자
		CLEARBIT RELATION:(ARG:1):(ARG:0), 노예
	ENDIF
	IF GETBIT(RELATION:(ARG:0):(ARG:1), 종자) > 0 || GETBIT(RELATION:(ARG:0):(ARG:1), 노예) > 0
		SIF GETBIT(RELATION:(ARG:1):(ARG:0), 주인) == 0
			WAITFLAG ++
		SETBIT RELATION:(ARG:1):(ARG:0), 주인
	ELSE
		SIF GETBIT(RELATION:(ARG:1):(ARG:0), 주인) > 0
			WAITFLAG ++
		CLEARBIT RELATION:(ARG:1):(ARG:0), 주인
	ENDIF

	IF RELATION:(ARG:0):(ARG:1) > 0
		CALL GET_RELATION, ARG:0, ARG:1
		PRINTFORML 『%CALLNAME:(ARG:0)%』にとって『%CALLNAME:(ARG:1)%』は【%RESULTS%】です。
	ELSE
		PRINTFORML 『%CALLNAME:(ARG:0)%』と『%CALLNAME:(ARG:1)%』の間に相関関係はありません。
	ENDIF
	;相手との関係に変動があった場合、メッセージ表示
	IF RELATION:(ARG:1):(ARG:0) > 0 && WAITFLAG > 0
		CALL GET_RELATION, (ARG:1), (ARG:0)
		PRINTFORML 『%CALLNAME:(ARG:1)%』にとって『%CALLNAME:(ARG:0)%』は【%RESULTS%】になりました。
	ELSEIF WAITFLAG > 0
		PRINTFORML 『%CALLNAME:(ARG:1)%』と『%CALLNAME:(ARG:0)%』の相関関係は無くなりました。
	ENDIF
	PRINTW 

	RETURN
ELSEIF RESULT == 999
	RETURN
ELSEIF (RESULT >= 1 && RESULT <= 의리의) || (RESULT >= 부모자식 && RESULT <= 사촌) || (RESULT >= 친구 && RESULT <= 배우자) || (RESULT >= 주인 && RESULT <= 노예)
	IF SELECT:RESULT > 0
		SELECT:RESULT = 0
	ELSE
		SELECT:RESULT = 1
	ENDIF
	SIF RESULT == 아저씨아줌마
		SELECT:조카조카딸 = 0
	SIF RESULT == 조카조카딸
		SELECT:아저씨아줌마 = 0
	IF RESULT == 짝사랑
		SELECT:연인 = 0
		SELECT:약혼자 = 0
		SELECT:배우자 = 0
	ENDIF
	IF RESULT == 연인
		SELECT:짝사랑 = 0
		SELECT:약혼자 = 0
		SELECT:배우자 = 0
	ENDIF
	IF RESULT == 약혼자
		SELECT:짝사랑 = 0
		SELECT:연인 = 0
		SELECT:배우자 = 0
	ENDIF
	IF RESULT == 배우자
		SELECT:짝사랑 = 0
		SELECT:연인 = 0
		SELECT:약혼자 = 0
	ENDIF
	IF RESULT == 주인
		SELECT:종자 = 0
		SELECT:노예 = 0
	ENDIF
	IF RESULT == 종자
		SELECT:주인 = 0
		SELECT:노예 = 0
	ENDIF
	IF RESULT == 노예
		SELECT:주인 = 0
		SELECT:종자 = 0
	ENDIF
ENDIF
GOTO INPUT_LOOP





;--------------------------------------------------
;相関関係の全キャラ探索
;--------------------------------------------------
@CHECK_ALL_RELATION
#DIM CHARA
#DIM SELECT
#DIM RELATE
#DIM WAITFLAG, 2
;キャラ２人未満なら中断
SIF CHARANUM < 3
	RETURN
;自キャラの全探索
FOR CHARA, 0, CHARANUM
	SIF CHARA == MASTER
		CONTINUE

	;両親が仲間に居る場合
	IF CFLAG:CHARA:9 <= -100 || CFLAG:CHARA:7 > 0
		FOR SELECT, 0, CHARANUM
			SIF SELECT == MASTER
				CONTINUE
			SIF SELECT == CHARA
				CONTINUE
			;부모자식
			IF (CFLAG:CHARA:9 <= -100 && CFLAG:SELECT:240 == CFLAG:CHARA:9 * -1 - 100) || (CFLAG:CHARA:7 > 0 && CFLAG:SELECT:240 == CFLAG:CHARA:7)
				SETBIT RELATION:CHARA:SELECT, 부모자식
				SETBIT RELATION:SELECT:CHARA, 부모자식
			ENDIF
		NEXT
	ENDIF

	;相手キャラの探索
	FOR SELECT, 0, CHARANUM
		SIF SELECT == MASTER
			CONTINUE
		SIF SELECT == CHARA
			CONTINUE
		WAITFLAG:0 = 0
		WAITFLAG:1 = 0

		;自分に親か子が居る場合
		FOR RELATE, 0, CHARANUM
			SIF RELATE == MASTER
				CONTINUE
			SIF RELATE == CHARA
				CONTINUE
			;親が居る場合
			IF GETBIT(RELATION:CHARA:RELATE, 부모자식) && TOSHIUE_F(RELATE, CHARA) > 0
				PRINTL 
				;同じ親を持つ相手なら형제자매
				IF GETBIT(RELATION:SELECT:RELATE, 부모자식) && TOSHIUE_F(RELATE, SELECT) > 0
					SIF GETBIT(RELATION:CHARA:SELECT, 형제자매) == 0
						WAITFLAG:0 ++
					SETBIT RELATION:CHARA:SELECT, 형제자매
					SIF GETBIT(RELATION:SELECT:CHARA, 형제자매) == 0
						WAITFLAG:1 ++
					SETBIT RELATION:SELECT:CHARA, 형제자매
					;의리의場合
					IF GETBIT(RELATION:CHARA:RELATE, 의리의)
						SETBIT RELATION:CHARA:SELECT, 의리의
						SETBIT RELATION:SELECT:CHARA, 의리의
					ENDIF
				ENDIF
				;親の親で年上なら祖父母
				IF GETBIT(RELATION:RELATE:SELECT, 부모자식) && TOSHIUE_F(SELECT, RELATE) > 0
					IF TOSHIUE_F(SELECT, CHARA) > 0
						SIF GETBIT(RELATION:CHARA:SELECT, 조부모손주) == 0
							WAITFLAG:0 ++
						SETBIT RELATION:CHARA:SELECT, 조부모손주
						SIF GETBIT(RELATION:SELECT:CHARA, 조부모손주) == 0
							WAITFLAG:1 ++
						SETBIT RELATION:SELECT:CHARA, 조부모손주
						;의리의場合
						IF GETBIT(RELATION:CHARA:RELATE, 의리의)
							SETBIT RELATION:CHARA:SELECT, 의리의
							SETBIT RELATION:SELECT:CHARA, 의리의
						ENDIF
					ENDIF
				ENDIF
				;親の형제자매なら아저씨아줌마
				IF GETBIT(RELATION:RELATE:SELECT, 형제자매)
					SIF GETBIT(RELATION:CHARA:SELECT, 아저씨아줌마) == 0
						WAITFLAG:0 ++
					SETBIT RELATION:CHARA:SELECT, 아저씨아줌마
					SIF GETBIT(RELATION:SELECT:CHARA, 조카조카딸) == 0
						WAITFLAG:1 ++
					SETBIT RELATION:SELECT:CHARA, 조카조카딸
					;의리의場合
					IF GETBIT(RELATION:CHARA:RELATE, 의리의)
						SETBIT RELATION:CHARA:SELECT, 의리의
						SETBIT RELATION:SELECT:CHARA, 의리의
					ENDIF
				ENDIF
			ENDIF
			;子が居る場合
			IF GETBIT(RELATION:CHARA:RELATE, 부모자식) && TOSHIUE_F(CHARA, RELATE) > 0
				;子の子で年下なら孫
				IF GETBIT(RELATION:RELATE:SELECT, 부모자식) && TOSHIUE_F(RELATE, SELECT) > 0
					IF TOSHIUE_F(CHARA, SELECT) > 0
						SIF GETBIT(RELATION:CHARA:SELECT, 조부모손주) == 0
							WAITFLAG:0 ++
						SETBIT RELATION:CHARA:SELECT, 조부모손주
						SIF GETBIT(RELATION:SELECT:CHARA, 조부모손주) == 0
							WAITFLAG:1 ++
						SETBIT RELATION:SELECT:CHARA, 조부모손주
						;의리의場合
						IF GETBIT(RELATION:CHARA:RELATE, 의리의)
							SETBIT RELATION:CHARA:SELECT, 의리의
							SETBIT RELATION:SELECT:CHARA, 의리의
						ENDIF
					ENDIF
				ENDIF
				;子の祖父母で相手が年上なら親
				IF GETBIT(RELATION:RELATE:SELECT, 조부모손주) && TOSHIUE_F(SELECT, RELATE) > 0
					IF TOSHIUE_F(SELECT, CHARA) > 0
						SIF GETBIT(RELATION:CHARA:SELECT, 부모자식) == 0
							WAITFLAG:0 ++
						SETBIT RELATION:CHARA:SELECT, 부모자식
						SIF GETBIT(RELATION:SELECT:CHARA, 부모자식) == 0
							WAITFLAG:1 ++
						SETBIT RELATION:SELECT:CHARA, 부모자식
						;의리의場合
						IF GETBIT(RELATION:CHARA:RELATE, 의리의)
							SETBIT RELATION:CHARA:SELECT, 의리의
							SETBIT RELATION:SELECT:CHARA, 의리의
						ENDIF
					ENDIF
				ENDIF
			ENDIF
		NEXT
		;自分に형제자매が居る場合
		FOR RELATE, 0, CHARANUM
			SIF RELATE == MASTER
				CONTINUE
			SIF RELATE == CHARA
				CONTINUE
			IF GETBIT(RELATION:CHARA:RELATE, 형제자매)
				;형제자매の형제자매は형제자매
				IF GETBIT(RELATION:RELATE:SELECT, 형제자매)
					SIF GETBIT(RELATION:CHARA:SELECT, 형제자매) == 0
						WAITFLAG:0 ++
					SETBIT RELATION:CHARA:SELECT, 형제자매
					SIF GETBIT(RELATION:SELECT:CHARA, 형제자매) == 0
						WAITFLAG:1 ++
					SETBIT RELATION:SELECT:CHARA, 형제자매
				ENDIF
				;형제자매の親で年上なら親
				IF GETBIT(RELATION:RELATE:SELECT, 부모자식) && TOSHIUE_F(SELECT, RELATE) > 0
					IF TOSHIUE_F(SELECT, CHARA) > 0
						SIF GETBIT(RELATION:CHARA:SELECT, 부모자식) == 0
							WAITFLAG:0 ++
						SETBIT RELATION:CHARA:SELECT, 부모자식
						SIF GETBIT(RELATION:SELECT:CHARA, 부모자식) == 0
							WAITFLAG:1 ++
						SETBIT RELATION:SELECT:CHARA, 부모자식
					ENDIF
				ENDIF
				;형제자매の祖父母で年上なら祖父母
				IF GETBIT(RELATION:RELATE:SELECT, 조부모손주) && TOSHIUE_F(SELECT, RELATE) > 0
					IF TOSHIUE_F(SELECT, CHARA) > 0
						SIF GETBIT(RELATION:CHARA:SELECT, 조부모손주) == 0
							WAITFLAG:0 ++
						SETBIT RELATION:CHARA:SELECT, 조부모손주
						SIF GETBIT(RELATION:SELECT:CHARA, 조부모손주) == 0
							WAITFLAG:1 ++
						SETBIT RELATION:SELECT:CHARA, 조부모손주
					ENDIF
				ENDIF
				;형제자매の子は조카조카딸
				IF GETBIT(RELATION:RELATE:SELECT, 부모자식) && TOSHIUE_F(RELATE, SELECT) > 0
					SIF GETBIT(RELATION:CHARA:SELECT, 조카조카딸) == 0
						WAITFLAG:0 ++
					SETBIT RELATION:CHARA:SELECT, 조카조카딸
					SIF GETBIT(RELATION:SELECT:CHARA, 아저씨아줌마) == 0
						WAITFLAG:1 ++
					SETBIT RELATION:SELECT:CHARA, 아저씨아줌마
				ENDIF
			ENDIF
		NEXT
		;自分に祖父母か孫が居る場合
		FOR RELATE, 0, CHARANUM
			SIF RELATE == MASTER
				CONTINUE
			SIF RELATE == CHARA
				CONTINUE
			;祖父母が居る場合
			IF GETBIT(RELATION:CHARA:RELATE, 조부모손주) && TOSHIUE_F(RELATE, CHARA) > 0
				;親ではない祖父母の子は아저씨아줌마
				IF GETBIT(RELATION:RELATE:SELECT, 부모자식) && TOSHIUE_F(RELATE, SELECT) > 0 && GETBIT(RELATION:CHARA:SELECT, 부모자식) == 0
					SIF GETBIT(RELATION:CHARA:SELECT, 아저씨아줌마) == 0
						WAITFLAG:0 ++
					SETBIT RELATION:CHARA:SELECT, 아저씨아줌마
					SIF GETBIT(RELATION:SELECT:CHARA, 조카조카딸) == 0
						WAITFLAG:1 ++
					SETBIT RELATION:SELECT:CHARA, 조카조카딸
					;의리의場合
					IF GETBIT(RELATION:CHARA:RELATE, 의리의)
						SETBIT RELATION:CHARA:SELECT, 의리의
						SETBIT RELATION:SELECT:CHARA, 의리의
					ENDIF
				ENDIF
			ENDIF
			;孫が居る場合
			IF GETBIT(RELATION:CHARA:RELATE, 조부모손주) && TOSHIUE_F(CHARA, RELATE) > 0
				;孫の親が年下なら子
				IF GETBIT(RELATION:RELATE:SELECT, 부모자식) && TOSHIUE_F(SELECT, RELATE) > 0
					IF TOSHIUE_F(CHARA, SELECT) > 0
						SIF GETBIT(RELATION:CHARA:SELECT, 부모자식) == 0
							WAITFLAG:0 ++
						SETBIT RELATION:CHARA:SELECT, 부모자식
						SIF GETBIT(RELATION:SELECT:CHARA, 부모자식) == 0
							WAITFLAG:1 ++
						SETBIT RELATION:SELECT:CHARA, 부모자식
					ENDIF
				ENDIF
			ENDIF
		NEXT
		;自分に아저씨아줌마が居る場合
		FOR RELATE, 0, CHARANUM
			SIF RELATE == MASTER
				CONTINUE
			SIF RELATE == CHARA
				CONTINUE
			IF GETBIT(RELATION:CHARA:RELATE, 아저씨아줌마)
				;아저씨아줌마の子は사촌
				IF GETBIT(RELATION:RELATE:SELECT, 부모자식) && TOSHIUE_F(RELATE, SELECT) > 0
					SIF GETBIT(RELATION:CHARA:SELECT, 사촌) == 0
						WAITFLAG:0 ++
					SETBIT RELATION:CHARA:SELECT, 사촌
					SIF GETBIT(RELATION:SELECT:CHARA, 사촌) == 0
						WAITFLAG:1 ++
					SETBIT RELATION:SELECT:CHARA, 사촌
					;의리의場合
					IF GETBIT(RELATION:CHARA:RELATE, 의리의)
						SETBIT RELATION:CHARA:SELECT, 의리의
						SETBIT RELATION:SELECT:CHARA, 의리의
					ENDIF
				ENDIF
			ENDIF
		NEXT
		;自分に사촌が居る場合
		FOR RELATE, 0, CHARANUM
			SIF RELATE == MASTER
				CONTINUE
			SIF RELATE == CHARA
				CONTINUE
			IF GETBIT(RELATION:CHARA:RELATE, 사촌)
				;사촌の親は아저씨아줌마
				IF GETBIT(RELATION:RELATE:SELECT, 부모자식) && TOSHIUE_F(SELECT, RELATE) > 0
					SIF GETBIT(RELATION:CHARA:SELECT, 아저씨아줌마) == 0
						WAITFLAG:0 ++
					SETBIT RELATION:CHARA:SELECT, 아저씨아줌마
					SIF GETBIT(RELATION:SELECT:CHARA, 조카조카딸) == 0
						WAITFLAG:1 ++
					SETBIT RELATION:SELECT:CHARA, 조카조카딸
					;의리의場合
					IF GETBIT(RELATION:CHARA:RELATE, 의리의)
						SETBIT RELATION:CHARA:SELECT, 의리의
						SETBIT RELATION:SELECT:CHARA, 의리의
					ENDIF
				ENDIF
			ENDIF
		NEXT

		;関係の双方向化
		IF GETBIT(RELATION:CHARA:SELECT, 생이별한) > 0
			SIF GETBIT(RELATION:SELECT:CHARA, 생이별한) == 0
				WAITFLAG:1 ++
			SETBIT RELATION:SELECT:CHARA, 생이별한
		ELSE
			SIF GETBIT(RELATION:SELECT:CHARA,생이별한) > 0
				WAITFLAG:1 ++
			CLEARBIT RELATION:SELECT:CHARA, 생이별한
		ENDIF
		IF GETBIT(RELATION:CHARA:SELECT, 의리의) > 0
			SIF GETBIT(RELATION:SELECT:CHARA, 의리의) == 0
				WAITFLAG:1 ++
			SETBIT RELATION:SELECT:CHARA, 의리의
		ELSE
			SIF GETBIT(RELATION:SELECT:CHARA, 의리의) > 0
				WAITFLAG:1 ++
			CLEARBIT RELATION:SELECT:CHARA, 의리의
		ENDIF
		IF GETBIT(RELATION:CHARA:SELECT, 부모자식) > 0
			SIF GETBIT(RELATION:SELECT:CHARA, 부모자식) == 0
				WAITFLAG:1 ++
			SETBIT RELATION:SELECT:CHARA, 부모자식
		ELSE
			SIF GETBIT(RELATION:SELECT:CHARA, 부모자식) > 0
				WAITFLAG:1 ++
			CLEARBIT RELATION:SELECT:CHARA, 부모자식
		ENDIF
		IF GETBIT(RELATION:CHARA:SELECT, 형제자매) > 0
			SIF GETBIT(RELATION:SELECT:CHARA, 형제자매) == 0
				WAITFLAG:1 ++
			SETBIT RELATION:SELECT:CHARA, 형제자매
		ELSE
			SIF GETBIT(RELATION:SELECT:CHARA, 형제자매) > 0
				WAITFLAG:1 ++
			CLEARBIT RELATION:SELECT:CHARA, 형제자매
		ENDIF
		IF GETBIT(RELATION:CHARA:SELECT, 조부모손주) > 0
			SIF GETBIT(RELATION:SELECT:CHARA, 조부모손주) == 0
				WAITFLAG:1 ++
			SETBIT RELATION:SELECT:CHARA, 조부모손주
		ELSE
			SIF GETBIT(RELATION:SELECT:CHARA, 조부모손주) > 0
				WAITFLAG:1 ++
			CLEARBIT RELATION:SELECT:CHARA, 조부모손주
		ENDIF
		IF GETBIT(RELATION:CHARA:SELECT, 아저씨아줌마) > 0
			SIF GETBIT(RELATION:SELECT:CHARA, 조카조카딸) == 0
				WAITFLAG:1 ++
			SETBIT RELATION:SELECT:CHARA, 조카조카딸
		ELSE
			SIF GETBIT(RELATION:SELECT:CHARA, 조카조카딸) > 0
				WAITFLAG:1 ++
			CLEARBIT RELATION:SELECT:CHARA, 조카조카딸
		ENDIF
		IF GETBIT(RELATION:CHARA:SELECT, 조카조카딸) > 0
			SIF GETBIT(RELATION:SELECT:CHARA, 아저씨아줌마) == 0
				WAITFLAG:1 ++
			SETBIT RELATION:SELECT:CHARA, 아저씨아줌마
		ELSE
			SIF GETBIT(RELATION:SELECT:CHARA, 아저씨아줌마) > 0
				WAITFLAG:1 ++
			CLEARBIT RELATION:SELECT:CHARA, 아저씨아줌마
		ENDIF
		IF GETBIT(RELATION:CHARA:SELECT, 사촌) > 0
			SIF GETBIT(RELATION:SELECT:CHARA, 사촌) == 0
				WAITFLAG:1 ++
			SETBIT RELATION:SELECT:CHARA, 사촌
		ELSE
			SIF GETBIT(RELATION:SELECT:CHARA, 사촌) > 0
				WAITFLAG:1 ++
			CLEARBIT RELATION:SELECT:CHARA, 사촌
		ENDIF
		IF GETBIT(RELATION:CHARA:SELECT, 연인) > 0
			SIF GETBIT(RELATION:SELECT:CHARA, 연인) == 0
				WAITFLAG:1 ++
			SETBIT RELATION:SELECT:CHARA, 연인
		ELSE
			SIF GETBIT(RELATION:SELECT:CHARA, 연인) > 0
				WAITFLAG:1 ++
			CLEARBIT RELATION:SELECT:CHARA, 연인
		ENDIF
		IF GETBIT(RELATION:CHARA:SELECT, 약혼자) > 0
			SIF GETBIT(RELATION:SELECT:CHARA, 약혼자) == 0
				WAITFLAG:1 ++
			SETBIT RELATION:SELECT:CHARA, 약혼자
		ELSE
			SIF GETBIT(RELATION:SELECT:CHARA, 약혼자) > 0
				WAITFLAG:1 ++
			CLEARBIT RELATION:SELECT:CHARA, 약혼자
		ENDIF
		IF GETBIT(RELATION:CHARA:SELECT, 배우자) > 0
			SIF GETBIT(RELATION:SELECT:CHARA, 배우자) == 0
				WAITFLAG:1 ++
			SETBIT RELATION:SELECT:CHARA, 배우자
		ELSE
			SIF GETBIT(RELATION:SELECT:CHARA, 배우자) > 0
				WAITFLAG:1 ++
			CLEARBIT RELATION:SELECT:CHARA, 배우자
		ENDIF
		IF GETBIT(RELATION:CHARA:SELECT, 부모자식) == 0 && GETBIT(RELATION:CHARA:SELECT, 형제자매) == 0 && GETBIT(RELATION:CHARA:SELECT, 조부모손주) == 0 && GETBIT(RELATION:CHARA:SELECT, 아저씨아줌마) == 0 && GETBIT(RELATION:CHARA:SELECT, 조카조카딸) == 0
			SIF GETBIT(RELATION:SELECT:CHARA, 생이별한) || GETBIT(RELATION:SELECT:CHARA, 의리의)
				WAITFLAG:1 ++
			CLEARBIT RELATION:SELECT:CHARA, 생이별한
			CLEARBIT RELATION:SELECT:CHARA, 의리의
		ENDIF
		;相手との関係に変動があった場合、メッセージ表示
		IF RELATION:CHARA:SELECT > 0 && WAITFLAG:0 > 0
			CALL GET_RELATION, CHARA, SELECT
			PRINTFORML 『%CALLNAME:CHARA%』にとって『%CALLNAME:SELECT%』は【%RESULTS%】になりました。
		ELSEIF WAITFLAG:0 > 0
			PRINTFORML 『%CALLNAME:CHARA%』と『%CALLNAME:SELECT%』の相関関係は無くなりました。
		ENDIF
		IF RELATION:SELECT:CHARA > 0 && WAITFLAG:1 > 0
			CALL GET_RELATION, SELECT, CHARA
			PRINTFORML 『%CALLNAME:SELECT%』にとって『%CALLNAME:CHARA%』は【%RESULTS%】になりました。
		ELSEIF WAITFLAG:1 > 0
			PRINTFORML 『%CALLNAME:SELECT%』と『%CALLNAME:CHARA%』の相関関係は無くなりました。
		ENDIF
		SIF WAITFLAG:0 || WAITFLAG:1
			PRINTL 
		;子供か孫を持つキャラは처녀を失う
		IF GETBIT(RELATION:CHARA:SELECT, 의리의) == 0 && (GETBIT(RELATION:CHARA:SELECT, 부모자식) || GETBIT(RELATION:CHARA:SELECT, 조부모손주))
			IF TOSHIUE_F(CHARA, SELECT) > 0
				IF TALENT:CHARA:처녀 > 0
					TALENT:CHARA:처녀 = 0
					PRINTFORML 　　関係の変化により『%CALLNAME:CHARA%』の처녀を消去しました
					PRINTL 
				ENDIF
			ENDIF
		ENDIF
	NEXT
NEXT
;両親ＩＤを設定
FOR CHARA, 0, CHARANUM
	SIF CHARA == MASTER
		CONTINUE
	;父親の探索
	FOR SELECT, 0, CHARANUM
		SIF SELECT == MASTER
			CONTINUE
		SIF SELECT == CHARA
			CONTINUE
		;実の부모자식かつ男性か후타나리なら父親
		SIF GETBIT(RELATION:CHARA:SELECT, 부모자식) && GETBIT(RELATION:CHARA:SELECT, 의리의) == 0 && TOSHIUE_F(SELECT, CHARA) > 0 && (ISMALE(SELECT) || TALENT:SELECT:후타나리 > 0) && CFLAG:CHARA:7 != CFLAG:SELECT:240 && CFLAG:CHARA:9 == 0
			CFLAG:CHARA:9 = CFLAG:SELECT:240 * -1 - 100
	NEXT
	FOR SELECT, 0, CHARANUM
		SIF SELECT == MASTER
			CONTINUE
		SIF SELECT == CHARA
			CONTINUE
		;実の부모자식かつ男性でないなら母親
		SIF GETBIT(RELATION:CHARA:SELECT, 부모자식) && GETBIT(RELATION:CHARA:SELECT, 의리의) == 0 && TOSHIUE_F(SELECT, CHARA) > 0 && ISFEMALE(SELECT) && CFLAG:CHARA:9 * -1 - 100 != CFLAG:SELECT:240 && CFLAG:CHARA:7 == 0
			CFLAG:CHARA:7 = CFLAG:SELECT:240
	NEXT
NEXT



;年上判定
;-------------------------------------------------
;ARG:0がARG:1より年上なら1を返す
@TOSHIUE_F(ARG:0, ARG:1)
#FUNCTION
IF BASE:(ARG:0):실제나이 > BASE:(ARG:1):실제나이
	LOCAL = 1
ELSEIF BASE:(ARG:0):실제나이 == BASE:(ARG:1):실제나이 && CFLAG:(ARG:0):240 < CFLAG:(ARG:1):240
	LOCAL = 1
ELSE
	LOCAL = 0
ENDIF
RETURNF LOCAL


;근친상간判定
;------------------------------------------------
;ARG:0とARG:1が近親関係にあるなら1を返す
;ARG:2が0なら仲間キャラ、1ならそれ以外
@INCEST_F(ARG:0, ARG:1, ARG:2 = 0)
#FUNCTION
IF ARG:2 == 0
	SIF GETBIT(RELATION:(ARG:0):(ARG:1), 의리의)
		RETURNF 0
	SIF GETBIT(RELATION:(ARG:0):(ARG:1), 부모자식) || GETBIT(RELATION:(ARG:0):(ARG:1), 형제자매) || GETBIT(RELATION:(ARG:0):(ARG:1), 조부모손주) || GETBIT(RELATION:(ARG:0):(ARG:1), 아저씨아줌마) || GETBIT(RELATION:(ARG:0):(ARG:1), 조카조카딸)
		RETURNF 1
ELSE
	SIF CFLAG:(ARG:0):9 >= 200
		RETURNF 0
	IF ARG:1 == CFLAG:(ARG:0):9
		RETURNF 1
	ENDIF
ENDIF
RETURNF 0



;--------------------------------------------------
;恋愛判定
;ARG:0にとってARG:1番目が사랑하는相手なら1を返す
@LOVER_F, ARG, ARG:1
#FUNCTION
SIF (GETBIT(RELATION:(ARG:0):(ARG:1),짝사랑) || GETBIT(RELATION:(ARG:0):(ARG:1),연인) || GETBIT(RELATION:(ARG:0):(ARG:1),약혼자) || GETBIT(RELATION:(ARG:0):(ARG:1),배우자))
	RETURNF 1
RETURNF 0

