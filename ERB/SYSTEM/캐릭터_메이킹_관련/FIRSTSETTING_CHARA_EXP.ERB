
;-------------------------------------------------------------------------------------------------------------------------------------------------------------------
;初期経験の設定
@FIRSTSETTING_CHARA_EXP, ARG
#DIM LCOUNT
#DIM OPTION,4
#DIM SEX_NUM

#DIMS 特殊判定,1


VARSET LOCAL
VARSET OPTION
CALL LB
LCOUNT = LINECOUNT
$INPUT_LOOP
PRINTFORML ●{ARG}人目のキャラ 『%NAME:ARG%』 の環境と初期経験を決定します
DRAWLINE

PRINTL 素質：
PRINT 　
SIF TALENT:ARG:처녀 == 1
	PRINT [처녀]
SIF TALENT:ARG:처녀 == 2
	PRINT [聖처녀]
SIF TALENT:ARG:초심 == 1
	PRINT [초심]
SIF ISMALE(ARG)
	PRINT [남자]
SIF TALENT:ARG:후타나리 > 0
	PRINT [후타나리]
SIF TALENT:ARG:인조인간 > 0 && TALENT:ARG:미성숙 != 2
	PRINT [人工子宮]
SIF TALENT:ARG:청순파 > 0
	PRINT [청순파]
SIF TALENT:ARG:미성숙 == 1
	PRINT [미성숙]
SIF TALENT:ARG:미성숙 == 2
	PRINT [不妊]
SIF TALENT:ARG:교제상대 == 1
	PRINT [짝사랑]
SIF TALENT:ARG:교제상대 == 2
	PRINT [彼氏持ち]
SIF TALENT:ARG:교제상대 == 3
	PRINT [婚約]
SIF TALENT:ARG:교제상대 == 4
	PRINT [人妻]
SIF TALENT:ARG:교제상대 == 5
	PRINT [未亡人]
SIF TALENT:ARG:학생 == 1
	PRINT [小학생]
SIF TALENT:ARG:학생 == 2
	PRINT [中학생]
SIF TALENT:ARG:학생 == 3
	PRINT [高校生]
SIF TALENT:ARG:학생 == 4
	PRINT [大학생]
PRINTL 

PRINT 　
SIF TALENT:ARG:내성적 > 0
	PRINT [내성적]
SIF TALENT:ARG:제멋대로굼 > 0
	PRINT [제멋대로굼]
SIF TALENT:ARG:헌신적 > 0
	PRINT [헌신적]
SIF TALENT:ARG:소심함 > 0
	PRINT [소심함]
SIF TALENT:ARG:자존심높음 > 0
	PRINT [자존심높음]
SIF TALENT:ARG:보수적 > 0
	PRINT [보수적]
SIF TALENT:ARG:호기심 > 0
	PRINT [호기심]
SIF TALENT:ARG:새드기질 > 0
	PRINT [새드기질]
SIF TALENT:ARG:마조기질 > 0
	PRINT [마조기질]
SIF TALENT:ARG:쾌감에솔직 > 0
	PRINT [쾌감에솔직]
SIF TALENT:ARG:쾌감을부정 > 0
	PRINT [快楽に否定]
SIF TALENT:ARG:전투거부 > 0
	PRINT [전투거부]
SIF TALENT:ARG:싸움꾼 > 0
	PRINT [싸움꾼]
SIF TALENT:ARG:수줍음 > 0
	PRINT [수줍음]
SIF TALENT:ARG:배짱 > 0
	PRINT [배짱]
SIF TALENT:ARG:인간불신 > 0
	PRINT [인간불신]
SIF TALENT:ARG:양도 > 0
	PRINT [양도]
SIF TALENT:ARG:남성기피 > 0
	PRINT [남성기피]
SIF TALENT:ARG:여성기피 > 0
	PRINT [여성기피]
SIF TALENT:ARG:모성적 > 0
	PRINT [모성적]
SIF TALENT:ARG:소악마 > 0
	PRINT [소악마]
SIF TALENT:ARG:눈에띄고싶어함 > 0
	PRINT [눈에띄고싶어함]
SIF TALENT:ARG:고상함 > 0
	PRINT [고상함]
SIF TALENT:ARG:울보 > 0
	PRINT [울보]
PRINTL 

DRAWLINE

PRINT 청순파：
IF ISFEMALE(ARG)
	PRINTPLAIN 　　　　　　　　　　　　　　　　　　
	PRINT 처녀：
ENDIF
PRINTL 
SETCOLOR 120,255,255
SIF TALENT:ARG:청순파 != 1
	SETCOLOR 105,105,105
PRINT 　[0] あり　　　　　　
SETCOLOR 120,255,255
SIF TALENT:ARG:청순파 != 0
	SETCOLOR 105,105,105
PRINT 　[1] なし　　　　　　
IF ISFEMALE(ARG)
	RESETCOLOR
	SETCOLOR 120,255,255
	SIF TALENT:ARG:처녀 != 1
		SETCOLOR 105,105,105
	PRINT 　[2] 처녀　　　　　　
	SETCOLOR 120,255,255
	IF TALENT:ARG:처녀 != 2
		SETCOLOR 105,105,105
	ELSE
		SETCOLOR 255, 127, 255
	ENDIF
	PRINT 　[3] 聖처녀　　　　　
	SETCOLOR 120,255,255
	SIF TALENT:ARG:처녀 != 0
		SETCOLOR 105,105,105
	PRINT 　[4] 非처녀　　　
ENDIF
RESETCOLOR
PRINTL  
PRINTL 

PRINTL 通学状況:
IF TALENT:ARG:학생 > 0
	SETCOLOR 105,105,105
	SIF CFLAG:ARG:358 == 0
		SETCOLOR 120,255,255
		PRINT 　[10]郊外の学校に　　
	RESETCOLOR
	SETCOLOR 105,105,105
	SIF CFLAG:ARG:358 == 1
		SETCOLOR 120,255,255
		PRINT 　[11]都心の学校に　　
	RESETCOLOR
	SETCOLOR 105,105,105
	SIF CFLAG:ARG:359 == 0
		SETCOLOR 120,255,255
		PRINT 　[12]通っている　　　
	RESETCOLOR
	SETCOLOR 105,105,105
	SIF CFLAG:ARG:359 == 1
		SETCOLOR 120,255,255
		PRINT 　[13]転校してきた　
	RESETCOLOR
ENDIF
PRINTL 
SETCOLOR 105,105,105
SIF TALENT:ARG:학생 == 1
	SETCOLOR 120,255,255
	PRINT 　[20]小학생　　　　　
SETCOLOR 105,105,105
SIF TALENT:ARG:학생 == 2
	SETCOLOR 120,255,255
	PRINT 　[21]中학생　　　　　
SETCOLOR 105,105,105
SIF TALENT:ARG:학생 == 3
	SETCOLOR 120,255,255
	PRINT 　[22]高校生　　　　　
SETCOLOR 105,105,105
SIF TALENT:ARG:학생 == 4
	SETCOLOR 120,255,255
	PRINT 　[23]大학생　　　　　
SETCOLOR 105,105,105
SIF TALENT:ARG:학생 <= 0 || TALENT:ARG:학생>=5
	SETCOLOR 120,255,255
	PRINT 　[24]なし
RESETCOLOR
PRINTL
PRINTL 


PRINTL 가족관계:
SETCOLOR 105,105,105
SIF TALENT:ARG:가족관계 == 1
	SETCOLOR 120,255,255
	PRINT 　[30]弟持ち　　　　　
SETCOLOR 105,105,105
SIF TALENT:ARG:가족관계 == 2
	SETCOLOR 120,255,255
	PRINT 　[31]妹持ち　　　　　
SETCOLOR 105,105,105
SIF TALENT:ARG:가족관계 == 3
	SETCOLOR 120,255,255
	PRINT 　[32]兄持ち　　　　　
SETCOLOR 105,105,105
SIF TALENT:ARG:가족관계 == 4
	SETCOLOR 120,255,255
	PRINT 　[33]姉持ち　　　　　
SETCOLOR 105,105,105
PRINTL
IF TALENT:ARG:처녀 == 0
	SIF TALENT:ARG:가족관계 == 5
		SETCOLOR 120,255,255
		PRINT 　[34]幼い息子　　　　
	SETCOLOR 105,105,105
	SIF TALENT:ARG:가족관계 == 6
		SETCOLOR 120,255,255
		PRINT 　[35]幼い娘　　　　　
	SETCOLOR 105,105,105
	SIF TALENT:ARG:가족관계 == 7
		SETCOLOR 120,255,255
		PRINT 　[36]年頃の息子　　　
	SETCOLOR 105,105,105
	SIF TALENT:ARG:가족관계 == 8
		SETCOLOR 120,255,255
		PRINT 　[37]年頃の娘　　　　
	SETCOLOR 105,105,105
ELSE
	PRINT 　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　
ENDIF
SIF TALENT:ARG:가족관계 == 0
	SETCOLOR 120,255,255
	PRINT 　[38]なし
RESETCOLOR
PRINTL  
PRINTL  

PRINTL 교제상대:
SETCOLOR 105,105,105
SIF TALENT:ARG:교제상대 == 1
	SETCOLOR 120,255,255
	PRINT 　[40]짝사랑　　　　　
SETCOLOR 105,105,105
SIF TALENT:ARG:교제상대 == 2
	SETCOLOR 120,255,255
	PRINT 　[41]彼氏持ち　　　　
SETCOLOR 105,105,105
SIF TALENT:ARG:교제상대 == 3
	SETCOLOR 120,255,255
	PRINT 　[42]婚約　　　　　　
SETCOLOR 105,105,105
SIF TALENT:ARG:교제상대 == 4
	SETCOLOR 120,255,255
	PRINT 　[43]人妻　　　　　　
SETCOLOR 105,105,105
SIF TALENT:ARG:교제상대 == 5
	SETCOLOR 120,255,255
	PRINT 　[44]未亡人
PRINTL
SETCOLOR 105,105,105
SIF TALENT:ARG:교제상대 == 0
	SETCOLOR 120,255,255
	PRINT 　[45]なし
RESETCOLOR
PRINTL  

DRAWLINE

PRINTL 性交渉の経験：
SETCOLOR 120,255,255
SIF OPTION:0 != 0
	SETCOLOR 105,105,105
PRINT 　[50]なし　　　　　　
SETCOLOR 120,255,255
SIF OPTION:0 != 1
	SETCOLOR 105,105,105
PRINT 　[51]少ない　　　　　
SETCOLOR 120,255,255
SIF OPTION:0 != 2
	SETCOLOR 105,105,105
PRINT 　[52]やや少ない　　　
IF TALENT:ARG:청순파 == 0
	SETCOLOR 120,255,255
	SIF OPTION:0 != 3
		SETCOLOR 105,105,105
	PRINT 　[53]多い　　　　　　
	SETCOLOR 120,255,255
	SIF OPTION:0 != 4
		SETCOLOR 105,105,105
	PRINT 　[54]かなり多い
ENDIF
RESETCOLOR
PRINTL  
PRINTL 

PRINTL 生活環境：
SETCOLOR 120,255,255
SIF OPTION:1 != 0
	SETCOLOR 105,105,105
PRINT 　[60]優遇　　　　　　
SETCOLOR 120,255,255
SIF OPTION:1 != 1
	SETCOLOR 105,105,105
PRINT 　[61]一般的　　　　　
SETCOLOR 120,255,255
SIF OPTION:1 != 2
	SETCOLOR 105,105,105
PRINT 　[62]劣悪　　　　　　
IF TALENT:ARG:청순파 == 0
	SETCOLOR 120,255,255
	SIF OPTION:1 != 3
		SETCOLOR 105,105,105
	PRINT 　[63]悲惨
ENDIF
RESETCOLOR
PRINTL 
PRINTL 

PRINTL 売春経験：
SETCOLOR 120,255,255
SIF OPTION:2 != 0
	SETCOLOR 105,105,105
PRINT 　[70]なし　　　　　　
IF TALENT:ARG:청순파 == 0
	SETCOLOR 120,255,255
	SIF OPTION:2 != 1
		SETCOLOR 105,105,105
	PRINT 　[71]あり
ENDIF
RESETCOLOR
PRINTL 
PRINTL 

IF ISFEMALE(ARG)
	PRINTL 출산경험：
	SETCOLOR 120,255,255
	SIF OPTION:3 != 0
		SETCOLOR 105,105,105
	PRINT 　[80]なし　　　　　　
	IF TALENT:ARG:처녀 == 0 && TALENT:ARG:미성숙 == 0
		SETCOLOR 120,255,255
		SIF OPTION:3 != 1
			SETCOLOR 105,105,105
		PRINT 　[81]少ない　　　　　
		IF TALENT:ARG:청순파 == 0
			SETCOLOR 120,255,255
			SIF OPTION:3 != 2
				SETCOLOR 105,105,105
			PRINT 　[82]多い
		ENDIF
	ENDIF
	RESETCOLOR
	PRINTL 
	PRINTL 
ELSE
	PRINTL 
ENDIF


DRAWLINE
PRINT 経験：　　
CALL FIRSTSETTING_PRINT_EXP, ARG
PRINTL 
DRAWLINE

IF 特殊判定!=""
	PRINTFORML 特殊判定：　%特殊判定%
ELSE
	PRINTL 特殊判定：
ENDIF

DRAWLINE
PRINTL [100]上記の条件でリロール
PRINTL [200]リセットする
PRINTL [999]決定
INPUT
IF RESULT == 0
	IF TALENT:ARG:청순파 == 0
		TALENT:ARG:청순파 = 1
		SIF OPTION:0 >= 3
			OPTION:0 = 2
		SIF OPTION:2 >= 1
			OPTION:2 = 0
		SIF OPTION:3 == 2 && TALENT:ARG:교제상대 >= 4
			OPTION:3 = 1
		SIF TALENT:ARG:교제상대 < 4
			OPTION:3 = 0
	ENDIF
	CLEARLINE LINECOUNT - LCOUNT
	GOTO INPUT_LOOP
ELSEIF RESULT == 1 && ISFEMALE(ARG)
	TALENT:ARG:청순파 = 0
	CLEARLINE LINECOUNT - LCOUNT
	GOTO INPUT_LOOP
ELSEIF RESULT == 2 && ISFEMALE(ARG)
	IF TALENT:ARG:처녀 == 0 || TALENT:ARG:처녀 == 2
		TALENT:ARG:처녀 = 1
		;처녀が出産済みなわけねえだろ필터
		SIF OPTION:3 > 0
			OPTION:3 = 0
		;처녀なら実子もいない(★養子は考慮されていない)
		SIF TALENT:ARG:가족관계 > 5
			TALENT:ARG:가족관계 = 0
	ENDIF
	CLEARLINE LINECOUNT - LCOUNT
	GOTO INPUT_LOOP
ELSEIF RESULT == 3 && ISFEMALE(ARG)
	IF TALENT:ARG:처녀 < 2
		TALENT:ARG:처녀 = 2
		;聖처녀は当然出産してないよ필터
		SIF OPTION:3 > 0
			OPTION:3 = 0
		;처녀なら実子もいない(★養子は考慮されていない)
		SIF TALENT:ARG:가족관계 > 5
			TALENT:ARG:가족관계 = 0
	ENDIF
	CLEARLINE LINECOUNT - LCOUNT
	GOTO INPUT_LOOP
ELSEIF RESULT == 4
	TALENT:ARG:처녀 = 0
	CLEARLINE LINECOUNT - LCOUNT
	GOTO INPUT_LOOP

ELSEIF RESULT >= 10 && RESULT <=19 && TALENT:ARG:학생 > 0
	IF RESULT == 10
		CFLAG:ARG:358=0
	ELSEIF RESULT == 11
		CFLAG:ARG:358=1
	ELSEIF RESULT == 12
		CFLAG:ARG:359=0
	ELSEIF RESULT == 13
		CFLAG:ARG:359=1
	ENDIF
	CLEARLINE LINECOUNT - LCOUNT
	GOTO INPUT_LOOP
ELSEIF RESULT >= 20 && RESULT <=29
	IF RESULT == 20
		TALENT:ARG:학생 = 1
		SIF CFLAG:ARG:358==0
			CFLAG:ARG:358=RAND:2
		SIF CFLAG:ARG:359==0
			CFLAG:ARG:359=RAND:2
		;倫理필터(婚姻制限)
		;SIF TALENT:ARG:교제상대 > 3
		;	TALENT:ARG:교제상대 = 0
	ELSEIF RESULT == 21
		TALENT:ARG:학생 = 2
		SIF CFLAG:ARG:358==0
			CFLAG:ARG:358=RAND:2
		SIF CFLAG:ARG:359==0
			CFLAG:ARG:359=RAND:2
		;倫理필터(婚姻制限)
		;SIF TALENT:ARG:교제상대 > 3
		;	TALENT:ARG:교제상대 = 0
	ELSEIF RESULT == 22
		TALENT:ARG:학생 = 3
		SIF CFLAG:ARG:358==0
			CFLAG:ARG:358=RAND:2
		SIF CFLAG:ARG:359==0
			CFLAG:ARG:359=RAND:2
	ELSEIF RESULT == 23
		TALENT:ARG:학생 = 4
		SIF CFLAG:ARG:358==0
			CFLAG:ARG:358=RAND:2
		SIF CFLAG:ARG:359==0
			CFLAG:ARG:359=RAND:2
	ELSEIF RESULT == 24
		TALENT:ARG:학생 = 0
		CFLAG:ARG:358 = 0
		CFLAG:ARG:359 = 0
	ENDIF
	CLEARLINE LINECOUNT - LCOUNT
	GOTO INPUT_LOOP

ELSEIF RESULT >= 30 && RESULT <= 39
	IF RESULT >= 30 && RESULT <= 37
		TALENT:ARG:가족관계 = RESULT-29
		;子供がいるなら出産は経験済み　★養子は考慮されていない
		SIF TALENT:ARG:가족관계 >= 5
			OPTION:3=MAX(OPTION:3,1)
	ELSE
		TALENT:ARG:가족관계 = 0
	ENDIF
	CLEARLINE LINECOUNT - LCOUNT
	GOTO INPUT_LOOP
ELSEIF RESULT >= 40 && RESULT <= 49
	;짝사랑
	IF RESULT==40
		TALENT:ARG:교제상대 = 1
	ELSEIF RESULT==41
		;男は彼氏持ちにならない(とりあえず)
		IF ISMALE(ARG)
			TALENT:ARG:교제상대 = 3
		ELSE
			TALENT:ARG:교제상대 = 2
		ENDIF
	;婚約
	ELSEIF RESULT==42
		TALENT:ARG:교제상대 = 3
	;人妻
	ELSEIF RESULT==43
		;男は人妻にならない(とりあえず)
		IF ISMALE(ARG)
			TALENT:ARG:교제상대 = 0
		ELSE
			TALENT:ARG:교제상대 = 4
		ENDIF
	;未亡人
	ELSEIF RESULT==44
		TALENT:ARG:교제상대 = 5
	;なし
	ELSE
		TALENT:ARG:교제상대 = 0
	ENDIF

	;倫理필터(小中학생の婚姻制限)
	;IF TALENT:ARG:교제상대 >= 4 && (TALENT:ARG:학생 == 1 || TALENT:ARG:학생 == 2)
	;	TALENT:ARG:학생 = 3
	;ENDIF
	CLEARLINE LINECOUNT - LCOUNT
	GOTO INPUT_LOOP
ELSEIF RESULT >= 50 && RESULT < 53
	OPTION:0 = RESULT % 10
	SIF OPTION:0 == 0
		OPTION:3 = 0
	CLEARLINE LINECOUNT - LCOUNT
	GOTO INPUT_LOOP
ELSEIF RESULT >= 53 && RESULT < 55 && TALENT:ARG:청순파 == 0
	OPTION:0 = RESULT % 10
	CLEARLINE LINECOUNT - LCOUNT
	GOTO INPUT_LOOP
ELSEIF (RESULT >= 60 && RESULT < 63) || (RESULT == 63 && TALENT:ARG:청순파 == 0)
	OPTION:1 = RESULT % 10
	CLEARLINE LINECOUNT - LCOUNT
	GOTO INPUT_LOOP
ELSEIF RESULT == 70
	OPTION:2 = RESULT % 10
	CLEARLINE LINECOUNT - LCOUNT
	GOTO INPUT_LOOP
ELSEIF RESULT >= 71 && RESULT < 72 && TALENT:ARG:청순파 == 0
	OPTION:2 = RESULT % 10
	CLEARLINE LINECOUNT - LCOUNT
	GOTO INPUT_LOOP
ELSEIF RESULT == 80
	OPTION:3 = RESULT % 10
	;★養子は考慮されていない
	SIF TALENT:ARG:가족관계 >= 5
		TALENT:ARG:가족관계 = 0
	CLEARLINE LINECOUNT - LCOUNT
	GOTO INPUT_LOOP
ELSEIF RESULT == 81 && ISFEMALE(ARG) && TALENT:ARG:미성숙 == 0 && TALENT:ARG:처녀 == 0
	OPTION:3 = RESULT % 10
	SIF OPTION:0 < 1
		OPTION:0 = 1
	CLEARLINE LINECOUNT - LCOUNT
	GOTO INPUT_LOOP
ELSEIF RESULT == 82 && TALENT:ARG:청순파 == 0 && ISFEMALE(ARG) && TALENT:ARG:미성숙 == 0 && TALENT:ARG:처녀 == 0
	OPTION:3 = RESULT % 10
	SIF OPTION:0 < 1
		OPTION:0 = 1
	CLEARLINE LINECOUNT - LCOUNT
	GOTO INPUT_LOOP
;リロール
ELSEIF RESULT == 100
	特殊判定=
	;与えられた条件から初期経験を生成
	SEX_NUM = 0
	;経験を全てリセット
	FOR LOCAL, 0, 99
		EXP:ARG:LOCAL = 0
	NEXT

	;●자위경험
	;性欲の強さをみる
	LOCAL = RAND:8
	SIF BASE:ARG:실제나이 > 8
		LOCAL += RAND:2
	SIF BASE:ARG:실제나이 > 12
		LOCAL += RAND:2
	SIF BASE:ARG:실제나이 > 16
		LOCAL += RAND:2
	SIF BASE:ARG:실제나이 > 20
		LOCAL += RAND:2
	SIF TALENT:ARG:학생 == 1
		LOCAL = LOCAL / 2
	SIF TALENT:ARG:학생 == 2
		LOCAL = LOCAL * 2 / 3
	SIF TALENT:ARG:쾌감에솔직 > 0
		LOCAL += 2 + RAND:2
	SIF TALENT:ARG:쾌감을부정 > 0
		LOCAL -= 2 + RAND:2
	SIF TALENT:ARG:청순파 > 0
		LOCAL -= 2 + RAND:2
	SIF TALENT:ARG:보수적 > 0
		LOCAL = LOCAL * 2 / 3
	SIF TALENT:ARG:호기심 > 0
		LOCAL = LOCAL * 3 / 2
	IF LOCAL > 0
		SEX_NUM = LOCAL
		FOR LOCAL, 0, SEX_NUM
			EXP:ARG:자위경험 += 1
			IF RAND:4 != 0
				SIF TALENT:ARG:미성숙 != 1 && (ISMALE(ARG) || TALENT:ARG:후타나리 > 0)
					EXP:ARG:사정경험 += 1
			ENDIF
		NEXT
	ENDIF
	SEX_NUM = 0

	;●촉수被害の経験
	LOCAL = 0
	;生活環境が悲惨だった場合
	IF ISFEMALE(ARG) && OPTION:1 == 3
		EXP:ARG:피간경험 += 1
		SEX_NUM += 6 + RAND:8
		IF RAND:2 == 0
			EXP:ARG:피간경험 += 1+RAND:6
			SEX_NUM += 1+RAND:6
		ENDIF
		IF RAND:2 == 0
			EXP:ARG:피간경험 += 1+RAND:6
			SEX_NUM += 1+RAND:6
		ENDIF
		IF RAND:2 == 0
			EXP:ARG:유폐경험 += 1+RAND:3
			SEX_NUM += +RAND:20
		ENDIF
	;劣悪ではなく처녀なら襲われている確率が低い
	ELSEIF OPTION:1 < 2 && TALENT:ARG:처녀 > 0 && RAND:2 == 0
		;セーフ
	;生活環境が劣悪だった場合
	ELSEIF ISFEMALE(ARG) && OPTION:1 == 2
		EXP:ARG:피간경험 += 1
		SEX_NUM += 3 + RAND:4
		IF RAND:2 == 0
			EXP:ARG:피간경험 += 1
			SEX_NUM += 1
		ENDIF
		IF RAND:2 == 0
			EXP:ARG:피간경험 += 1
			SEX_NUM += 1
		ENDIF
		IF RAND:4 == 0
			EXP:ARG:유폐경험 += 1
			SEX_NUM += 3
		ENDIF
	;生活環境が普通だった場合
	ELSEIF ISFEMALE(ARG) && OPTION:1 == 1 && RAND:3 == 0
		EXP:ARG:피간경험 += 1
		SEX_NUM += 1
		IF RAND:8 == 0
			EXP:ARG:유폐경험 += 1
			SEX_NUM += 3
		ENDIF
	;生活環境が優遇なら촉수被害は受けていない
	ENDIF
	;総じて촉수被害者だった場合はテキトーに経験を加算
	IF SEX_NUM > 0
		FOR LOCAL, 0, SEX_NUM+3*EXP:ARG:유폐경험
			IF RAND:10 == 0 && TALENT:ARG:처녀 == 0
				EXP:ARG:V경험 += 2
				EXP:ARG:V확장경험 += 1
				;출산경험
				IF RAND:4 != 0
					IF TALENT:ARG:처녀 == 0 && TALENT:ARG:미성숙 == 0
						IF TALENT:ARG:모유체질 > 0
							EXP:ARG:출산경험 += 2 + RAND:4
						ELSEIF RAND:4 == 0
							EXP:ARG:출산경험 += 1 + RAND:3
						ENDIF
					ENDIF
				ENDIF
			ELSEIF RAND:9 == 0
				EXP:ARG:A경험 += 2
				EXP:ARG:A확장경험 += 1
			ELSEIF RAND:3 == 0 && TALENT:ARG:처녀 == 0
				EXP:ARG:V경험 += 1
				;출산경험
				IF RAND:4 != 0
					IF TALENT:ARG:처녀 == 0 && TALENT:ARG:미성숙 == 0
						IF TALENT:ARG:모유체질 > 0
							EXP:ARG:출산경험 += 2 + RAND:4
						ELSEIF RAND:4 == 0
							EXP:ARG:출산경험 += 1 + RAND:3
						ENDIF
					ENDIF
				ENDIF
			ELSEIF RAND:2 == 0
				EXP:ARG:A경험 += 1
			ELSE
				EXP:ARG:펠라경험 += 1
			ENDIF
			IF RAND:4 == 0
				SIF TALENT:ARG:모유체질 > 0 && RAND:2 == 0
					EXP:ARG:모유경험 += 1
			ENDIF
		NEXT

		IF EXP:ARG:유폐경험>1 && TALENT:ARG:처녀 == 0
			特殊判定'=特殊判定+"촉수の苗床にされたことがある　"
		ELSEIF EXP:ARG:유폐경험>0
			特殊判定'=特殊判定+"触巣に連れ去られたことがある　"
		ELSE
			特殊判定'=特殊判定+"촉수に襲われたことがある　"
		ENDIF
	ENDIF
	SEX_NUM = 0

	;●私生活での性交渉
	LOCAL = 0
	;経験回数が少ない
	IF OPTION:0 == 1 && RAND:2 == 0
		LOCAL = 1 + RAND:3
		;売春経験が「あり」なら
		SIF OPTION:2 == 1 && RAND:2 == 0
			LOCAL += 1
	;経験回数がやや少ない
	ELSEIF OPTION:0 == 2 && RAND:2 == 0
		LOCAL = 2 + RAND:6
		;売春経験が「あり」なら
		SIF OPTION:2 == 1 && RAND:3 != 0
			LOCAL += 2
	;経験回数が多い
	ELSEIF OPTION:0 == 3
		LOCAL = 4 + RAND:12
		;売春経験が「あり」なら
		SIF OPTION:2 == 1 && RAND:4 != 0
			LOCAL += 4
	;経験回数がかなり多い
	ELSEIF OPTION:0 == 4
		LOCAL = 8 + RAND:24
		SIF RAND:10 == 0
			LOCAL = LOCAL * 3 / 2
		;売春経験が「あり」なら
		SIF OPTION:2 == 1 && RAND:5 != 0
			LOCAL += 8
	ENDIF
	;経験回数が「なし」以外なら経験補正値を決定
	IF OPTION:0 != 0
		;교제상대
		;彼氏
		SIF TALENT:ARG:교제상대 == 2
			LOCAL += RAND:3
		;약혼자
		SIF TALENT:ARG:교제상대 == 3
			LOCAL += RAND:6
		;人妻
		SIF TALENT:ARG:교제상대 == 4 || TALENT:ARG:교제상대 == 5
			LOCAL += RAND:12
		;環境が劣悪ならレイプ被害を含む
		IF (OPTION:1 == 2 && RAND:4 == 0) || (OPTION:1 == 3 && RAND:2 == 0) 
			;通常のレイプ
			IF RAND:4
				LOCAL += 3 + RAND:6
				特殊判定'=特殊判定+"レイプされたことがある　"
			;もっと悲惨な経験
			ELSE
				LOCAL += 12 + RAND:14
				STRDATA LOCALS
				DATAFORM 輪姦されたことがある
				DATAFORM 誘拐されたことがある
				DATAFORM 監禁されたことがある
				DATAFORM ストーカーに襲われたことがある
				DATAFORM ホームレスに犯されたことがある
				ENDDATA
				特殊判定'=特殊判定+LOCALS+"　"
			ENDIF
		;「優遇」以外なら何かしらの性経験(フレーバー)を足す
		ELSEIF OPTION:1 > 0 && RAND:6==0
				LOCAL += 5 + RAND:7
				STRDATA LOCALS
				DATAFORM 痴漢被害に悩まされている
				DATAFORM セクハラに悩まされている
				ENDDATA
				特殊判定'=特殊判定+LOCALS+"　"
		ENDIF
	ENDIF

	;売春経験が「あり」なら追加の経験補正
	SIF OPTION:2 == 1 && RAND:5 != 0
		LOCAL += 1 + RAND:3
	;その他の補正
	SIF TALENT:ARG:보수적 > 0
		LOCAL = LOCAL * 2 / 3
	SIF TALENT:ARG:호기심 > 0
		LOCAL = LOCAL * 3 / 2
	SIF TALENT:ARG:청순파
		LOCAL = LOCAL / 2
	SIF TALENT:ARG:청순파 && TALENT:ARG:교제상대 == 3
		LOCAL = LOCAL * 2 / 3
	SIF TALENT:ARG:학생 == 1
		LOCAL = LOCAL / 2
	SIF TALENT:ARG:학생 == 2
		LOCAL = LOCAL * 2 / 3
	;출산경험ありなら追加の経験補正
	IF OPTION:3 == 1
		LOCAL += 1 + RAND:6
	ELSEIF OPTION:3 == 2
		LOCAL += 2 + RAND:12
	ENDIF

	;総じて対人性交渉の経験ありだったらEXPをテキトーに加算
	IF LOCAL > 0
		SEX_NUM = LOCAL
		FOR LOCAL, 0, SEX_NUM
			IF ISMALE(ARG)
				SIF RAND:20 == 0
					EXP:ARG:A경험 += 1
				IF RAND:4 != 0
					SIF TALENT:ARG:미성숙 != 1
						EXP:ARG:사정경험 += 1
				ENDIF
			ELSE
				IF OPTION:0 == 0 && OPTION:2 == 2
					EXP:ARG:펠라경험 += 1
				ELSEIF OPTION:3 == 2 && EXP:ARG:V경험 == 0
					EXP:ARG:V경험 += 2
					IF RAND:6 != 0
						SIF TALENT:ARG:미성숙 != 1 && TALENT:ARG:후타나리 > 0
							EXP:ARG:사정경험 += 1
						SIF TALENT:ARG:모유체질 > 0 && RAND:2 == 0
							EXP:ARG:모유경험 += 1
					ENDIF	
				ELSEIF OPTION:3 == 1 && EXP:ARG:V경험 == 0
					EXP:ARG:V경험 += 1
					IF RAND:4 != 0
						SIF TALENT:ARG:미성숙 != 1 && TALENT:ARG:후타나리 > 0
							EXP:ARG:사정경험 += 1
						SIF TALENT:ARG:모유체질 > 0 && RAND:2 == 0
							EXP:ARG:모유경험 += 1
					ENDIF					
				ELSEIF RAND:10 == 0
					EXP:ARG:이상경험 += 1
					IF RAND:3 == 0 && TALENT:ARG:처녀 == 0
						EXP:ARG:V확장경험 += 1
					ELSEIF RAND:2 == 0
						EXP:ARG:A확장경험 += 1
					ELSE
						EXP:ARG:방뇨경험 += 1
					ENDIF
				ELSEIF RAND:3 == 0 && TALENT:ARG:처녀 == 0
					EXP:ARG:V경험 += 1
					IF RAND:4 != 0
						SIF TALENT:ARG:미성숙 != 1 && TALENT:ARG:후타나리 > 0
							EXP:ARG:사정경험 += 1
						SIF TALENT:ARG:모유체질 > 0 && RAND:2 == 0
							EXP:ARG:모유경험 += 1
					ENDIF
				ELSEIF RAND:2 == 0
					EXP:ARG:A경험 += 1
					IF RAND:4 != 0
						SIF TALENT:ARG:미성숙 != 1 && TALENT:ARG:후타나리 > 0
							EXP:ARG:사정경험 += 1
						SIF TALENT:ARG:모유체질 > 0 && RAND:2 == 0
							EXP:ARG:모유경험 += 1
					ENDIF
				ELSE
					EXP:ARG:펠라경험 += 1
				ENDIF
				SIF RAND:4 == 0 && TALENT:ARG:마조기질 > 0
					EXP:ARG:고통쾌락경험 += 1
				SIF RAND:2 == 0 && TALENT:ARG:헌신적 > 0
					EXP:ARG:봉사쾌락경험 += 1
			ENDIF
		NEXT
		;출산경험
		IF OPTION:3 == 1 && EXP:ARG:V경험 > 0
			EXP:ARG:출산경험 += 1
			SIF RAND:10 == 0 && EXP:ARG:V경험 >= 3
				EXP:ARG:출산경험 += 1
		ELSEIF OPTION:3 == 2 && EXP:ARG:V경험 > 0
			EXP:ARG:출산경험 += 1
			SIF EXP:ARG:V경험 >= 2
				EXP:ARG:출산경험 += 1
			SIF RAND:10 == 0 && EXP:ARG:V경험 >= 5
				EXP:ARG:출산경험 += 1
			SIF RAND:10 == 0 && EXP:ARG:V경험 >= 7
				EXP:ARG:출산경험 += 1
			SIF RAND:20 == 0 && EXP:ARG:V경험 >= 8
				EXP:ARG:출산경험 += 1
			SIF RAND:20 == 0 && EXP:ARG:V경험 >= 9
				EXP:ARG:출산경험 += 1
		ENDIF
		;魅了
		SIF OPTION:2 == 1 && RAND:4 == 0
			EXP:ARG:매료경험 += 1 + RAND:3
		;근친상간
		LOCAL = 0
		IF TALENT:ARG:교제상대 == 0 && OPTION:2 == 0
			IF OPTION:1 == 2 && RAND:4 == 0
				LOCAL = 1
			ELSEIF OPTION:1 == 1 && RAND:8 == 0
				LOCAL = 1
			ELSEIF OPTION:1 == 0 && RAND:12 == 0
				LOCAL = 1
			ENDIF
			SIF TALENT:ARG:청순파 > 0 && RAND:2 == 0
				LOCAL = 0
		ENDIF
		SIF LOCAL > 0
			特殊判定'=特殊判定+"근친상간したことがある　"
		IF LOCAL > 0
			FOR LOCAL, 0, SEX_NUM
				;★근친교배경험は産んだ子촉수との交配回数にも使われている
				;　ここ、本来は근친상간経験に分ける方が良い
				SIF RAND:4 != 0
					EXP:ARG:근친교배경험 += 1
			NEXT
		ENDIF
	ENDIF
	SEX_NUM = 0

	CLEARLINE LINECOUNT - LCOUNT
	GOTO INPUT_LOOP
;初期化
ELSEIF RESULT == 200
	特殊判定=
	;経験を全てリセット
	FOR LOCAL, 0, 99
		EXP:ARG:LOCAL = 0
	NEXT

	TALENT:ARG:가족관계=0
	TALENT:ARG:교제상대=0
	;学校は나이に応じた自然な値に
	SELECTCASE BASE:ARG:나이
	CASE 6 TO 12
		TALENT:ARG:학생=1
		CFLAG:ARG:358=1+RAND:2
	CASE 13 TO 15
		TALENT:ARG:학생=2
		CFLAG:ARG:358=1+RAND:2
	CASE 16 TO 18
		TALENT:ARG:학생=3
		CFLAG:ARG:358=1+RAND:2
	CASE 19 TO 22
		TALENT:ARG:학생=4
		CFLAG:ARG:358=1+RAND:2
	CASEELSE
		TALENT:ARG:학생=0
		CFLAG:ARG:358=0
	ENDSELECT

	VARSET OPTION
	CLEARLINE LINECOUNT - LCOUNT
	GOTO INPUT_LOOP
;戻る
ELSEIF RESULT == 999
ELSE
	CLEARLINE LINECOUNT - LCOUNT
	GOTO INPUT_LOOP
ENDIF


@FIRSTSETTING_PRINT_EXP, ARG
FOR LOCAL, 0, 99
	SIF EXP:ARG:LOCAL > 0
		PRINTFORM 　%EXPNAME:LOCAL%({EXP:ARG:LOCAL}) 
	IF LOCAL == 39
		PRINTL 
		PRINT 　　　　　
	ENDIF
NEXT


