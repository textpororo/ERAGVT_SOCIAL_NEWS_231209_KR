
;-------------------------------------------------------------------------------------------------------------------------------------------------------------------
;초기 경험 설정
@FIRSTSETTING_CHARA_EXP, ARG
#DIM LCOUNT
#DIM OPTION,4
#DIM SEX_NUM

#DIMS 특수판정,1


VARSET LOCAL
VARSET OPTION
CALL LB
LCOUNT = LINECOUNT
$INPUT_LOOP
PRINTFORML ●{ARG}번째 캐릭터『%NAME:ARG%』의 환경과 초기 경험을 결정합니다.
DRAWLINE

PRINTL 소질：
PRINT 　
SIF TALENT:ARG:처녀 == 1
	PRINT [처녀]
SIF TALENT:ARG:처녀 == 2
	PRINT [성처녀]
SIF TALENT:ARG:초심 == 1
	PRINT [초심]
SIF ISMALE(ARG)
	PRINT [남자]
SIF TALENT:ARG:후타나리 > 0
	PRINT [후타나리]
SIF TALENT:ARG:인조인간 > 0 && TALENT:ARG:미성숙 != 2
	PRINT [인공자궁]
SIF TALENT:ARG:청순파 > 0
	PRINT [청순파]
SIF TALENT:ARG:미성숙 == 1
	PRINT [미성숙]
SIF TALENT:ARG:미성숙 == 2
	PRINT [불임]
SIF TALENT:ARG:교제상대 == 1
	PRINT [짝사랑]
SIF TALENT:ARG:교제상대 == 2
	PRINT [남친있음]
SIF TALENT:ARG:교제상대 == 3
	PRINT [약혼]
SIF TALENT:ARG:교제상대 == 4
	PRINT [유부녀]
SIF TALENT:ARG:교제상대 == 5
	PRINT [과부]
SIF TALENT:ARG:학생 == 1
	PRINT [초등학생]
SIF TALENT:ARG:학생 == 2
	PRINT [중학생]
SIF TALENT:ARG:학생 == 3
	PRINT [고등학생]
SIF TALENT:ARG:학생 == 4
	PRINT [대학생]
PRINTL 

PRINT 　
SIF TALENT:ARG:내성적 > 0
	PRINT [내성적]
SIF TALENT:ARG:제멋대로굼 > 0
	PRINT [제멋대로굼]
SIF TALENT:ARG:헌신적 > 0
	PRINT [헌신적]
SIF TALENT:ARG:소심함 > 0
	PRINT [소심함]
SIF TALENT:ARG:자존심높음 > 0
	PRINT [자존심높음]
SIF TALENT:ARG:보수적 > 0
	PRINT [보수적]
SIF TALENT:ARG:호기심 > 0
	PRINT [호기심]
SIF TALENT:ARG:새드기질 > 0
	PRINT [새드기질]
SIF TALENT:ARG:마조기질 > 0
	PRINT [마조기질]
SIF TALENT:ARG:쾌감에솔직 > 0
	PRINT [쾌감에솔직]
SIF TALENT:ARG:쾌감을부정 > 0
	PRINT [쾌감을부정]
SIF TALENT:ARG:전투거부 > 0
	PRINT [전투거부]
SIF TALENT:ARG:싸움꾼 > 0
	PRINT [싸움꾼]
SIF TALENT:ARG:수줍음 > 0
	PRINT [수줍음]
SIF TALENT:ARG:배짱 > 0
	PRINT [배짱]
SIF TALENT:ARG:인간불신 > 0
	PRINT [인간불신]
SIF TALENT:ARG:양도 > 0
	PRINT [양도]
SIF TALENT:ARG:남성기피 > 0
	PRINT [남성기피]
SIF TALENT:ARG:여성기피 > 0
	PRINT [여성기피]
SIF TALENT:ARG:모성적 > 0
	PRINT [모성적]
SIF TALENT:ARG:소악마 > 0
	PRINT [소악마]
SIF TALENT:ARG:눈에띄고싶어함 > 0
	PRINT [눈에띄고싶어함]
SIF TALENT:ARG:고상함 > 0
	PRINT [고상함]
SIF TALENT:ARG:울보 > 0
	PRINT [울보]
PRINTL 

DRAWLINE

PRINT 청순파：
IF ISFEMALE(ARG)
	PRINTPLAIN 　　　　　　　　　　　　　　　　　　
	PRINT 처녀：
ENDIF
PRINTL 
SETCOLOR 120,255,255
SIF TALENT:ARG:청순파 != 1
	SETCOLOR 105,105,105
PRINT 　[0] 있음　　　　　　
SETCOLOR 120,255,255
SIF TALENT:ARG:청순파 != 0
	SETCOLOR 105,105,105
PRINT 　[1] 없음　　　　　　
IF ISFEMALE(ARG)
	RESETCOLOR
	SETCOLOR 120,255,255
	SIF TALENT:ARG:처녀 != 1
		SETCOLOR 105,105,105
	PRINT 　[2] 처녀　　　　　　
	SETCOLOR 120,255,255
	IF TALENT:ARG:처녀 != 2
		SETCOLOR 105,105,105
	ELSE
		SETCOLOR 255, 127, 255
	ENDIF
	PRINT 　[3] 성처녀　　　　　
	SETCOLOR 120,255,255
	SIF TALENT:ARG:처녀 != 0
		SETCOLOR 105,105,105
	PRINT 　[4] 비처녀　　　
ENDIF
RESETCOLOR
PRINTL  
PRINTL 

PRINTL 통학 상황:
IF TALENT:ARG:학생 > 0
	SETCOLOR 105,105,105
	SIF CFLAG:ARG:358 == 0
		SETCOLOR 120,255,255
		PRINT 　[10] 교외의 학교　　
	RESETCOLOR
	SETCOLOR 105,105,105
	SIF CFLAG:ARG:358 == 1
		SETCOLOR 120,255,255
		PRINT 　[11] 도심의 학교　　
	RESETCOLOR
	SETCOLOR 105,105,105
	SIF CFLAG:ARG:359 == 0
		SETCOLOR 120,255,255
		;원문은 通っている
		PRINT 　[12] 재학 중　　　　
	RESETCOLOR
	SETCOLOR 105,105,105
	SIF CFLAG:ARG:359 == 1
		SETCOLOR 120,255,255
		PRINT 　[13] 전학생　　　 
	RESETCOLOR
ENDIF
PRINTL 
SETCOLOR 105,105,105
SIF TALENT:ARG:학생 == 1
	SETCOLOR 120,255,255
	PRINT 　[20] 초등학생　　　 
SETCOLOR 105,105,105
SIF TALENT:ARG:학생 == 2
	SETCOLOR 120,255,255
	PRINT 　[21] 중학생　　　　 
SETCOLOR 105,105,105
SIF TALENT:ARG:학생 == 3
	SETCOLOR 120,255,255
	PRINT 　[22] 고등학생　　　 
SETCOLOR 105,105,105
SIF TALENT:ARG:학생 == 4
	SETCOLOR 120,255,255
	PRINT 　[23] 대학생　　　　 
SETCOLOR 105,105,105
SIF TALENT:ARG:학생 <= 0 || TALENT:ARG:학생>=5
	SETCOLOR 120,255,255
	PRINT 　[24] 없음
RESETCOLOR
PRINTL
PRINTL 


PRINTL 가족관계:
SETCOLOR 105,105,105
SIF TALENT:ARG:가족관계 == 1
	SETCOLOR 120,255,255
	PRINT 　[30] 남동생o　　　　
SETCOLOR 105,105,105
SIF TALENT:ARG:가족관계 == 2
	SETCOLOR 120,255,255
	PRINT 　[31] 여동생o　　　　
SETCOLOR 105,105,105
SIF TALENT:ARG:가족관계 == 3
	SETCOLOR 120,255,255
	PRINT 　[32] 형/오빠o　　　 
SETCOLOR 105,105,105
SIF TALENT:ARG:가족관계 == 4
	SETCOLOR 120,255,255
	PRINT 　[33] 누나/언니o　　 
SETCOLOR 105,105,105
PRINTL
IF TALENT:ARG:처녀 == 0
	SIF TALENT:ARG:가족관계 == 5
		SETCOLOR 120,255,255
		PRINT 　[34] 어린 아들o　　 
	SETCOLOR 105,105,105
	SIF TALENT:ARG:가족관계 == 6
		SETCOLOR 120,255,255
		PRINT 　[35] 어린 딸o　　　 
	SETCOLOR 105,105,105
	SIF TALENT:ARG:가족관계 == 7
		SETCOLOR 120,255,255
		PRINT 　[36] 성인 아들o　　 
	SETCOLOR 105,105,105
	SIF TALENT:ARG:가족관계 == 8
		SETCOLOR 120,255,255
		PRINT 　[37] 성인 딸o　　　 
	SETCOLOR 105,105,105
ELSE
	PRINT 　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　
ENDIF
SIF TALENT:ARG:가족관계 == 0
	SETCOLOR 120,255,255
	PRINT 　[38] 없음
RESETCOLOR
PRINTL  
PRINTL  

PRINTL 교제상대:
SETCOLOR 105,105,105
SIF TALENT:ARG:교제상대 == 1
	SETCOLOR 120,255,255
	PRINT 　[40] 짝사랑　　　　 
SETCOLOR 105,105,105
SIF TALENT:ARG:교제상대 == 2
	SETCOLOR 120,255,255
	PRINT 　[41] 남친 있음　　　
SETCOLOR 105,105,105
SIF TALENT:ARG:교제상대 == 3
	SETCOLOR 120,255,255
	PRINT 　[42] 약혼　　　　　 
SETCOLOR 105,105,105
SIF TALENT:ARG:교제상대 == 4
	SETCOLOR 120,255,255
	PRINT 　[43] 유부녀　　　　 
SETCOLOR 105,105,105
SIF TALENT:ARG:교제상대 == 5
	SETCOLOR 120,255,255
	PRINT 　[44] 과부
PRINTL
SETCOLOR 105,105,105
SIF TALENT:ARG:교제상대 == 0
	SETCOLOR 120,255,255
	PRINT 　[45] 없음
RESETCOLOR
PRINTL  

DRAWLINE

PRINTL 성관계 경험：
SETCOLOR 120,255,255
SIF OPTION:0 != 0
	SETCOLOR 105,105,105
PRINT 　[50] 없음　　　　　 
SETCOLOR 120,255,255
SIF OPTION:0 != 1
	SETCOLOR 105,105,105
PRINT 　[51] 적음　　　　　 
SETCOLOR 120,255,255
SIF OPTION:0 != 2
	SETCOLOR 105,105,105
PRINT 　[52] 약간 적음　　　
IF TALENT:ARG:청순파 == 0
	SETCOLOR 120,255,255
	SIF OPTION:0 != 3
		SETCOLOR 105,105,105
	PRINT 　[53] 많음　　　　　 
	SETCOLOR 120,255,255
	SIF OPTION:0 != 4
		SETCOLOR 105,105,105
	PRINT 　[54] 아주 많음
ENDIF
RESETCOLOR
PRINTL  
PRINTL 

PRINTL 생활 환경：
SETCOLOR 120,255,255
SIF OPTION:1 != 0
	SETCOLOR 105,105,105
PRINT 　[60] 우대　　　　　 
SETCOLOR 120,255,255
SIF OPTION:1 != 1
	SETCOLOR 105,105,105
PRINT 　[61] 일반적　　　　 
SETCOLOR 120,255,255
SIF OPTION:1 != 2
	SETCOLOR 105,105,105
PRINT 　[62] 열악　　　　　 
IF TALENT:ARG:청순파 == 0
	SETCOLOR 120,255,255
	SIF OPTION:1 != 3
		SETCOLOR 105,105,105
	PRINT 　[63] 비참
ENDIF
RESETCOLOR
PRINTL 
PRINTL 

PRINTL 매춘 경험：
SETCOLOR 120,255,255
SIF OPTION:2 != 0
	SETCOLOR 105,105,105
PRINT 　[70] 없음　　　　　 
IF TALENT:ARG:청순파 == 0
	SETCOLOR 120,255,255
	SIF OPTION:2 != 1
		SETCOLOR 105,105,105
	PRINT 　[71] 있음
ENDIF
RESETCOLOR
PRINTL 
PRINTL 

IF ISFEMALE(ARG)
	PRINTL 출산경험：
	SETCOLOR 120,255,255
	SIF OPTION:3 != 0
		SETCOLOR 105,105,105
	PRINT 　[80] 없음　　　　　 
	IF TALENT:ARG:처녀 == 0 && TALENT:ARG:미성숙 == 0
		SETCOLOR 120,255,255
		SIF OPTION:3 != 1
			SETCOLOR 105,105,105
		PRINT 　[81] 적음　　　　　 
		IF TALENT:ARG:청순파 == 0
			SETCOLOR 120,255,255
			SIF OPTION:3 != 2
				SETCOLOR 105,105,105
			PRINT 　[82] 많음
		ENDIF
	ENDIF
	RESETCOLOR
	PRINTL 
	PRINTL 
ELSE
	PRINTL 
ENDIF


DRAWLINE
PRINT 경험：　　
CALL FIRSTSETTING_PRINT_EXP, ARG
PRINTL 
DRAWLINE

IF 특수판정!=""
	PRINTFORML 특수 판정：　%특수판정%
ELSE
	PRINTL 특수 판정：
ENDIF

DRAWLINE
PRINTL [100] 위의 조건으로 리롤한다
PRINTL [200] 초기화한다
PRINTL [999] 결정
INPUT
IF RESULT == 0
	IF TALENT:ARG:청순파 == 0
		TALENT:ARG:청순파 = 1
		SIF OPTION:0 >= 3
			OPTION:0 = 2
		SIF OPTION:2 >= 1
			OPTION:2 = 0
		SIF OPTION:3 == 2 && TALENT:ARG:교제상대 >= 4
			OPTION:3 = 1
		SIF TALENT:ARG:교제상대 < 4
			OPTION:3 = 0
	ENDIF
	CLEARLINE LINECOUNT - LCOUNT
	GOTO INPUT_LOOP
ELSEIF RESULT == 1 && ISFEMALE(ARG)
	TALENT:ARG:청순파 = 0
	CLEARLINE LINECOUNT - LCOUNT
	GOTO INPUT_LOOP
ELSEIF RESULT == 2 && ISFEMALE(ARG)
	IF TALENT:ARG:처녀 == 0 || TALENT:ARG:처녀 == 2
		TALENT:ARG:처녀 = 1
		;처녀가 출산할 리가 없잖아 필터
		SIF OPTION:3 > 0
			OPTION:3 = 0
		;처녀라면 친자도 없다(★양자는 고려하지 않았다)
		SIF TALENT:ARG:가족관계 > 5
			TALENT:ARG:가족관계 = 0
	ENDIF
	CLEARLINE LINECOUNT - LCOUNT
	GOTO INPUT_LOOP
ELSEIF RESULT == 3 && ISFEMALE(ARG)
	IF TALENT:ARG:처녀 < 2
		TALENT:ARG:처녀 = 2
		;성처녀는 당연히 출산하지 않았다고 필터
		SIF OPTION:3 > 0
			OPTION:3 = 0
		;처녀라면 친자도 없다(★양자는 고려하지 않았다)
		SIF TALENT:ARG:가족관계 > 5
			TALENT:ARG:가족관계 = 0
	ENDIF
	CLEARLINE LINECOUNT - LCOUNT
	GOTO INPUT_LOOP
ELSEIF RESULT == 4
	TALENT:ARG:처녀 = 0
	CLEARLINE LINECOUNT - LCOUNT
	GOTO INPUT_LOOP

ELSEIF RESULT >= 10 && RESULT <=19 && TALENT:ARG:학생 > 0
	IF RESULT == 10
		CFLAG:ARG:358=0
	ELSEIF RESULT == 11
		CFLAG:ARG:358=1
	ELSEIF RESULT == 12
		CFLAG:ARG:359=0
	ELSEIF RESULT == 13
		CFLAG:ARG:359=1
	ENDIF
	CLEARLINE LINECOUNT - LCOUNT
	GOTO INPUT_LOOP
ELSEIF RESULT >= 20 && RESULT <=29
	IF RESULT == 20
		TALENT:ARG:학생 = 1
		SIF CFLAG:ARG:358==0
			CFLAG:ARG:358=RAND:2
		SIF CFLAG:ARG:359==0
			CFLAG:ARG:359=RAND:2
		;윤리 필터(혼인 제한)
		;SIF TALENT:ARG:교제상대 > 3
		;	TALENT:ARG:교제상대 = 0
	ELSEIF RESULT == 21
		TALENT:ARG:학생 = 2
		SIF CFLAG:ARG:358==0
			CFLAG:ARG:358=RAND:2
		SIF CFLAG:ARG:359==0
			CFLAG:ARG:359=RAND:2
		;윤리 필터(혼인 제한)
		;SIF TALENT:ARG:교제상대 > 3
		;	TALENT:ARG:교제상대 = 0
	ELSEIF RESULT == 22
		TALENT:ARG:학생 = 3
		SIF CFLAG:ARG:358==0
			CFLAG:ARG:358=RAND:2
		SIF CFLAG:ARG:359==0
			CFLAG:ARG:359=RAND:2
	ELSEIF RESULT == 23
		TALENT:ARG:학생 = 4
		SIF CFLAG:ARG:358==0
			CFLAG:ARG:358=RAND:2
		SIF CFLAG:ARG:359==0
			CFLAG:ARG:359=RAND:2
	ELSEIF RESULT == 24
		TALENT:ARG:학생 = 0
		CFLAG:ARG:358 = 0
		CFLAG:ARG:359 = 0
	ENDIF
	CLEARLINE LINECOUNT - LCOUNT
	GOTO INPUT_LOOP

ELSEIF RESULT >= 30 && RESULT <= 39
	IF RESULT >= 30 && RESULT <= 37
		TALENT:ARG:가족관계 = RESULT-29
		;아이가 있다면 출산은 경험 완료　★양자는 고려하지 않았다
		SIF TALENT:ARG:가족관계 >= 5
			OPTION:3=MAX(OPTION:3,1)
	ELSE
		TALENT:ARG:가족관계 = 0
	ENDIF
	CLEARLINE LINECOUNT - LCOUNT
	GOTO INPUT_LOOP
ELSEIF RESULT >= 40 && RESULT <= 49
	;짝사랑
	IF RESULT==40
		TALENT:ARG:교제상대 = 1
	ELSEIF RESULT==41
		;남자는 남친있음이 되지 않는다(일단은...?)
		IF ISMALE(ARG)
			TALENT:ARG:교제상대 = 3
		ELSE
			TALENT:ARG:교제상대 = 2
		ENDIF
	;약혼
	ELSEIF RESULT==42
		TALENT:ARG:교제상대 = 3
	;유부녀
	ELSEIF RESULT==43
		;남자는 유부녀가 되지 않는다(일단은...?)
		IF ISMALE(ARG)
			TALENT:ARG:교제상대 = 0
		ELSE
			TALENT:ARG:교제상대 = 4
		ENDIF
	;과부
	ELSEIF RESULT==44
		TALENT:ARG:교제상대 = 5
	;없음
	ELSE
		TALENT:ARG:교제상대 = 0
	ENDIF

	;윤리 필터(초등, 중학생 혼인 제한)
	;IF TALENT:ARG:교제상대 >= 4 && (TALENT:ARG:학생 == 1 || TALENT:ARG:학생 == 2)
	;	TALENT:ARG:학생 = 3
	;ENDIF
	CLEARLINE LINECOUNT - LCOUNT
	GOTO INPUT_LOOP
ELSEIF RESULT >= 50 && RESULT < 53
	OPTION:0 = RESULT % 10
	SIF OPTION:0 == 0
		OPTION:3 = 0
	CLEARLINE LINECOUNT - LCOUNT
	GOTO INPUT_LOOP
ELSEIF RESULT >= 53 && RESULT < 55 && TALENT:ARG:청순파 == 0
	OPTION:0 = RESULT % 10
	CLEARLINE LINECOUNT - LCOUNT
	GOTO INPUT_LOOP
ELSEIF (RESULT >= 60 && RESULT < 63) || (RESULT == 63 && TALENT:ARG:청순파 == 0)
	OPTION:1 = RESULT % 10
	CLEARLINE LINECOUNT - LCOUNT
	GOTO INPUT_LOOP
ELSEIF RESULT == 70
	OPTION:2 = RESULT % 10
	CLEARLINE LINECOUNT - LCOUNT
	GOTO INPUT_LOOP
ELSEIF RESULT >= 71 && RESULT < 72 && TALENT:ARG:청순파 == 0
	OPTION:2 = RESULT % 10
	CLEARLINE LINECOUNT - LCOUNT
	GOTO INPUT_LOOP
ELSEIF RESULT == 80
	OPTION:3 = RESULT % 10
	;★양자는 고려하지 않았다
	SIF TALENT:ARG:가족관계 >= 5
		TALENT:ARG:가족관계 = 0
	CLEARLINE LINECOUNT - LCOUNT
	GOTO INPUT_LOOP
ELSEIF RESULT == 81 && ISFEMALE(ARG) && TALENT:ARG:미성숙 == 0 && TALENT:ARG:처녀 == 0
	OPTION:3 = RESULT % 10
	SIF OPTION:0 < 1
		OPTION:0 = 1
	CLEARLINE LINECOUNT - LCOUNT
	GOTO INPUT_LOOP
ELSEIF RESULT == 82 && TALENT:ARG:청순파 == 0 && ISFEMALE(ARG) && TALENT:ARG:미성숙 == 0 && TALENT:ARG:처녀 == 0
	OPTION:3 = RESULT % 10
	SIF OPTION:0 < 1
		OPTION:0 = 1
	CLEARLINE LINECOUNT - LCOUNT
	GOTO INPUT_LOOP
;리롤
ELSEIF RESULT == 100
	특수판정=
	;주어진 조건에서 초기 경험을 생성
	SEX_NUM = 0
	;경험을 모두 초기화
	FOR LOCAL, 0, 99
		EXP:ARG:LOCAL = 0
	NEXT

	;●자위경험
	;성욕의 강함을 본다
	;역) 우대 환경은 너무 없는 것 같은데 자위 정도는 괜찮겠지
	LOCAL = RAND:8
	SIF OPTION:1 == 0 && TALENT:ARG:청순파 == 0
		LOCAL += RAND:3
	SIF BASE:ARG:실제나이 > 8
		LOCAL += RAND:2
	SIF BASE:ARG:실제나이 > 12
		LOCAL += RAND:2
	SIF BASE:ARG:실제나이 > 16
		LOCAL += RAND:2
	SIF BASE:ARG:실제나이 > 20
		LOCAL += RAND:2
	SIF TALENT:ARG:학생 == 1
		LOCAL = LOCAL / 2
	SIF TALENT:ARG:학생 == 2
		LOCAL = LOCAL * 2 / 3
	SIF TALENT:ARG:쾌감에솔직 > 0
		LOCAL += 2 + RAND:2
	SIF TALENT:ARG:쾌감을부정 > 0
		LOCAL -= 2 + RAND:2
	SIF TALENT:ARG:청순파 > 0
		LOCAL -= 2 + RAND:2
	SIF TALENT:ARG:보수적 > 0
		LOCAL = LOCAL * 2 / 3
	SIF TALENT:ARG:호기심 > 0
		LOCAL = LOCAL * 3 / 2
	IF LOCAL > 0
		SEX_NUM = LOCAL
		FOR LOCAL, 0, SEX_NUM
			EXP:ARG:자위경험 += 1
			IF RAND:4 != 0
				SIF TALENT:ARG:미성숙 != 1 && (ISMALE(ARG) || TALENT:ARG:후타나리 > 0)
					EXP:ARG:사정경험 += 1
			ENDIF
		NEXT
	ENDIF
	SEX_NUM = 0

	;●촉수 피해 경험
	LOCAL = 0
	;생활 환경이 비참했을 경우
	IF ISFEMALE(ARG) && OPTION:1 == 3
		EXP:ARG:피간경험 += 1
		SEX_NUM += 6 + RAND:8
		IF RAND:2 == 0
			EXP:ARG:피간경험 += 1+RAND:6
			SEX_NUM += 1+RAND:6
		ENDIF
		IF RAND:2 == 0
			EXP:ARG:피간경험 += 1+RAND:6
			SEX_NUM += 1+RAND:6
		ENDIF
		IF RAND:2 == 0
			EXP:ARG:유폐경험 += 1+RAND:3
			SEX_NUM += +RAND:20
		ENDIF
	;열악하지 않고 처녀라면 습격당했을 확률이 낮다
	ELSEIF OPTION:1 < 2 && TALENT:ARG:처녀 > 0 && RAND:2 == 0
		;세이프
	;생활 환경이 열악했을 경우
	ELSEIF ISFEMALE(ARG) && OPTION:1 == 2
		EXP:ARG:피간경험 += 1
		SEX_NUM += 3 + RAND:4
		IF RAND:2 == 0
			EXP:ARG:피간경험 += 1
			SEX_NUM += 1
		ENDIF
		IF RAND:2 == 0
			EXP:ARG:피간경험 += 1
			SEX_NUM += 1
		ENDIF
		IF RAND:4 == 0
			EXP:ARG:유폐경험 += 1
			SEX_NUM += 3
		ENDIF
	;생활 환경이 보통이었을 경우
	ELSEIF ISFEMALE(ARG) && OPTION:1 == 1 && RAND:3 == 0
		EXP:ARG:피간경험 += 1
		SEX_NUM += 1
		IF RAND:8 == 0
			EXP:ARG:유폐경험 += 1
			SEX_NUM += 3
		ENDIF
	;생활 환경이 우대라면 촉수 피해는 입지 않았다
	ENDIF
	;대체로 촉수 피해자였던 경우는 적당히 경험을 가산
	IF SEX_NUM > 0
		FOR LOCAL, 0, SEX_NUM+3*EXP:ARG:유폐경험
			IF RAND:10 == 0 && TALENT:ARG:처녀 == 0
				EXP:ARG:Ｖ경험 += 2
				EXP:ARG:Ｖ확장경험 += 1
				;출산경험
				IF RAND:4 != 0
					IF TALENT:ARG:처녀 == 0 && TALENT:ARG:미성숙 == 0
						IF TALENT:ARG:모유체질 > 0
							EXP:ARG:출산경험 += 2 + RAND:4
						ELSEIF RAND:4 == 0
							EXP:ARG:출산경험 += 1 + RAND:3
						ENDIF
					ENDIF
				ENDIF
			ELSEIF RAND:9 == 0
				EXP:ARG:Ａ경험 += 2
				EXP:ARG:Ａ확장경험 += 1
			ELSEIF RAND:3 == 0 && TALENT:ARG:처녀 == 0
				EXP:ARG:Ｖ경험 += 1
				;출산경험
				IF RAND:4 != 0
					IF TALENT:ARG:처녀 == 0 && TALENT:ARG:미성숙 == 0
						IF TALENT:ARG:모유체질 > 0
							EXP:ARG:출산경험 += 2 + RAND:4
						ELSEIF RAND:4 == 0
							EXP:ARG:출산경험 += 1 + RAND:3
						ENDIF
					ENDIF
				ENDIF
			ELSEIF RAND:2 == 0
				EXP:ARG:Ａ경험 += 1
			ELSE
				EXP:ARG:펠라경험 += 1
			ENDIF
			IF RAND:4 == 0
				SIF TALENT:ARG:모유체질 > 0 && RAND:2 == 0
					EXP:ARG:모유경험 += 1
			ENDIF
		NEXT

		IF EXP:ARG:유폐경험>1 && TALENT:ARG:처녀 == 0
			특수판정'=특수판정+"촉수의 모판이 된 적이 있다　"
		ELSEIF EXP:ARG:유폐경험>0
			특수판정'=특수판정+"촉수 둥지에 끌려간 적이 있다　"
		ELSE
			특수판정'=특수판정+"촉수에게 습격당한 적이 있다　"
		ENDIF
	ENDIF
	SEX_NUM = 0

	;●사생활에서의 성관계
	LOCAL = 0
	;경험 횟수가 적다
	IF OPTION:0 == 1 && RAND:2 == 0
		LOCAL = 1 + RAND:3
		;매춘 경험이「있음」일 시
		SIF OPTION:2 == 1 && RAND:2 == 0
			LOCAL += 1
	;경험 횟수가 약간 적다
	ELSEIF OPTION:0 == 2 && RAND:2 == 0
		LOCAL = 2 + RAND:6
		;매춘 경험이「있음」일 시
		SIF OPTION:2 == 1 && RAND:3 != 0
			LOCAL += 2
	;경험 횟수가 많다
	ELSEIF OPTION:0 == 3
		LOCAL = 4 + RAND:12
		;매춘 경험이「있음」일 시
		SIF OPTION:2 == 1 && RAND:4 != 0
			LOCAL += 4
	;경험 횟수가 아주 많다
	ELSEIF OPTION:0 == 4
		LOCAL = 8 + RAND:24
		SIF RAND:10 == 0
			LOCAL = LOCAL * 3 / 2
		;매춘 경험이「있음」일 시
		SIF OPTION:2 == 1 && RAND:5 != 0
			LOCAL += 8
	ENDIF
	;경험 횟수가「없음」이외일 시 경험 보정치를 설정
	IF OPTION:0 != 0
		;교제상대
		;남친
		SIF TALENT:ARG:교제상대 == 2
			LOCAL += RAND:3
		;약혼자
		SIF TALENT:ARG:교제상대 == 3
			LOCAL += RAND:6
		;유부녀
		SIF TALENT:ARG:교제상대 == 4 || TALENT:ARG:교제상대 == 5
			LOCAL += RAND:12
		;환경이 열악or비참했을 시 강간 피해를 포함한다
		IF (OPTION:1 == 2 && RAND:4 == 0) || (OPTION:1 == 3 && RAND:2 == 0) 
			;통상 강간
			IF RAND:4
				LOCAL += 3 + RAND:6
				특수판정'=특수판정+"강간당한 적이 있다　"
			;더욱 비참한 경험
			ELSE
				LOCAL += 12 + RAND:14
				STRDATA LOCALS
				DATAFORM 윤간당한 적이 있다
				DATAFORM 유괴당한 적이 있다
				DATAFORM 감금당한 적이 있다
				DATAFORM 스토커에게 습격당한 적이 있다
				DATAFORM 노숙자에게 범해진 적이 있다
				ENDDATA
				특수판정'=특수판정+LOCALS+"　"
			ENDIF
		;「우대」이외일 시 어떠한 성 경험(플레이버)을 더한다
		ELSEIF OPTION:1 > 0 && RAND:6==0
				LOCAL += 5 + RAND:7
				STRDATA LOCALS
				DATAFORM 치한 피해에 시달리고 있다
				DATAFORM 성희롱에 시달리고 있다
				ENDDATA
				특수판정'=특수판정+LOCALS+"　"
		ENDIF
	ENDIF

	;매춘 경험이「있음」일 시 추가 경험 보정
	SIF OPTION:2 == 1 && RAND:5 != 0
		LOCAL += 1 + RAND:3
	;기타 보정
	SIF TALENT:ARG:보수적 > 0
		LOCAL = LOCAL * 2 / 3
	SIF TALENT:ARG:호기심 > 0
		LOCAL = LOCAL * 3 / 2
	SIF TALENT:ARG:청순파
		LOCAL = LOCAL / 2
	SIF TALENT:ARG:청순파 && TALENT:ARG:교제상대 == 3
		LOCAL = LOCAL * 2 / 3
	SIF TALENT:ARG:학생 == 1
		LOCAL = LOCAL / 2
	SIF TALENT:ARG:학생 == 2
		LOCAL = LOCAL * 2 / 3
	;출산 경험이 있을 시 추가 경험 보정
	IF OPTION:3 == 1
		LOCAL += 1 + RAND:6
	ELSEIF OPTION:3 == 2
		LOCAL += 2 + RAND:12
	ENDIF

	;대체로 대인 성관계 경험이 있다면 EXP를 적당히 가산
	IF LOCAL > 0
		SEX_NUM = LOCAL
		FOR LOCAL, 0, SEX_NUM
			IF ISMALE(ARG)
				SIF RAND:20 == 0
					EXP:ARG:Ａ경험 += 1
				IF RAND:4 != 0
					SIF TALENT:ARG:미성숙 != 1
						EXP:ARG:사정경험 += 1
				ENDIF
			ELSE
				;경험 횟수가 없고 생활 환경이 열악하다면 펠라만
				IF OPTION:0 == 0 && OPTION:1 == 2
					EXP:ARG:펠라경험 += 1
				ELSEIF OPTION:3 == 2 && EXP:ARG:Ｖ경험 == 0
					EXP:ARG:Ｖ경험 += 2
					IF RAND:6 != 0
						SIF TALENT:ARG:미성숙 != 1 && TALENT:ARG:후타나리 > 0
							EXP:ARG:사정경험 += 1
						SIF TALENT:ARG:모유체질 > 0 && RAND:2 == 0
							EXP:ARG:모유경험 += 1
					ENDIF	
				ELSEIF OPTION:3 == 1 && EXP:ARG:Ｖ경험 == 0
					EXP:ARG:Ｖ경험 += 1
					IF RAND:4 != 0
						SIF TALENT:ARG:미성숙 != 1 && TALENT:ARG:후타나리 > 0
							EXP:ARG:사정경험 += 1
						SIF TALENT:ARG:모유체질 > 0 && RAND:2 == 0
							EXP:ARG:모유경험 += 1
					ENDIF					
				ELSEIF RAND:10 == 0
					EXP:ARG:이상경험 += 1
					IF RAND:3 == 0 && TALENT:ARG:처녀 == 0
						EXP:ARG:Ｖ확장경험 += 1
					ELSEIF RAND:2 == 0
						EXP:ARG:Ａ확장경험 += 1
					ELSE
						EXP:ARG:방뇨경험 += 1
					ENDIF
				ELSEIF RAND:3 == 0 && TALENT:ARG:처녀 == 0
					EXP:ARG:Ｖ경험 += 1
					IF RAND:4 != 0
						SIF TALENT:ARG:미성숙 != 1 && TALENT:ARG:후타나리 > 0
							EXP:ARG:사정경험 += 1
						SIF TALENT:ARG:모유체질 > 0 && RAND:2 == 0
							EXP:ARG:모유경험 += 1
					ENDIF
				ELSEIF RAND:2 == 0
					EXP:ARG:Ａ경험 += 1
					IF RAND:4 != 0
						SIF TALENT:ARG:미성숙 != 1 && TALENT:ARG:후타나리 > 0
							EXP:ARG:사정경험 += 1
						SIF TALENT:ARG:모유체질 > 0 && RAND:2 == 0
							EXP:ARG:모유경험 += 1
					ENDIF
				ELSE
					EXP:ARG:펠라경험 += 1
				ENDIF
				SIF RAND:4 == 0 && TALENT:ARG:마조기질 > 0
					EXP:ARG:고통쾌락경험 += 1
				SIF RAND:2 == 0 && TALENT:ARG:헌신적 > 0
					EXP:ARG:봉사쾌락경험 += 1
			ENDIF
		NEXT
		;출산 경험
		IF OPTION:3 == 1 && EXP:ARG:Ｖ경험 > 0
			EXP:ARG:출산경험 += 1
			SIF RAND:10 == 0 && EXP:ARG:Ｖ경험 >= 3
				EXP:ARG:출산경험 += 1
		ELSEIF OPTION:3 == 2 && EXP:ARG:Ｖ경험 > 0
			EXP:ARG:출산경험 += 1
			SIF EXP:ARG:Ｖ경험 >= 2
				EXP:ARG:출산경험 += 1
			SIF RAND:10 == 0 && EXP:ARG:Ｖ경험 >= 5
				EXP:ARG:출산경험 += 1
			SIF RAND:10 == 0 && EXP:ARG:Ｖ경험 >= 7
				EXP:ARG:출산경험 += 1
			SIF RAND:20 == 0 && EXP:ARG:Ｖ경험 >= 8
				EXP:ARG:출산경험 += 1
			SIF RAND:20 == 0 && EXP:ARG:Ｖ경험 >= 9
				EXP:ARG:출산경험 += 1
		ENDIF
		;매료
		SIF OPTION:2 == 1 && RAND:4 == 0
			EXP:ARG:매료경험 += 1 + RAND:3
		;근친상간
		LOCAL = 0
		;매춘도 안 하고 사귀지도 않으면 집에서 따먹힌다
		IF TALENT:ARG:교제상대 == 0 && OPTION:2 == 0
			IF OPTION:1 == 2 && RAND:4 == 0
				LOCAL = 1
			ELSEIF OPTION:1 == 1 && RAND:8 == 0
				LOCAL = 1
			ELSEIF OPTION:1 == 0 && RAND:12 == 0
				LOCAL = 1
			ENDIF
			SIF TALENT:ARG:청순파 > 0 && RAND:2 == 0
				LOCAL = 0
		ENDIF
		SIF LOCAL > 0
			특수판정'=특수판정+"근친상간을 한 적이 있다　"
		IF LOCAL > 0
			FOR LOCAL, 0, SEX_NUM
				;★근친교배경험은 낳은 새끼 촉수와의 교배 횟수에도 사용되고 있다
				;　여기, 원래는 근친상간경험으로 나누는 것이 좋다
				SIF RAND:4 != 0
					EXP:ARG:근친교배경험 += 1
			NEXT
		ENDIF
	ENDIF
	SEX_NUM = 0

	CLEARLINE LINECOUNT - LCOUNT
	GOTO INPUT_LOOP
;초기화
ELSEIF RESULT == 200
	특수판정=
	;경험을 모두 초기화
	FOR LOCAL, 0, 99
		EXP:ARG:LOCAL = 0
	NEXT

	TALENT:ARG:가족관계=0
	TALENT:ARG:교제상대=0
	;학교는 나이에 따른 자연스러운 값으로
	SELECTCASE BASE:ARG:나이
	CASE 6 TO 12
		TALENT:ARG:학생=1
		CFLAG:ARG:358=1+RAND:2
	CASE 13 TO 15
		TALENT:ARG:학생=2
		CFLAG:ARG:358=1+RAND:2
	CASE 16 TO 18
		TALENT:ARG:학생=3
		CFLAG:ARG:358=1+RAND:2
	CASE 19 TO 22
		TALENT:ARG:학생=4
		CFLAG:ARG:358=1+RAND:2
	CASEELSE
		TALENT:ARG:학생=0
		CFLAG:ARG:358=0
	ENDSELECT

	VARSET OPTION
	CLEARLINE LINECOUNT - LCOUNT
	GOTO INPUT_LOOP
;돌아간다
ELSEIF RESULT == 999
ELSE
	CLEARLINE LINECOUNT - LCOUNT
	GOTO INPUT_LOOP
ENDIF


@FIRSTSETTING_PRINT_EXP, ARG
FOR LOCAL, 0, 99
	SIF EXP:ARG:LOCAL > 0
		PRINTFORM 　%EXPNAME:LOCAL%({EXP:ARG:LOCAL}) 
	IF LOCAL == 39
		PRINTL 
		PRINT 　　　　　
	ENDIF
NEXT


