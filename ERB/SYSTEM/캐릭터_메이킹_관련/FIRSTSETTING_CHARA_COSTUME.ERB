;アウターの設定
@FIRSTSETTING_CLOTH_SETTING_OUTER, ARG
$INPUT_LOOP
PRINTL 
PRINTL アウターを選んでください
DRAWLINE
LOCAL:1 = 0
LOCAL:2 = 30
FOR LOCAL, 100, 200
	SIF ITEMNAME:LOCAL == ""
		CONTINUE
	IF LOCAL:1 == 3
		LOCAL:1 = 0
		PRINTL 
	ENDIF
	LOCALS:0 = [{LOCAL}]%ITEMNAME:LOCAL%
	PRINTFORM %LOCALS:0,LOCAL:2,LEFT%
	LOCAL:1 += 1
NEXT
PRINTL 
DRAWLINE
PRINTL [0]変更しないで戻る
PRINTL [1]アウターを設定しない
INPUT
SELECTCASE RESULT
	CASE 0
	CASE 1
		;SIF CFLAG:ARG:40 == 199
		;	CFLAG:ARG:41 = -1
		CFLAG:ARG:40 = -1
		PRINTL アウターを設定しませんでした
		PRINTW 
	CASE 100 TO 199
		LOCAL = RESULT
		;非戦闘員専用
		IF LOCAL == 197 && ITEM:LOCAL == 1 && TALENT:ARG:변신능력 != -1
			PRINTL 
			PRINTFORML %ITEMNAME:LOCAL%
			CALLFORM CLOTH_DESCRIPTION_{LOCAL}
			PRINTL 
			DRAWLINE
			PRINTL [0]変更しない
			SETCOLOR 126,126,126
			PRINTL [1]変更する
			RESETCOLOR
			$INPUT_LOOP2
			INPUT
			IF RESULT == 0
				GOTO INPUT_LOOP
			ELSEIF RESULT == 1
				GOTO INPUT_LOOP2
			ELSE
				PRINTL 
				PRINTW 正しい値を入力してください
				GOTO INPUT_LOOP2
			ENDIF

		ELSE
			IF ITEMNAME:RESULT == ""
				PRINTL 
				PRINTW 正しい値を入力してください
				GOTO INPUT_LOOP
			ENDIF
			
			PRINTL 
			PRINTFORML %ITEMNAME:LOCAL%
			CALLFORM CLOTH_DESCRIPTION_{LOCAL}
			PRINTL 
			DRAWLINE
			PRINTL [0]変更しない
			PRINTL [1]変更する
			$INPUT_LOOP3
			INPUT
			IF RESULT == 0
				GOTO INPUT_LOOP
			ELSEIF RESULT == 1
				;SIF CFLAG:ARG:40 == 199
				;	CFLAG:ARG:41 = 0
				CFLAG:ARG:40 = LOCAL
				;SIF CFLAG:ARG:40 == 199
				;	CFLAG:ARG:41 = 199
				PRINTFORML アウターを%ITEMNAME:LOCAL%に変更しました
				PRINTW 
			ELSE
				PRINTL 
				PRINTW 正しい値を入力してください
				GOTO INPUT_LOOP3
			ENDIF
		ENDIF
	CASEELSE
		PRINTL 
		PRINTW 正しい値を入力してください
		GOTO INPUT_LOOP
ENDSELECT



;----------------------------------------------------------
;アウター（変身後）の設定
@FIRSTSETTING_CLOTH_SETTING_OUTER2, ARG
$INPUT_LOOP
PRINTL 
PRINTL アウターを選んでください
DRAWLINE
LOCAL:1 = 0
LOCAL:2 = 30
FOR LOCAL, 100, 300
	SIF ITEMNAME:LOCAL == ""
		CONTINUE
	IF LOCAL:1 == 3
		LOCAL:1 = 0
		PRINTL 
	ENDIF
	LOCALS:0 = [{LOCAL}]%ITEMNAME:LOCAL%
	PRINTFORM %LOCALS:0,LOCAL:2,LEFT%
	LOCAL:1 += 1
NEXT

PRINTL 
DRAWLINE
PRINTL [0]変更しないで戻る
PRINTL [1]アウター（変身後）を設定しない
INPUT
SELECTCASE RESULT
	CASE 0
	CASE 1
		;SIF CFLAG:ARG:41 == 199
		;	CFLAG:ARG:40 = -1
		CFLAG:ARG:41 = -1
		PRINTL アウター（変身後）を設定しませんでした
		PRINTW 
	CASE 100 TO 299
		IF ITEMNAME:RESULT == ""
			PRINTL 
			PRINTW 正しい値を入力してください
			GOTO INPUT_LOOP
		ENDIF

		LOCAL = RESULT
		PRINTL 
		PRINTFORML %ITEMNAME:LOCAL%
		CALLFORM CLOTH_DESCRIPTION_{LOCAL}
		PRINTL 
		DRAWLINE
		PRINTL [0]変更しない
		PRINTL [1]変更する
		$INPUT_LOOP3
		INPUT
		IF RESULT == 0
			GOTO INPUT_LOOP
		ELSEIF RESULT == 1
			;SIF CFLAG:ARG:41 == 199
			;	CFLAG:ARG:40 = 0
			;変身コスチュームのカスタマイズをリセット
			IF CFLAG:ARG:41 != LOCAL
				FOR LOCAL:1, 600, 700
					EQUIP:ARG:(LOCAL:1) = 0
				NEXT
			ENDIF
			CFLAG:ARG:41 = LOCAL
			;SIF CFLAG:ARG:41 == 199
			;	CFLAG:ARG:40 = 199
			PRINTFORML アウター（変身後）を%ITEMNAME:LOCAL%に変更しました
			PRINTW 
		ELSE
			PRINTL 
			PRINTW 正しい値を入力してください
			GOTO INPUT_LOOP3
		ENDIF
	CASEELSE
		PRINTL 
		PRINTW 正しい値を入力してください
		GOTO INPUT_LOOP
ENDSELECT



;----------------------------------------------------------
;インナーの設定
@FIRSTSETTING_CLOTH_SETTING_INNER, ARG
$INPUT_LOOP
PRINTL 
PRINTL インナーを選んでください
DRAWLINE
LOCAL:1 = 0
LOCAL:2 = 30
FOR LOCAL, 300, 399
	SIF ITEMNAME:LOCAL == ""
		CONTINUE
	IF LOCAL:1 == 3
		LOCAL:1 = 0
		PRINTL 
	ENDIF
	LOCALS:0 = [{LOCAL}]%ITEMNAME:LOCAL%
	PRINTFORM %LOCALS:0,LOCAL:2,LEFT%
	LOCAL:1 += 1
NEXT
PRINTL 
DRAWLINE
PRINTL [0]変更しないで戻る
PRINTL [1]インナーを設定しない
INPUT
SELECTCASE RESULT
	CASE 0
	CASE 1
		CFLAG:ARG:42 = -1
		PRINTL インナーを設定しませんでした
		PRINTW 
	CASE 300 TO 398
		IF ITEMNAME:RESULT == ""
			PRINTL 
			PRINTW 正しい値を入力してください
			GOTO INPUT_LOOP
		ENDIF

		LOCAL = RESULT
		PRINTL 
		PRINTFORML %ITEMNAME:LOCAL%
		CALLFORM CLOTH_DESCRIPTION_{LOCAL}
		PRINTL 
		DRAWLINE
		PRINTL [0]変更しない
		PRINTL [1]変更する
		$INPUT_LOOP3
		INPUT
		IF RESULT == 0
			GOTO INPUT_LOOP
		ELSEIF RESULT == 1
			CFLAG:ARG:42 = LOCAL
			PRINTFORMW インナーを%ITEMNAME:LOCAL%に変更しました
			IF CFLAG:ARG:42 != 308
				IF FIGURE_SPLIT(EQUIP:ARG:103, 4) == 2
					;露出度合い
					LOCAL = 0
					SIF FIGURE_SPLIT(EQUIP:ARG:103, 2) == 1
						LOCAL -= 1
					SIF FIGURE_SPLIT(EQUIP:ARG:103, 2) == 2
						LOCAL -= 1
					SIF FIGURE_SPLIT(EQUIP:ARG:103, 2) == 3
						LOCAL -= 2
					SIF FIGURE_SPLIT(EQUIP:ARG:103, 4) == 1
						LOCAL -= 1
					SIF FIGURE_SPLIT(EQUIP:ARG:103, 4) == 2
						LOCAL -= 4

					SIF FIGURE_SPLIT(EQUIP:ARG:103, 2) == 4
						LOCAL += 1
					SIF FIGURE_SPLIT(EQUIP:ARG:103, 4) == 3
						LOCAL += 1
					SIF FIGURE_SPLIT(EQUIP:ARG:103, 4) == 4
						LOCAL += 2
					SIF FIGURE_SPLIT(EQUIP:ARG:103, 5) == 4
						LOCAL += 1

					;補正効果
					;軽装
					SIF LOCAL < 0
						EQUIP:ARG:103 += LOCAL * POWER(10, 9)
					;重装
					SIF LOCAL > 0
						EQUIP:ARG:103 -= LOCAL * POWER(10, 10)
					;下着保護ダウン
					SIF FIGURE_SPLIT(EQUIP:ARG:103, 4) == 2
						EQUIP:ARG:103 -= 4 * POWER(10, 11)
					;下着保護アップ
					SIF FIGURE_SPLIT(EQUIP:ARG:103, 4) == 4
						EQUIP:ARG:103 -= 2 * POWER(10, 12)
					SIF FIGURE_SPLIT(EQUIP:ARG:103, 5) == 4
						EQUIP:ARG:103 -= 1 * POWER(10, 12)
					EQUIP:ARG:103 -= 2000
				ENDIF
				IF FIGURE_SPLIT(EQUIP:ARG:3, 4) == 2
					;露出度合い
					LOCAL = 0
					SIF FIGURE_SPLIT(EQUIP:ARG:3, 2) == 1
						LOCAL -= 1
					SIF FIGURE_SPLIT(EQUIP:ARG:3, 2) == 2
						LOCAL -= 1
					SIF FIGURE_SPLIT(EQUIP:ARG:3, 2) == 3
						LOCAL -= 2
					SIF FIGURE_SPLIT(EQUIP:ARG:3, 4) == 1
						LOCAL -= 1
					SIF FIGURE_SPLIT(EQUIP:ARG:3, 4) == 2
						LOCAL -= 4

					SIF FIGURE_SPLIT(EQUIP:ARG:3, 2) == 4
						LOCAL += 1
					SIF FIGURE_SPLIT(EQUIP:ARG:3, 4) == 3
						LOCAL += 1
					SIF FIGURE_SPLIT(EQUIP:ARG:3, 4) == 4
						LOCAL += 2
					SIF FIGURE_SPLIT(EQUIP:ARG:3, 5) == 4
						LOCAL += 1

					;補正効果
					;軽装
					SIF LOCAL < 0
						EQUIP:ARG:3 += LOCAL * POWER(10, 9)
					;重装
					SIF LOCAL > 0
						EQUIP:ARG:3 -= LOCAL * POWER(10, 10)
					;下着保護ダウン
					SIF FIGURE_SPLIT(EQUIP:ARG:3, 4) == 2
						EQUIP:ARG:3 -= 4 * POWER(10, 11)
					;下着保護アップ
					SIF FIGURE_SPLIT(EQUIP:ARG:3, 4) == 4
						EQUIP:ARG:3 -= 2 * POWER(10, 12)
					SIF FIGURE_SPLIT(EQUIP:ARG:3, 5) == 4
						EQUIP:ARG:3 -= 1 * POWER(10, 12)
					EQUIP:ARG:3 -= 2000
				ENDIF
			ENDIF
		ELSE
			PRINTL 
			PRINTW 正しい値を入力してください
			GOTO INPUT_LOOP3
		ENDIF
	CASEELSE
		PRINTL 
		PRINTW 正しい値を入力してください
		GOTO INPUT_LOOP
ENDSELECT

@FIRSTSETTING_CHARA_COSTUME_PRE(ARG)
;衣装の仮決定
CFLAG:ARG:45 = CFLAG:ARG:40
CFLAG:ARG:46 = CFLAG:ARG:41
CFLAG:ARG:47 = CFLAG:ARG:42

@FIRSTSETTING_CHARA_COSTUME_LATE(ARG)
;衣装の本決定
CFLAG:ARG:40 = CFLAG:ARG:45
CFLAG:ARG:41 = CFLAG:ARG:46
CFLAG:ARG:42 = CFLAG:ARG:47

