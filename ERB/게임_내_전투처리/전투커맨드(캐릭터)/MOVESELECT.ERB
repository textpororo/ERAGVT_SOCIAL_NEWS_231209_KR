;移動選択の処理
@TRANSFORM_MOVESELECT
#DIM ABLE5
#DIM ABLE6
#DIM ABLE7
#DIM LCOUNT


;先制공격中は選択する必要がない
SIF TFLAG:24 > 0
	RETURN 0
;捕まってるときは選択不能
SIF TCVARn:0 < 1
	RETURN 0
;공중대시との併用不能
SIF GETBIT(TCVARn:216, 1)
	RETURN 0
;移動系コマンドが使用できない場合は選択不能
TCVARn:8+=10
	CALL COM_ABLE5
	ABLE5 = RESULT
	CALL COM_ABLE6
	ABLE6 = RESULT
	CALL COM_ABLE7
	ABLE7 = RESULT
TCVARn:8-=10
SIF ABLE5 == 0 && ABLE6 == 0 && ABLE7 == 0
	RETURN 0
LCOUNT = LINECOUNT


;変身スタイル固定時
IF CFLAG:12 > 0
	RESULT = CFLAG:12
;コマンド側で選択時
ELSEIF SELECTCOM > 200
	RESULT = SELECTCOM-200
;その場で選択時
ELSE
	PRINTL 
	PRINTFORML 変身方法を選択してください
	IF TCVARn:0 == 1
		PRINTL [1]その場で변신한다　　　　　（回避+20%）
	ELSEIF ABLE6 > 0
		PRINTL [1]踏み込んで隙を突く　　　　（근거리に移動、EXゲージが上昇）
	ENDIF
	IF TCVARn:0 == 2
		PRINTL [2]その場で변신한다　　　　　（回避+15%）
	ELSEIF ABLE7 > 0
		PRINTL [2]敵の動きを見極める　　　　（중거리に移動、次のターン予測精度アップ）
	ENDIF
	IF TCVARn:0 == 3
		PRINTL [3]その場で변신한다　　　　　（回避+10%）
	ELSEIF ABLE5 > 0
		PRINTL [3]距離を取って態勢を整える　（원거리に移動、체력, 기력が多めに回復）
	ENDIF
	$INPUT_LOOP
	INPUT
ENDIF
IF RESULT == TCVARn:0
	CLEARLINE LINECOUNT - LCOUNT
	RETURN 0
ELSEIF RESULT == 1 && ABLE6 > 0
	TCVARn:0 = 1
	;FEAT 효과에 따른反動の増加
	SIF TALENT:공중부유 > 0
		TFLAG:99 += 1
	CLEARLINE LINECOUNT - LCOUNT
	RETURN 1
ELSEIF RESULT == 2 && ABLE7 > 0
	TCVARn:0 = 2
	;FEAT 효과에 따른反動の増加
	SIF TALENT:공중부유 > 0
		TFLAG:99 += 1
	CLEARLINE LINECOUNT - LCOUNT
	RETURN 2
ELSEIF RESULT == 3 && ABLE5 > 0
	TCVARn:0 = 3
	;FEAT 효과에 따른反動の増加
	SIF TALENT:공중부유 > 0
		TFLAG:99 += 1
	CLEARLINE LINECOUNT - LCOUNT
	RETURN 3
ELSE
	GOTO INPUT_LOOP
ENDIF



