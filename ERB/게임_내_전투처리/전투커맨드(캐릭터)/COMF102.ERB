;풋잡공격
@COM102
#DIM SELECT
;距離表示
CALL PRINT_DISTANCE
PRINTL 

SELECT = -1
VARSET LOCAL

;性コマンド選択ルーチンで判定
;挿入系の性コマンドが出ればカウンター発動成功
CALL ENEMY_ACTION_SEX_ROUTINE
SELECT = RESULT

;選択したコマンドの分類を호출
IF ENEMY_TYPE_CHECK_F("MOB") == 1
	TRYCALLFORM SEX_TYPE_MOB_{FLAG:11}_COM{SELECT}
ELSE
	TRYCALLFORM SEX_TYPE_COM{SELECT}
ENDIF
LOCAL = RESULT

;挿入系コマンドが選択された場合はカウンター発動
;기교依存で発動率アップ
IF (LOCAL & 삽입) && RAND:100 < 95 || (RAND:100 < SQRT(1 + 50 * ABL:기교))
	;사정部位フラグ:ワレメと오발を立てる
	TFLAG:4 = TFLAG:4 | 균열
	TFLAG:4 = TFLAG:4 | 오발

	;방심도 상승
	TFLAG:3 += 105 + 5 * ABL:기교

	;지문: 풋잡공격
	CALL MESSAGE_BATTLE_CHARA_SEX_ATTACK102
	;지문: 세뇌/흑화 캐릭터가 조작 캐릭터의 풋잡공격を見た
	SIF ENEMY_TYPE_CHECK_F("AKUOTI") == 1
		CALL MESSAGE_OTHER_BATTLE_CHARA_SEX_ATTACK102

	;사정 게이지を記録
	LOCAL:1 = FLAG:15

	;사정
	LOCAL = MIN(MAXBASE:성내성 / 2, 150) + 150 + 75 * ABL:기교
	CALL TENTACLE_SYASEI_UP, LOCAL

	PRINTL
	IF (FLAG:110 == 0)
		CALL TENTACLE_ACCESS, "NAME"
	ELSEIF (FLAG:110 == 1)
		PRINTFORM %PRINT_TRANSCALLNAME(FLAG:111)%
	ENDIF
	PRINT に
	FONTBOLD
	PRINTFORM {FLAG:15 - LOCAL:1}の快楽
	FONTREGULAR
	PRINTL を与えた！
	PRINTW 

	;촉수の사정チェック
	CALL TENTACLE_SYASEI_CHECK
	PRINTL 

	;습득の獲得
	COMMON_PALAM:6 += 1050 + 25 * (ABL:순종 + ABL:봉사정신 * 2)

	;行動予約を空にする
	TFLAG:17 = -1

	;촉수を行動不能にする
	TFLAG:1 = 1

	;행동포인트を+1
	EX:행동포인트 += 1

	RETURN 1
;カウンターに失敗
ELSE
	PRINTFORML %조사처리(PRINT_TRANSCALLNAME(TARGET),"는")%풋잡공격の構え！
	PRINTW 
	PRINTFORML しかし%PRINT_TRANSCALLNAME(TARGET)%의 行動は失敗した！
	PRINTL 

	;습득の獲得
	COMMON_PALAM:6 += 250 + 25 * (ABL:순종 + ABL:봉사정신 * 2)

	;행동포인트を+1
	EX:행동포인트 += 1

	FLAG:17 = SELECT

	RETURN 1
ENDIF
