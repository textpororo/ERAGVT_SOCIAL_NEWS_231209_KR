;--------------------------------------------------
;최종 보스 촉수2 천사의 나무
;HP 75% 이상으로 제1형태, HP 50% 이상으로 제2형태, 그 이하는 최종 형태
;↓촉수의 존재 확인용 함수　아무것도 처리하지 않는다
@TENTACLE_LASTBOSS_2
;--------------------------------------------------
;이름
@TENTACLE_LASTBOSS_2_GETNAME
IF FLAG:21 == 1
	RESULTS = 천사의 나무
ELSEIF FLAG:21 == 2
	RESULTS = 낙원의 꽃
ELSE
	RESULTS = 타락의 핵
ENDIF

;--------------------------------------------------
;정의
@TENTACLE_LASTBOSS_2_DEFENITION
IF FLAG:21 == 1
	PRINTFORML （Ｋ촉수의 시체로부터 자라 나온 거대한 기둥 모양의 구조물.）
	PRINTFORML （중심에 꽃봉오리가 존재하며, 멀리서 보면 마치 살로 이루어진 큰 나무처럼 보이기도 한다.）
ELSEIF FLAG:21 == 2
	PRINTFORML （천사의 나무 중앙에 있는 거대한 꽃봉오리가 개화한 모습.）
	PRINTFORML （주위에 광범위로 걸쳐 무지갯빛으로 반짝이는 수수께끼의 꽃가루를 날리고 있다.）
ELSE
	PRINTFORML （시들어 가는 낙원의 꽃에서 마침내 모습을 드러낸 천사의 나무의 중심핵.）
	PRINTFORML （주위의 지면으로부터 기둥 모양의 촉수가 튀어나와 도시의 건물들을 무너뜨려 가고 있다.）
ENDIF

;--------------------------------------------------
;HP
@TENTACLE_LASTBOSS_2_HP
LOCAL = 10000
CALL TENTACLE_STATUS_HOSEI, LOCAL,2500
RETURN RESULT

;--------------------------------------------------
;사정 한계치
@TENTACLE_LASTBOSS_2_SYASEI
CALL TENTACLE_LEVEL
LOCAL = 580 + RESULT * 10
RETURN LOCAL

;--------------------------------------------------
;착정 피해량 보정
@TENTACLE_LASTBOSS_2_SAKUSEI
IF FLAG:21 >= 3
	LOCAL = 25
ELSEIF FLAG:21 >= 1
	LOCAL = 50
ENDIF
RETURN LOCAL

;--------------------------------------------------
;방심도 역치
@TENTACLE_LASTBOSS_2_YUDAN
IF FLAG:21 == 1
	LOCAL = 1500
ELSEIF FLAG:21 == 2
	LOCAL = 3000
ELSE
	LOCAL = 6000
ENDIF
RETURN LOCAL

;--------------------------------------------------
;공격
@TENTACLE_LASTBOSS_2_KOUGEKI
IF FLAG:21 == 1
	LOCAL = (BASE:방어 - 100) / 6 + 80
	SIF LOCAL < 200
		LOCAL = 200
ELSEIF FLAG:21 == 2
	LOCAL = (BASE:방어 - 100) / 4 + 160
	SIF LOCAL < 250
		LOCAL = 250
ELSE
	LOCAL = (BASE:방어 - 100) / 2 + 200
	SIF LOCAL < 300
		LOCAL = 300
ENDIF
CALL TENTACLE_STATUS_HOSEI, LOCAL,10
RETURN RESULT

;--------------------------------------------------
;방어
@TENTACLE_LASTBOSS_2_BOUGYO
IF FLAG:21 == 1
	LOCAL = (BASE:공격 - 100) + 200
	IF TCVARn:0 == 1
		TIMES LOCAL,1.05
		SIF (TFLAG:13 & 1) == 0
			TIMES LOCAL,1.5
	ELSEIF TCVARn:0 == 2
		TIMES LOCAL,0.85
		SIF (TFLAG:13 & 2) == 0
			TIMES LOCAL,2.5
	ELSEIF TCVARn:0 == 3
		TIMES LOCAL,0.75
		SIF (TFLAG:13 & 4) == 0
			TIMES LOCAL,4.5
	ENDIF
ELSEIF FLAG:21 == 2
	LOCAL = (BASE:공격 - 100) / 2 + 50
	IF TCVARn:0 == 1
		TIMES LOCAL,1.05
	ELSEIF TCVARn:0 == 2
		TIMES LOCAL,0.85
	ELSEIF TCVARn:0 == 3
		TIMES LOCAL,0.75
	ENDIF
ELSEIF FLAG:21 == 3
	LOCAL = (BASE:공격 - 100) / 4 + 50
	IF TCVARn:0 == 1
		TIMES LOCAL,1.05
	ELSEIF TCVARn:0 == 2
		TIMES LOCAL,0.85
	ELSEIF TCVARn:0 == 3
		TIMES LOCAL,0.75
	ENDIF
ELSE
	LOCAL = (BASE:공격 - 100) / 4 + 25
	IF TCVARn:0 == 1
		TIMES LOCAL,1.05
	ELSEIF TCVARn:0 == 2
		TIMES LOCAL,0.85
	ELSEIF TCVARn:0 == 3
		TIMES LOCAL,0.75
	ENDIF
ENDIF
CALL TENTACLE_STATUS_HOSEI, LOCAL,25
RETURN RESULT

;--------------------------------------------------
;민첩
@TENTACLE_LASTBOSS_2_BINSYOU
IF FLAG:21 == 1
	LOCAL = 50
ELSEIF FLAG:21 == 2
	LOCAL = 200
ELSEIF FLAG:21 == 3
	LOCAL = 250
ELSE
	LOCAL = 100
ENDIF
CALL TENTACLE_STATUS_HOSEI, LOCAL
RETURN RESULT

;--------------------------------------------------
;지성
@TENTACLE_LASTBOSS_2_CHISEI
IF FLAG:21 == 1
	LOCAL = 25
ELSEIF FLAG:21 == 2
	LOCAL = 999
ELSE
	LOCAL = 80
ENDIF
CALL TENTACLE_STATUS_HOSEI, LOCAL,10
RETURN RESULT

;--------------------------------------------------
;근거리
@TENTACLE_LASTBOSS_2_SHORT
IF FLAG:21 == 1
	RESULT = 250
ELSEIF FLAG:21 == 2
	RESULT = 150
ELSE
	RESULT = 85
ENDIF
RETURN RESULT

;--------------------------------------------------
;중거리
@TENTACLE_LASTBOSS_2_MIDDLE
IF FLAG:21 == 1
	RESULT = 240
ELSEIF FLAG:21 == 2
	RESULT = 150
ELSE
	RESULT = 85
ENDIF
RETURN RESULT

;--------------------------------------------------
;원거리
@TENTACLE_LASTBOSS_2_LONG
IF FLAG:21 == 1
	RESULT = 230
ELSEIF FLAG:21 == 2
	RESULT = 150
ELSE
	RESULT = 85
ENDIF
RETURN RESULT

;--------------------------------------------------
;구속력
@TENTACLE_LASTBOSS_2_HOLD
IF FLAG:21 == 1
	RESULT = 350
ELSEIF FLAG:21 == 2
	RESULT = 140
ELSE
	RESULT = 90
ENDIF
RETURN RESULT

;--------------------------------------------------
;PALAM보정　백분율로 되돌린다
@TENTACLE_LASTBOSS_2_PALAM_HOSEI
IF FLAG:21 == 1
	;쾌Ｃ
	LOCAL:0 = 150
	;쾌Ｖ
	LOCAL:1 = 150
	;쾌Ａ
	LOCAL:2 = 150
	;쾌Ｂ
	LOCAL:3 = 150
	;윤활
	LOCAL:4 = 100
	;공순
	LOCAL:5 = 150
	;습득
	LOCAL:6 = 150
	;욕정
	LOCAL:7 = 150
	;굴복
	LOCAL:8 = 50
	;치정
	LOCAL:9 = 50
	;고통
	LOCAL:10 = 50
	;공포
	LOCAL:11 = 50
ELSEIF FLAG:21 == 2
	;쾌Ｃ
	LOCAL:0 = 250
	;쾌Ｖ
	LOCAL:1 = 250
	;쾌Ａ
	LOCAL:2 = 250
	;쾌Ｂ
	LOCAL:3 = 250
	;윤활
	LOCAL:4 = 100
	;공순
	LOCAL:5 = 150
	;습득
	LOCAL:6 = 150
	;욕정
	LOCAL:7 = 150
	;굴복
	LOCAL:8 = 150
	;치정
	LOCAL:9 = 150
	;고통
	LOCAL:10 = 150
	;공포
	LOCAL:11 = 150
ELSE
	;쾌Ｃ
	LOCAL:0 = 100
	;쾌Ｖ
	LOCAL:1 = 100
	;쾌Ａ
	LOCAL:2 = 100
	;쾌Ｂ
	LOCAL:3 = 100
	;윤활
	LOCAL:4 = 100
	;공순
	LOCAL:5 = 50
	;습득
	LOCAL:6 = 50
	;욕정
	LOCAL:7 = 50
	;굴복
	LOCAL:8 = 200
	;치정
	LOCAL:9 = 200
	;고통
	LOCAL:10 = 200
	;공포
	LOCAL:11 = 200
ENDIF

RETURN LOCAL:0, LOCAL:1, LOCAL:2, LOCAL:3, LOCAL:4, LOCAL:5, LOCAL:6, LOCAL:7, LOCAL:8, LOCAL:9, LOCAL:10, LOCAL:11



;--------------------------------------------------
;전용 루틴（전투）
;제1형태는 이쪽의 체력이 남아 있으면 구속해 오지 않는다.
;제2, 최종 형태는 체력과 기력 중 적은 쪽을 겨냥하여 공격하는 데다가, 사악한 파동을 사용한다.
@TENTACLE_LASTBOSS_2_ATTACK_ROUTINE
CALL PERCENT_CAL, BASE:체력, MAXBASE:체력
LOCAL:2 = RESULT
CALL PERCENT_CAL, BASE:기력, MAXBASE:기력
LOCAL:3 = RESULT
IF FLAG:21 == 1
	IF LOCAL:2
		LOCAL:1 = RAND:100
		IF LOCAL:1 < 70
			LOCAL = 1
		ELSE
			LOCAL = 3
		ENDIF
	ELSE
		LOCAL:1 = RAND:100
		IF LOCAL:1 < 70
			LOCAL = 2
		ELSE
			LOCAL = 3
		ENDIF
	ENDIF
ELSEIF LOCAL:2 && LOCAL:3
	IF FLAG:21 >= 3 && RAND:4 == 0
		LOCAL = 2
	ELSEIF LOCAL:2 < LOCAL:3 && LOCAL:2
		LOCAL:1 = RAND:100
		IF LOCAL:1 < 70
			LOCAL = 1
		ELSEIF LOCAL:1 < 80
			LOCAL = 3
		ELSE
			LOCAL = 6
		ENDIF
	ELSEIF LOCAL:2 && (RAND:4 == 0 || FLAG:21 >= 3 && RAND:3 != 0)
		LOCAL:1 = RAND:100
		IF LOCAL:1 < 70
			LOCAL = 1
		ELSEIF LOCAL:1 < 80
			LOCAL = 3
		ELSE
			LOCAL = 6
		ENDIF
	ELSE
		LOCAL:1 = RAND:100
		IF LOCAL:1 < 10
			LOCAL = 3
		ELSE
			LOCAL = 6
		ENDIF
	ENDIF
ELSE
	IF LOCAL:2 <= 0 && LOCAL:3
		LOCAL:1 = RAND:100
		IF LOCAL:1 < 70
			LOCAL = 2
		ELSEIF LOCAL:1 < 80
			LOCAL = 3
		ELSE
			LOCAL = 6
		ENDIF
	ELSEIF LOCAL:3 <= 0 && LOCAL:2
		LOCAL:1 = RAND:100
		IF LOCAL:1 < 70
			LOCAL = 2
		ELSEIF LOCAL:1 < 80
			LOCAL = 1
		ELSE
			LOCAL = 3
		ENDIF
	ELSE
		LOCAL = 2
	ENDIF
ENDIF
RETURN LOCAL

;--------------------------------------------------
;전용 루틴（성행위）
;제1형태는 쾌락을 주는 것을 최우선으로 하고, 캐릭터에 맞춘 약점 고문을 행한다.
;고통이나 수치를 주는 커맨드는 사용하지 않는다.
;제2형태 이후는 성공격(강) 이상만 사용, SM계 커맨드가 해금되는 한편 강제 자위는 사용하지 않게 된다.
@TENTACLE_LASTBOSS_2_SEX_ROUTINE
CALL PERCENT_CAL, BASE:체력, MAXBASE:체력
LOCAL:2 = RESULT
CALL PERCENT_CAL, BASE:기력, MAXBASE:기력
LOCAL:3 = RESULT
CALL CLEARRANDCHOOSE
IF TALENT:Ｃ민감 || TALENT:음핵
	FOR LOCAL,0,10
		LOCAL:1 = RAND:100
		IF PALAM:윤활 < 2000
			LOCAL:10 = 70
			LOCAL:11 = 30
		ELSE
			LOCAL:10 = 20
			LOCAL:11 = 50
		ENDIF
		IF LOCAL:1 < LOCAL:10
			CALL ADDRANDCHOOSE,0
		ELSEIF LOCAL:1 < LOCAL:10 + LOCAL:11
			CALL ADDRANDCHOOSE,1
		ELSE
			CALL ADDRANDCHOOSE,1000
		ENDIF
	NEXT
ENDIF
IF TALENT:Ｖ민감 || TALENT:음호
	FOR LOCAL,0,10
		LOCAL:1 = RAND:100
		IF PALAM:윤활 < 2000
			LOCAL:10 = 70
			LOCAL:11 = 30
		ELSE
			LOCAL:10 = 20
			LOCAL:11 = 50
		ENDIF
		IF LOCAL:1 < LOCAL:10
			CALL ADDRANDCHOOSE,2
		ELSEIF LOCAL:1 < LOCAL:10 + LOCAL:11
			CALL ADDRANDCHOOSE,3
		ELSE
			CALL ADDRANDCHOOSE,1001
		ENDIF
	NEXT
ENDIF
IF TALENT:Ａ민감 || TALENT:음고
	FOR LOCAL,0,10
		LOCAL:1 = RAND:100
		IF PALAM:윤활 < 2000
			LOCAL:10 = 70
			LOCAL:11 = 30
		ELSE
			LOCAL:10 = 20
			LOCAL:11 = 50
		ENDIF
		IF LOCAL:1 < LOCAL:10
			CALL ADDRANDCHOOSE,4
		ELSEIF LOCAL:1 < LOCAL:10 + LOCAL:11
			CALL ADDRANDCHOOSE,5
		ELSE
			CALL ADDRANDCHOOSE,1002
		ENDIF
	NEXT
ENDIF
IF TALENT:Ｂ민감 || TALENT:음유
	FOR LOCAL,0,10
		LOCAL:1 = RAND:100
		IF PALAM:윤활 < 2000
			LOCAL:10 = 70
			LOCAL:11 = 30
		ELSE
			LOCAL:10 = 20
			LOCAL:11 = 50
		ENDIF
		IF LOCAL:1 < LOCAL:10
			CALL ADDRANDCHOOSE,6
		ELSEIF LOCAL:1 < LOCAL:10 + LOCAL:11
			CALL ADDRANDCHOOSE,7
		ELSE
			CALL ADDRANDCHOOSE,1003
		ENDIF
	NEXT
ENDIF
IF FLAG:21 == 1
	IF ABL:자위중독
		FOR LOCAL,0,(ABL:자위중독 * 3)
			LOCAL:1 = RAND:100
			CALL ADDRANDCHOOSE,1006
		NEXT
	ENDIF
	IF CHOICECOUNT_F() < 100
		FOR LOCAL,0,101 - CHOICECOUNT_F()
			LOCAL:1 = RAND:100
			IF LOCAL:1 < 9
				CALL ADDRANDCHOOSE,0
			ELSEIF LOCAL:1 < 12
				CALL ADDRANDCHOOSE,1
			ELSEIF LOCAL:1 < 21
				CALL ADDRANDCHOOSE,2
			ELSEIF LOCAL:1 < 24
				CALL ADDRANDCHOOSE,3
			ELSEIF LOCAL:1 < 33
				CALL ADDRANDCHOOSE,4
			ELSEIF LOCAL:1 < 36
				CALL ADDRANDCHOOSE,5
			ELSEIF LOCAL:1 < 45
				CALL ADDRANDCHOOSE,6
			ELSEIF LOCAL:1 < 48
				CALL ADDRANDCHOOSE,7
			ELSEIF LOCAL:1 < 55
				CALL ADDRANDCHOOSE,10
			ELSEIF LOCAL:1 < 65
				CALL ADDRANDCHOOSE,11
			ELSEIF LOCAL:1 < 75
				CALL ADDRANDCHOOSE,1000
			ELSEIF LOCAL:1 < 80
				CALL ADDRANDCHOOSE,1001
			ELSEIF LOCAL:1 < 85
				CALL ADDRANDCHOOSE,1002
			ELSEIF LOCAL:1 < 90
				CALL ADDRANDCHOOSE,1003
			ELSEIF LOCAL:1 < 95
				CALL ADDRANDCHOOSE,1005
			ELSE
				CALL ADDRANDCHOOSE,1006
			ENDIF
		NEXT
	ENDIF
ELSE
	IF CHOICECOUNT_F() < 200
		FOR LOCAL,0,101 - CHOICECOUNT_F()
			LOCAL:1 = RAND:100
			IF LOCAL:1 < 8
				CALL ADDRANDCHOOSE,1
			ELSEIF LOCAL:1 < 16
				CALL ADDRANDCHOOSE,3
			ELSEIF LOCAL:1 < 24
				CALL ADDRANDCHOOSE,5
			ELSEIF LOCAL:1 < 32
				CALL ADDRANDCHOOSE,7
			ELSEIF LOCAL:1 < 40
				CALL ADDRANDCHOOSE,8
			ELSEIF LOCAL:1 < 48
				CALL ADDRANDCHOOSE,9
			ELSEIF LOCAL:1 < 52
				CALL ADDRANDCHOOSE,10
			ELSEIF LOCAL:1 < 56
				CALL ADDRANDCHOOSE,11
			ELSEIF LOCAL:1 < 64
				CALL ADDRANDCHOOSE,12
			ELSEIF LOCAL:1 < 68
				CALL ADDRANDCHOOSE,1000
			ELSEIF LOCAL:1 < 72
				CALL ADDRANDCHOOSE,1001
			ELSEIF LOCAL:1 < 76
				CALL ADDRANDCHOOSE,1002
			ELSEIF LOCAL:1 < 80
				CALL ADDRANDCHOOSE,1003
			ELSEIF LOCAL:1 < 92
				CALL ADDRANDCHOOSE,1004
			ELSEIF LOCAL:1 < 96
				CALL ADDRANDCHOOSE,1005
			ELSE
				CALL ADDRANDCHOOSE,1007
			ENDIF
		NEXT
	ENDIF
ENDIF

IF CHOICECOUNT_F()
	RETURN RANDCHOOSE_F()
ELSE
	RETURN -1
ENDIF

;--------------------------------------------------
;성 커맨드 레퍼런스
;ARG=1　스마타 애태우기 성공 시의 행동 지정
;ARG=2　스마타 애태우기 실패 시의 행동 지정
;ARG=3　펠라치오 유발 시의 행동 지정
@TENTACLE_LASTBOSS_2_REACTION_REF, ARG = 0
IF ARG == 1
	LOCAL = RAND:6
	IF LOCAL < 2
		RETURN 3
	ELSEIF LOCAL < 4
		RETURN 5
	ELSEIF LOCAL < 5
		RETURN 1001
	ELSE
		RETURN 1002
	ENDIF
ELSEIF ARG == 2
	RETURN 15
ELSEIF ARG == 3
	RETURN 11
ENDIF
RETURN -1

;--------------------------------------------------
;전용 루틴（유폐）
@TENTACLE_LASTBOSS_2_PRISON_ROUTINE
LOCAL = RAND:100
IF LOCAL < 5
	CALL PRISON_COMABLE, 100
	RETURN 1
ELSEIF LOCAL < 10
	CALL PRISON_COMABLE, 101
	RETURN 1
ELSEIF LOCAL < 15
	CALL PRISON_COMABLE, 102
	RETURN 1
ELSEIF LOCAL < 20
	CALL PRISON_COMABLE, 103
	RETURN 1
ELSEIF LOCAL < 28
	CALL PRISON_COMABLE, 200
	RETURN 1
ELSEIF LOCAL < 36
	CALL PRISON_COMABLE, 201
	RETURN 1
ELSEIF LOCAL < 44
	CALL PRISON_COMABLE, 300
	RETURN 1
ELSEIF LOCAL < 52
	CALL PRISON_COMABLE, 301
	RETURN 1
ELSEIF LOCAL < 60
	CALL PRISON_COMABLE, 104
	RETURN 1
ELSEIF LOCAL < 68
	CALL PRISON_COMABLE, 105
	RETURN 1
ELSE
	RETURN 0
ENDIF

;--------------------------------------------------
;촉수 크기 보정
;이 보정 후에 부위별 보정이 들어간다
@TENTACLE_LASTBOSS_2_TENTACLE_SIZE,ARG
;C용 촉수
LOCAL:0 = 40
LOCAL:4 = RAND:7 + 3
;V용 촉수
LOCAL:1 = 100
LOCAL:5 = RAND:3 + 1
;A용 촉수
LOCAL:2 = 100
LOCAL:6 = RAND:3 + 1
;B용 촉수
LOCAL:3 = 90
LOCAL:7 = RAND:4 + 2
RETURN LOCAL:0, LOCAL:1, LOCAL:2, LOCAL:3, LOCAL:4, LOCAL:5, LOCAL:6, LOCAL:7

