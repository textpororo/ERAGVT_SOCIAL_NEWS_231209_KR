;種付けフィニッシュ（Ｖ系からの派生限定行動）

;性コマンド分類
@SEX_TYPE_COM16
RETURN 삽입

@SEX_COM16,ARG = 0,ARG:1 = 0
;EX_COM	追加責め実行部位（ビット）
;	1：Ｃ　2：Ｖ　4：Ａ　8：Ｂ
;追加責め
CALL SEX_COMEX_RANDOM, Ｖ, ARG:1
EX_COM = RESULT:0
SH_COM = RESULT:1

;INSERT |= 질
;사정部位フラグ:膣を立てる
TFLAG:4 = TFLAG:4 | 질
;촉수を使っているなら手と口を立てる
IF (FLAG:110 == 1) && ISTENTACLER(FLAG:111) == 0 && (TALENT:(FLAG:111):후타나리 > 0 || ISMALE(FLAG:111))
ELSE
	TFLAG:4 = TFLAG:4 | 손
	TFLAG:4 = TFLAG:4 | 입
ENDIF
;Ｂ追加攻めがあるなら胸を立てる
SIF (EX_COM & Ｂ)
	TFLAG:4 = TFLAG:4 | 가슴

;흑화 캐릭터のペニス位置をセット
SIF ENEMY_TYPE_CHECK_F("AKUOTI") == 1 && (ISPENIS(FLAG:111))
	TFLAG:18 = 질

;取得パラメータ計算
;ベース値の明示的初期化
REPEAT 12
	LOCAL:COUNT = 0
REND

;油断度 상승
TFLAG:3 += 200

;사정値 1000
CALL TENTACLE_SYASEI_UP, 1000

;촉수サイズの설정
CALL SET_TENTACLE_SIZE, FLAG:10, FLAG:11, ENEMY_TYPE_CHECK_F("AKUOTI"), FLAG:111, 16

;快V
IF ABL:V감각 == 0
	LOCAL:1 = 4600
ELSEIF ABL:V감각 == 1
	LOCAL:1 = 5500
ELSEIF ABL:V감각 == 2
	LOCAL:1 = 8000
ELSEIF ABL:V감각 == 3
	LOCAL:1 = 11000
ELSEIF ABL:V감각 == 4
	LOCAL:1 = 14000
ELSEIF ABL:V감각 >= 5
	LOCAL:1 = 20000
ENDIF
;メイン部位絶頂見込みの予測
CALL PALAM_VABCestimate(LOCAL,1,-1)


IF ENEMY_TYPE_CHECK_F("MOB") == 1
	TRYCALLFORM MESSAGE_MOB_{ARG}_COM16, EX_COM, SH_COM
ELSE
	;지문: 세뇌/흑화 캐릭터가 操作キャラに種付けフィニッシュをした
	SIF ENEMY_TYPE_CHECK_F("AKUOTI") == 1
		CALL MESSAGE_OTHER_SEX_COM16
	;지문: COM16
	CALL MESSAGE_SEX_COM16, EX_COM, SH_COM
ENDIF

;結界による촉수本数の変動
CALL SET_TENTACLE_POOL
;服へのダメージ
CALL CLOTH_BATTLE_DAMAGE, 2

;ベース
EXP:V경험 += 1
SIF ENEMY_TYPE_CHECK_F("AKUOTI") == 0 && INCEST_F(TARGET, FLAG:10 * 100 + FLAG:11, 1) > 0
	EXP:근친교배경험 += 1
SIF ENEMY_TYPE_CHECK_F("AKUOTI") == 1 && INCEST_F(TARGET, FLAG:111) > 0
	EXP:근친교배경험 += 1



;공순
IF ABL:순종 <= 2
	LOCAL:5 = 300
ELSEIF ABL:순종 == 3
	LOCAL:5 = 750
ELSEIF ABL:순종 == 4
	LOCAL:5 = 1500
ELSEIF ABL:순종 >= 5
	LOCAL:5 = 3000
ENDIF

;습득
IF ABL:봉사정신 == 0
	LOCAL:6 = 10
ELSEIF ABL:봉사정신 == 1
	LOCAL:6 = 25
ELSEIF ABL:봉사정신 == 2
	LOCAL:6 = 50
ELSEIF ABL:봉사정신 == 3
	LOCAL:6 = 100
ELSEIF ABL:봉사정신 == 4
	LOCAL:6 = 250
ELSEIF ABL:봉사정신 >= 5
	LOCAL:6 = 500
ENDIF

;윤활が低いと고통が入る
IF PALAM:윤활 < 1000
	LOCAL:10 += 1000
ELSEIF PALAM:윤활 < 2000
	LOCAL:10 += 200
ENDIF

;V감각が低いと공포が入る
IF ABL:V감각 == 0
	LOCAL:11 = 8000
ELSEIF ABL:V감각 == 1
	LOCAL:11 = 2000
ELSEIF ABL:V감각 == 2
	LOCAL:11 = 800
ELSEIF ABL:V감각 == 3
	LOCAL:11 = 400
ELSE
ENDIF

;追加責め実行
IF EX_COM
	CALL SEX_COMEX, Ｖ, 1, EX_COM | SH_COM
	REPEAT 12
		LOCAL:COUNT += RESULT:COUNT
	REND
ENDIF

;行動予約なし
TFLAG:17 = -1
;촉수の行動を記録
TFLAG:20 = 16

;강구속状態を解除
SIF (TCVARn:12 & 강구속)
	TCVARn:12 -= 강구속

;습득基本値
LOCAL:6 += 50

;욕정基本値
LOCAL:7 += 1000

;굴복基本値
LOCAL:8 += 4000

;치정基本値
LOCAL:9 += 1000

;고통基本値
LOCAL:10 += 0

;공포基本値
LOCAL:11 += 1500

;체력消費基本値
LOCAL:12 += 500

;計算へ
CALL PALAM_CAL, LOCAL:0, LOCAL:1, LOCAL:2, LOCAL:3, LOCAL:4, LOCAL:5, LOCAL:6, LOCAL:7, LOCAL:8, LOCAL:9, LOCAL:10, LOCAL:11, LOCAL:12
